import{Q as y}from"./QPage.8bc2b0c5.js";import{u as v,s as S}from"./re-store.8565acff.js";import{Q as k}from"./QImg.660f3113.js";import{c as b,a as E,h as T,d as B,e as C,r as m,u as w,_ as I,o as u,an as f,g as e,w as t,k as a,ar as g,j as o,Q as n,as as $,ap as F,f as Q,l as P}from"./index.844ed79f.js";import{Q as c}from"./QTooltip.3a659099.js";import{Q as x}from"./QPageSticky.bc63c2bc.js";import{s as q}from"./transform.aea72fbe.js";import"./firebase.0eb8f378.js";import"./index.2cf0d985.js";import"./scroll.ec76bd17.js";var _=b({name:"QBtnGroup",props:{unelevated:Boolean,outline:Boolean,flat:Boolean,rounded:Boolean,square:Boolean,push:Boolean,stretch:Boolean,glossy:Boolean,spread:Boolean},setup(i,{slots:s}){const r=E(()=>{const d=["unelevated","outline","flat","rounded","square","push","stretch","glossy"].filter(l=>i[l]===!0).map(l=>`q-btn-group--${l}`).join(" ");return`q-btn-group row no-wrap${d.length>0?" "+d:""}`+(i.spread===!0?" q-btn-group--spread":" inline")});return()=>T("div",{class:r.value},B(s.default))}});const R=C({name:"EditorComponent",props:{},setup(i){const s=v();return{props:i,reStore:s,imgCap:m(""),imgSrc:m(""),imgFit:m(""),pageText:m("")}},mounted(){console.log("EditorComponent.mounted"),w(this.reStore.courses,async(r,d)=>{console.log("Editor.watch"),r.ck,r.aid,r.pgIdx,r.imgIdx>this.reStore.page.imgs.length-1&&(r.imgIdx=0);const l=r.imgIdx;try{this.imgFit=this.reStore.page.imgFit,this.pageText=this.reStore.page.pageText,this.reStore.page.imgs.length>0?(console.log("try set editor img ",l,this.reStore.page.imgs),this.imgSrc=this.reStore.page.imgs[l].url,this.imgCap=this.reStore.page.imgs[l].cap):console.log("page doesnt have images YET")}catch(p){console.log("ERROR Editor watch ",p,l,this.reStore.page.imgs),this.imgSrc=this.reStore.page.imgs[0].url,this.imgCap=this.reStore.page.imgs[0].cap}},{immediate:!0,deep:!0});const i=this.reStore.courses.ck;this.reStore.courses.aid,this.reStore.courses.pgIdx;const s=this.reStore.courses.imgIdx;try{this.imgFit=this.reStore.page.imgFit,this.pageText=this.reStore.page.pageText,this.imgSrc=this.reStore.page.imgs[s].url,this.imgCap=this.reStore.page.imgs[s].cap}catch(r){console.log("ERROR Editor mounted",r)}i&&this.reStore.loadCover()},methods:{async reloadPage(){console.log("Editor calling reloadPage"),await this.reStore.reloadPage(),console.log("Editor page.imgs ",this.reStore.page.imgs),this.imgFit=this.reStore.page.imgFit,this.pageText=this.reStore.page.pageText,this.imgSrc=this.reStore.page.imgs[0].url,this.imgCap=this.reStore.page.imgs[0].cap},prevImg(){this.reStore.page.imgIdx=this.reStore.page.imgIdx-1<0?this.reStore.page.imgs.length-1:this.reStore.page.imgIdx-1,this.reStore.courses.imgIdx=this.reStore.page.imgIdx,this.reStore.setStatus("imgIdx",this.imgIdx),this.imgSrc=this.reStore.page.imgs[this.reStore.courses.imgIdx].url,this.imgCap=this.reStore.page.imgs[this.reStore.courses.imgIdx].cap},nextImg(){this.reStore.page.imgIdx=this.reStore.page.imgIdx+1>this.reStore.page.imgs.length-1?0:this.reStore.page.imgIdx+1,this.reStore.courses.imgIdx=this.reStore.page.imgIdx,this.reStore.setStatus("imgIdx",this.reStore.courses.imgIdx),this.imgSrc=this.reStore.page.imgs[this.reStore.courses.imgIdx].url,this.imgCap=this.reStore.page.imgs[this.reStore.courses.imgIdx].cap},toggleText(){q("#slideTextDiv").classed("hidden")?S("#slideTextDiv").classed("hidden",!1):S("#slideTextDiv").classed("hidden",!0)},cycleFitMode(){const i=["scale-down","cover"];let s=i.indexOf(this.imgFit);s+=1,s>i.length-1&&(s=0),this.reStore.page.imgFit=i[s],this.reStore.courses.trigger+=1},setCover(){this.reStore.courses.ck,this.reStore.courses.aid,this.reStore.courses.pgIdx;const i=this.reStore.courses.imgIdx,s=this.reStore.page.imgs[i].url;this.reStore.setCover(this.reStore.page.imgs[i]),console.log("coverUrl ",s)}}}),D={id:"slideCaptionDiv",class:"absolute-top text-subtitle1 text-center q-my-xl assignment",contentEditable:"true"},N={id:"slideTextDiv",class:"text-panel text-center absolute-center assignment",contentEditable:"true"},V={key:0},z={id:"coverSlideDiv",class:"flex flex-center cover-panel absolute-center coverslide",contentEditable:"false"},A={class:"q-ma-md"},G=a("br",null,null,-1),M=a("br",null,null,-1),U={class:"q-ma-md"},W=a("br",null,null,-1),H=a("br",null,null,-1),Y=a("br",null,null,-1),J=a("br",null,null,-1);function K(i,s,r,d,l,p){return u(),f(F,null,[e(k,{class:"fixed-center",src:this.imgSrc,fit:this.imgFit,height:"100%"},{default:t(()=>[a("div",D,g(this.imgCap),1)]),_:1},8,["src","fit"]),a("div",N,g(this.pageText),1),this.reStore.courses.aid?(u(),f("span",V,[a("div",z,[a("div",A,[e(n,{style:{width:"200px",height:"200px","font-size":"12pt"},color:"primary"},{default:t(()=>[o(g(this.reStore.courses[this.reStore.courses.ck].assignments[this.reStore.courses.aid].title)+" ",1),G,o(" "+g(this.reStore.courses[this.reStore.courses.ck].assignments[this.reStore.courses.aid].pages.length)+" Pages ",1),M,o(" "+g(this.reStore.courses[this.reStore.courses.ck].assignments[this.reStore.courses.aid].goal)+" Points ",1)]),_:1})]),a("div",U,[e(n,{style:{width:"200px",height:"200px","font-size":"24pt"},stack:"",size:"xl","icon-right":"play_circle","text-color":"white",color:"primary",onClick:s[0]||(s[0]=h=>this.reStore.startAssignment())},{default:t(()=>[o("Start")]),_:1})])])])):$("",!0),e(x,{position:"bottom",offset:[0,10],class:"assignment"},{default:t(()=>[e(_,null,{default:t(()=>[e(n,{fab:"","label-position":"left",color:"primary",icon:"arrow_left",onClick:this.prevImg,padding:"sm"},{default:t(()=>[e(c,null,{default:t(()=>[o(" Previous image (same Wikipedia page) ")]),_:1})]),_:1},8,["onClick"]),e(n,{color:"primary"},{default:t(()=>[o(g(this.reStore.courses.imgIdx+1)+"/"+g(this.reStore.page.imgs.length),1)]),_:1}),e(n,{fab:"","label-position":"right",color:"primary",icon:"arrow_right",onClick:this.nextImg,padding:"sm"},null,8,["onClick"]),e(c,null,{default:t(()=>[o(" Next image (same Wikipedia page) ")]),_:1})]),_:1})]),_:1}),e(x,{position:"bottom",offset:[0,60],class:"assignment"},{default:t(()=>[e(_,null,{default:t(()=>[e(n,{fab:"","label-position":"right",color:"primary",icon:"fit_screen",onClick:this.cycleFitMode,padding:"sm"},{default:t(()=>[e(c,null,{default:t(()=>[o("Cycle through image-fit modes")]),_:1})]),_:1},8,["onClick"]),e(n,{fab:"","label-position":"right",color:"primary",icon:"article",onClick:this.toggleText,padding:"sm"},{default:t(()=>[e(c,null,{default:t(()=>[o("Show/Hide paragraph text in order to get"),W,o("better view of image.")]),_:1})]),_:1},8,["onClick"]),e(n,{fab:"","label-position":"right",color:"primary",icon:"title",onClick:this.setCover,padding:"sm"},{default:t(()=>[e(c,null,{default:t(()=>[o("Set current image as Cover Image for current assignment,"),H,o("if there is an assignment currently loaded.")]),_:1})]),_:1},8,["onClick"]),e(n,{fab:"","label-position":"right",color:"primary",icon:"volume_up",onClick:s[1]||(s[1]=h=>this.reStore.speak()),padding:"sm"},{default:t(()=>[e(c,null,{default:t(()=>[o("Speak current text")]),_:1})]),_:1}),e(n,{fab:"","label-position":"right",color:"primary",icon:"arrow_right",onClick:this.reloadPage,padding:"xs"},{default:t(()=>[e(c,null,{default:t(()=>[o(" Reload page content. If Custom then no changes."),Y,o(" If pageid, then only saved imgIdx applies."),J,o(" Else, reloads random with guid-words, if any. ")]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1})],64)}var L=I(R,[["render",K]]);const X=C({name:"EditorPage",components:{EditorComponent:L},setup(i){const s=v();return{props:i,reStore:s}}});function Z(i,s,r,d,l,p){const h=P("EditorComponent");return u(),Q(y,{id:"QPage",class:"row justify-center"},{default:t(()=>[e(h)]),_:1})}var ne=I(X,[["render",Z]]);export{ne as default};
