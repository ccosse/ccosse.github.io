import{u as useFormProps,a as useFormAttrs,b as useFormInject,Q as QCardSection,c as QCardActions,d as QDialog,C as ClosePopup}from"./ClosePopup.8a2ebfaf.js";import{u as useCache,Q as QInput}from"./use-cache.c35cafc7.js";import{j as defineComponent,_ as _export_sfc,p as resolveComponent,k as openBlock,G as createElementBlock,H as Fragment,a8 as renderList,q as createVNode,n as withCtx,a9 as QIcon,s as createTextVNode,t as createBaseVNode,aa as toDisplayString,ab as createCommentVNode,c as createComponent,r as ref,a as computed,ac as debounce,w as watch,a0 as onDeactivated,ad as onActivated,o as onBeforeUnmount,d as h,h as hMergeSlot,ae as withDirectives,g as getCurrentInstance,af as between,m as createBlock,J as pad,X as Transition,z as hSlot,ag as isObject$1,x as nextTick,Q as QBtn,ah as Plugin,ai as withKeys,P as Plugin$1,aj as Plugin$2}from"./index.e527cf5d.js";import{Q as QCard}from"./QCard.d22b42a7.js";import{Q as QSpace}from"./QSpace.e147c087.js";import{Q as QTooltip}from"./QTooltip.c7015261.js";import{Q as QHeader,a as QToolbar,b as QDrawer}from"./QDrawer.047253cf.js";import{Q as QResizeObserver,c as QScrollObserver,a as QLayout,b as QPageContainer}from"./QLayout.0cfa2b50.js";import{u as useStore,t as toJalaali,a as toGregorian,f as formatDate,g as getDateDiff,j as jalaaliMonthLength,_ as __splitDate,d as date}from"./store.001814db.js";import{T as TileComponent,P as PreferencesComponent,I as ImagePager}from"./PreferencesComponent.2400ad20.js";import{u as useDarkProps,a as useDark}from"./use-dark.c928e915.js";import{T as TouchPan}from"./TouchPan.d40d18d8.js";import{s as setVerticalScrollPosition,d as setHorizontalScrollPosition}from"./scroll.40845839.js";import{Q as QKnob,a as QSelect}from"./QSelect.8b9180bc.js";import{Q as QBar}from"./QMenu.d63e023e.js";import{Q as QExpansionItem}from"./QExpansionItem.f5c07453.js";import{Q as QList}from"./QList.0e1d1d95.js";import"./transform.9aa67f3e.js";import{s as selectAll}from"./selectAll.be636dd1.js";import{o as openDB,l as __extends,m as __rest$2,w as wh,f as sh,n as uf,p as cf,q as rh,J as Jl,_ as _l,E as El,e as dl,t as tf,v as getApp$1}from"./firebase.8769ab52.js";import{Q as QImg}from"./QImg.177e0477.js";import"./use-prevent-scroll.0faa6264.js";import"./use-timeout.7d10daeb.js";import"./use-tick.d6c1b00f.js";import"./selection.fa284a43.js";import"./axios.84ae42e4.js";import"./QToggle.03f47895.js";import"./touch.70a9dd44.js";var commonjsGlobal=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};const _sfc_main$6=defineComponent({name:"CoursePager",components:{TileComponent},props:[],setup(){return{store:useStore()}},methods:{}}),_hoisted_1$6=createBaseVNode("div",{class:"text-panel q-ma-md text-center text-h6"},"My Courses",-1);function _sfc_render$6(t,e,r,n,a,o){const s=resolveComponent("TileComponent");return openBlock(),createElementBlock(Fragment,null,[_hoisted_1$6,(openBlock(!0),createElementBlock(Fragment,null,renderList(this.store.courses,(i,d)=>(openBlock(),createElementBlock("span",{key:d},[createVNode(s,{tileData:i,imgUrl:i.coverUrl,targetUrl:null,ck:d,aid:null,pgIdx:null,imgIdx:null,tileType:"course"},null,8,["tileData","imgUrl","ck"])]))),128)),createVNode(QCard,{flat:"",bordered:"",class:"q-ma-md q-pa-md cursor-pointer tile-component flex flex-center",onClick:e[0]||(e[0]=i=>this.store.newCourse())},{default:withCtx(()=>[createVNode(QIcon,{name:"add",class:"text-h1"}),createVNode(QTooltip,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:withCtx(()=>[createVNode(QCard,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:withCtx(()=>[createTextVNode(" Create a new course ")]),_:1})]),_:1})]),_:1})],64)}var CoursePager=_export_sfc(_sfc_main$6,[["render",_sfc_render$6]]);const _sfc_main$5=defineComponent({name:"AssignmentPager",components:{TileComponent},props:[],setup(){return{store:useStore()}},methods:{clickCB(t,e,r,n,a){console.log("clickCB",t,a),this.store.ck=t,this.store.aid=e,this.store.pgIdx=r,this.store.imgIdx=n}}}),_hoisted_1$5={class:"text-panel q-ma-md text-center text-h6"},_hoisted_2$5={key:0},_hoisted_3$4={key:0};function _sfc_render$5(t,e,r,n,a,o){const s=resolveComponent("TileComponent");return openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",_hoisted_1$5,[createTextVNode(" Assignments: "),this.store.currentCourse?(openBlock(),createElementBlock("span",_hoisted_2$5,toDisplayString(Object.keys(this.store.currentCourse.assignments).length),1)):createCommentVNode("",!0)]),this.store.currentCourse?(openBlock(),createElementBlock("span",_hoisted_3$4,[(openBlock(!0),createElementBlock(Fragment,null,renderList(this.store.currentCourse.assignments,(i,d)=>(openBlock(),createElementBlock("span",{key:d},[createVNode(s,{tileData:i,imgUrl:i.coverUrl,targetUrl:null,ck:this.store.ck,aid:d,pgIdx:null,imgIdx:null,tileType:"assignment"},null,8,["tileData","imgUrl","ck","aid"])]))),128))])):createCommentVNode("",!0),createVNode(QCard,{flat:"",bordered:"",class:"q-ma-md q-pa-md cursor-pointer tile-component flex flex-center",onClick:e[0]||(e[0]=i=>this.store.newAssignment())},{default:withCtx(()=>[createVNode(QIcon,{name:"add",class:"text-h1"}),createVNode(QTooltip,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:withCtx(()=>[createVNode(QCard,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:withCtx(()=>[createTextVNode(" Create a new assignment ")]),_:1})]),_:1})]),_:1})],64)}var AssignmentPager=_export_sfc(_sfc_main$5,[["render",_sfc_render$5]]);const axisList=["vertical","horizontal"],dirProps={vertical:{offset:"offsetY",scroll:"scrollTop",dir:"down",dist:"y"},horizontal:{offset:"offsetX",scroll:"scrollLeft",dir:"right",dist:"x"}},panOpts={prevent:!0,mouse:!0,mouseAllDir:!0},getMinThumbSize=t=>t>=250?50:Math.ceil(t/5);var QScrollArea=createComponent({name:"QScrollArea",props:{...useDarkProps,thumbStyle:Object,verticalThumbStyle:Object,horizontalThumbStyle:Object,barStyle:[Array,String,Object],verticalBarStyle:[Array,String,Object],horizontalBarStyle:[Array,String,Object],contentStyle:[Array,String,Object],contentActiveStyle:[Array,String,Object],delay:{type:[String,Number],default:1e3},visible:{type:Boolean,default:null},tabindex:[String,Number],onScroll:Function},setup(t,{slots:e,emit:r}){const n=ref(!1),a=ref(!1),o=ref(!1),s={vertical:ref(0),horizontal:ref(0)},i={vertical:{ref:ref(null),position:ref(0),size:ref(0)},horizontal:{ref:ref(null),position:ref(0),size:ref(0)}},{proxy:d}=getCurrentInstance(),g=useDark(t,d.$q);let l=null,u;const m=ref(null),y=computed(()=>"q-scrollarea"+(g.value===!0?" q-scrollarea--dark":""));i.vertical.percentage=computed(()=>{const b=i.vertical.size.value-s.vertical.value;if(b<=0)return 0;const E=between(i.vertical.position.value/b,0,1);return Math.round(E*1e4)/1e4}),i.vertical.thumbHidden=computed(()=>(t.visible===null?o.value:t.visible)!==!0&&n.value===!1&&a.value===!1||i.vertical.size.value<=s.vertical.value+1),i.vertical.thumbStart=computed(()=>i.vertical.percentage.value*(s.vertical.value-i.vertical.thumbSize.value)),i.vertical.thumbSize=computed(()=>Math.round(between(s.vertical.value*s.vertical.value/i.vertical.size.value,getMinThumbSize(s.vertical.value),s.vertical.value))),i.vertical.style=computed(()=>({...t.thumbStyle,...t.verticalThumbStyle,top:`${i.vertical.thumbStart.value}px`,height:`${i.vertical.thumbSize.value}px`})),i.vertical.thumbClass=computed(()=>"q-scrollarea__thumb q-scrollarea__thumb--v absolute-right"+(i.vertical.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),i.vertical.barClass=computed(()=>"q-scrollarea__bar q-scrollarea__bar--v absolute-right"+(i.vertical.thumbHidden.value===!0?" q-scrollarea__bar--invisible":"")),i.horizontal.percentage=computed(()=>{const b=i.horizontal.size.value-s.horizontal.value;if(b<=0)return 0;const E=between(Math.abs(i.horizontal.position.value)/b,0,1);return Math.round(E*1e4)/1e4}),i.horizontal.thumbHidden=computed(()=>(t.visible===null?o.value:t.visible)!==!0&&n.value===!1&&a.value===!1||i.horizontal.size.value<=s.horizontal.value+1),i.horizontal.thumbStart=computed(()=>i.horizontal.percentage.value*(s.horizontal.value-i.horizontal.thumbSize.value)),i.horizontal.thumbSize=computed(()=>Math.round(between(s.horizontal.value*s.horizontal.value/i.horizontal.size.value,getMinThumbSize(s.horizontal.value),s.horizontal.value))),i.horizontal.style=computed(()=>({...t.thumbStyle,...t.horizontalThumbStyle,[d.$q.lang.rtl===!0?"right":"left"]:`${i.horizontal.thumbStart.value}px`,width:`${i.horizontal.thumbSize.value}px`})),i.horizontal.thumbClass=computed(()=>"q-scrollarea__thumb q-scrollarea__thumb--h absolute-bottom"+(i.horizontal.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),i.horizontal.barClass=computed(()=>"q-scrollarea__bar q-scrollarea__bar--h absolute-bottom"+(i.horizontal.thumbHidden.value===!0?" q-scrollarea__bar--invisible":""));const C=computed(()=>i.vertical.thumbHidden.value===!0&&i.horizontal.thumbHidden.value===!0?t.contentStyle:t.contentActiveStyle),T=[[TouchPan,b=>{$(b,"vertical")},void 0,{vertical:!0,...panOpts}]],N=[[TouchPan,b=>{$(b,"horizontal")},void 0,{horizontal:!0,...panOpts}]];function M(){const b={};return axisList.forEach(E=>{const I=i[E];b[E+"Position"]=I.position.value,b[E+"Percentage"]=I.percentage.value,b[E+"Size"]=I.size.value,b[E+"ContainerSize"]=s[E].value}),b}const K=debounce(()=>{const b=M();b.ref=d,r("scroll",b)},0);function R(b,E,I){if(axisList.includes(b)===!1){console.error("[QScrollArea]: wrong first param of setScrollPosition (vertical/horizontal)");return}(b==="vertical"?setVerticalScrollPosition:setHorizontalScrollPosition)(m.value,E,I)}function S({height:b,width:E}){let I=!1;s.vertical.value!==b&&(s.vertical.value=b,I=!0),s.horizontal.value!==E&&(s.horizontal.value=E,I=!0),I===!0&&x()}function D({position:b}){let E=!1;i.vertical.position.value!==b.top&&(i.vertical.position.value=b.top,E=!0),i.horizontal.position.value!==b.left&&(i.horizontal.position.value=b.left,E=!0),E===!0&&x()}function H({height:b,width:E}){i.horizontal.size.value!==E&&(i.horizontal.size.value=E,x()),i.vertical.size.value!==b&&(i.vertical.size.value=b,x())}function $(b,E){const I=i[E];if(b.isFirst===!0){if(I.thumbHidden.value===!0)return;u=I.position.value,a.value=!0}else if(a.value!==!0)return;b.isFinal===!0&&(a.value=!1);const L=dirProps[E],G=s[E].value,Y=(I.size.value-G)/(G-I.thumbSize.value),ne=b.distance[L.dist],ie=u+(b.direction===L.dir?1:-1)*ne*Y;re(ie,E)}function z(b,E){const I=i[E];if(I.thumbHidden.value!==!0){const L=b[dirProps[E].offset];if(L<I.thumbStart.value||L>I.thumbStart.value+I.thumbSize.value){const G=L-I.thumbSize.value/2;re(G/s[E].value*I.size.value,E)}I.ref.value!==null&&I.ref.value.dispatchEvent(new MouseEvent(b.type,b))}}function U(b){z(b,"vertical")}function Q(b){z(b,"horizontal")}function x(){n.value=!0,l!==null&&clearTimeout(l),l=setTimeout(()=>{l=null,n.value=!1},t.delay),t.onScroll!==void 0&&K()}function re(b,E){m.value[dirProps[E].scroll]=b}function q(){o.value=!0}function j(){o.value=!1}let F=null;return watch(()=>d.$q.lang.rtl,b=>{m.value!==null&&setHorizontalScrollPosition(m.value,Math.abs(i.horizontal.position.value)*(b===!0?-1:1))}),onDeactivated(()=>{F={top:i.vertical.position.value,left:i.horizontal.position.value}}),onActivated(()=>{if(F===null)return;const b=m.value;b!==null&&(setHorizontalScrollPosition(b,F.left),setVerticalScrollPosition(b,F.top))}),onBeforeUnmount(K.cancel),Object.assign(d,{getScrollTarget:()=>m.value,getScroll:M,getScrollPosition:()=>({top:i.vertical.position.value,left:i.horizontal.position.value}),getScrollPercentage:()=>({top:i.vertical.percentage.value,left:i.horizontal.percentage.value}),setScrollPosition:R,setScrollPercentage(b,E,I){R(b,E*(i[b].size.value-s[b].value)*(b==="horizontal"&&d.$q.lang.rtl===!0?-1:1),I)}}),()=>h("div",{class:y.value,onMouseenter:q,onMouseleave:j},[h("div",{ref:m,class:"q-scrollarea__container scroll relative-position fit hide-scrollbar",tabindex:t.tabindex!==void 0?t.tabindex:void 0},[h("div",{class:"q-scrollarea__content absolute",style:C.value},hMergeSlot(e.default,[h(QResizeObserver,{debounce:0,onResize:H})])),h(QScrollObserver,{axis:"both",onScroll:D})]),h(QResizeObserver,{debounce:0,onResize:S}),h("div",{class:i.vertical.barClass.value,style:[t.barStyle,t.verticalBarStyle],"aria-hidden":"true",onMousedown:U}),h("div",{class:i.horizontal.barClass.value,style:[t.barStyle,t.horizontalBarStyle],"aria-hidden":"true",onMousedown:Q}),withDirectives(h("div",{ref:i.vertical.ref,class:i.vertical.thumbClass.value,style:i.vertical.style.value,"aria-hidden":"true"}),T),withDirectives(h("div",{ref:i.horizontal.ref,class:i.horizontal.thumbClass.value,style:i.horizontal.style.value,"aria-hidden":"true"}),N)])}});const _sfc_main$4=defineComponent({name:"PagePager",components:{TileComponent},props:[],setup(){const t=ref(null);return{store:useStore(),pagePagerScrollArea:t}},mounted(){watch(this.store.currentAssignment.pages,async(t,e)=>{console.log("newPage detected, scrolling to 1.0"),this.pagePagerScrollArea.setScrollPercentage("vertical",1)})},methods:{newPageCB(){this.store.newPage(),this.pagePagerScrollArea.setScrollPercentage("vertical",1)}}}),_hoisted_1$4={class:"text-panel q-ma-md text-center text-h6"},_hoisted_2$4={key:0};function _sfc_render$4(t,e,r,n,a,o){const s=resolveComponent("TileComponent");return openBlock(),createBlock(QScrollArea,{style:{height:"95vh"},ref:"pagePagerScrollArea"},{default:withCtx(()=>[createBaseVNode("div",_hoisted_1$4,"Pages: "+toDisplayString(this.store.currentAssignment.pages.length),1),this.store.currentCourse?(openBlock(),createElementBlock("span",_hoisted_2$4,[(openBlock(!0),createElementBlock(Fragment,null,renderList(this.store.currentAssignment.pages,(i,d)=>(openBlock(),createElementBlock("span",{key:d},[createVNode(s,{tileData:i,imgUrl:i.imgs&&i.imgs.length>0?i.imgs[i.imgIdx].url:"",targetUrl:null,ck:this.store.ck,aid:this.store.aid,pgIdx:d,imgIdx:i.imgIdx,tileType:"page"},null,8,["tileData","imgUrl","ck","aid","pgIdx","imgIdx"])]))),128))])):createCommentVNode("",!0),createVNode(QCard,{flat:"",bordered:"",class:"q-ma-md q-pa-md cursor-pointer tile-component flex flex-center",onClick:e[0]||(e[0]=i=>this.newPageCB())},{default:withCtx(()=>[createVNode(QIcon,{name:"add",class:"text-h1"}),createVNode(QTooltip,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:withCtx(()=>[createVNode(QCard,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:withCtx(()=>[createTextVNode(" Create a new page ")]),_:1})]),_:1})]),_:1})]),_:1},512)}var PagePager=_export_sfc(_sfc_main$4,[["render",_sfc_render$4]]);const calendars=["gregorian","persian"],useDatetimeProps={modelValue:{required:!0},mask:{type:String},locale:Object,calendar:{type:String,validator:t=>calendars.includes(t),default:"gregorian"},landscape:Boolean,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,readonly:Boolean,disable:Boolean},useDatetimeEmits=["update:modelValue"];function getDayHash(t){return t.year+"/"+pad(t.month)+"/"+pad(t.day)}function useDatetime(t,e){const r=computed(()=>t.disable!==!0&&t.readonly!==!0),n=computed(()=>r.value===!0?0:-1),a=computed(()=>{const i=[];return t.color!==void 0&&i.push(`bg-${t.color}`),t.textColor!==void 0&&i.push(`text-${t.textColor}`),i.join(" ")});function o(){return t.locale!==void 0?{...e.lang.date,...t.locale}:e.lang.date}function s(i){const d=new Date,g=i===!0?null:0;if(t.calendar==="persian"){const l=toJalaali(d);return{year:l.jy,month:l.jm,day:l.jd}}return{year:d.getFullYear(),month:d.getMonth()+1,day:d.getDate(),hour:g,minute:g,second:g,millisecond:g}}return{editable:r,tabindex:n,headerClass:a,getLocale:o,getCurrentDate:s}}const yearsInterval=20,views=["Calendar","Years","Months"],viewIsValid=t=>views.includes(t),yearMonthValidator=t=>/^-?[\d]+\/[0-1]\d$/.test(t),lineStr=" \u2014 ";function getMonthHash(t){return t.year+"/"+pad(t.month)}var QDate=createComponent({name:"QDate",props:{...useDatetimeProps,...useFormProps,...useDarkProps,multiple:Boolean,range:Boolean,title:String,subtitle:String,mask:{default:"YYYY/MM/DD"},defaultYearMonth:{type:String,validator:yearMonthValidator},yearsInMonthView:Boolean,events:[Array,Function],eventColor:[String,Function],emitImmediately:Boolean,options:[Array,Function],navigationMinYearMonth:{type:String,validator:yearMonthValidator},navigationMaxYearMonth:{type:String,validator:yearMonthValidator},noUnset:Boolean,firstDayOfWeek:[String,Number],todayBtn:Boolean,minimal:Boolean,defaultView:{type:String,default:"Calendar",validator:viewIsValid}},emits:[...useDatetimeEmits,"rangeStart","rangeEnd","navigation"],setup(t,{slots:e,emit:r}){const{proxy:n}=getCurrentInstance(),{$q:a}=n,o=useDark(t,a),{getCache:s}=useCache(),{tabindex:i,headerClass:d,getLocale:g,getCurrentDate:l}=useDatetime(t,a);let u;const m=useFormAttrs(t),y=useFormInject(m),C=ref(null),T=ref(be()),N=ref(g()),M=computed(()=>be()),K=computed(()=>g()),R=computed(()=>l()),S=ref(we(T.value,N.value)),D=ref(t.defaultView),H=a.lang.rtl===!0?"right":"left",$=ref(H.value),z=ref(H.value),U=S.value.year,Q=ref(U-U%yearsInterval-(U<0?yearsInterval:0)),x=ref(null),re=computed(()=>{const c=t.landscape===!0?"landscape":"portrait";return`q-date q-date--${c} q-date--${c}-${t.minimal===!0?"minimal":"standard"}`+(o.value===!0?" q-date--dark q-dark":"")+(t.bordered===!0?" q-date--bordered":"")+(t.square===!0?" q-date--square no-border-radius":"")+(t.flat===!0?" q-date--flat no-shadow":"")+(t.disable===!0?" disabled":t.readonly===!0?" q-date--readonly":"")}),q=computed(()=>t.color||"primary"),j=computed(()=>t.textColor||"white"),F=computed(()=>t.emitImmediately===!0&&t.multiple!==!0&&t.range!==!0),b=computed(()=>Array.isArray(t.modelValue)===!0?t.modelValue:t.modelValue!==null&&t.modelValue!==void 0?[t.modelValue]:[]),E=computed(()=>b.value.filter(c=>typeof c=="string").map(c=>ue(c,T.value,N.value)).filter(c=>c.dateHash!==null&&c.day!==null&&c.month!==null&&c.year!==null)),I=computed(()=>{const c=f=>ue(f,T.value,N.value);return b.value.filter(f=>isObject$1(f)===!0&&f.from!==void 0&&f.to!==void 0).map(f=>({from:c(f.from),to:c(f.to)})).filter(f=>f.from.dateHash!==null&&f.to.dateHash!==null&&f.from.dateHash<f.to.dateHash)}),L=computed(()=>t.calendar!=="persian"?c=>new Date(c.year,c.month-1,c.day):c=>{const f=toGregorian(c.year,c.month,c.day);return new Date(f.gy,f.gm-1,f.gd)}),G=computed(()=>t.calendar==="persian"?getDayHash:(c,f,p)=>formatDate(new Date(c.year,c.month-1,c.day,c.hour,c.minute,c.second,c.millisecond),f===void 0?T.value:f,p===void 0?N.value:p,c.year,c.timezoneOffset)),Y=computed(()=>E.value.length+I.value.reduce((c,f)=>c+1+getDateDiff(L.value(f.to),L.value(f.from)),0)),ne=computed(()=>{if(t.title!==void 0&&t.title!==null&&t.title.length>0)return t.title;if(x.value!==null){const p=x.value.init,_=L.value(p);return N.value.daysShort[_.getDay()]+", "+N.value.monthsShort[p.month-1]+" "+p.day+lineStr+"?"}if(Y.value===0)return lineStr;if(Y.value>1)return`${Y.value} ${N.value.pluralDay}`;const c=E.value[0],f=L.value(c);return isNaN(f.valueOf())===!0?lineStr:N.value.headerTitle!==void 0?N.value.headerTitle(f,c):N.value.daysShort[f.getDay()]+", "+N.value.monthsShort[c.month-1]+" "+c.day}),ie=computed(()=>E.value.concat(I.value.map(f=>f.from)).sort((f,p)=>f.year-p.year||f.month-p.month)[0]),Ie=computed(()=>E.value.concat(I.value.map(f=>f.to)).sort((f,p)=>p.year-f.year||p.month-f.month)[0]),me=computed(()=>{if(t.subtitle!==void 0&&t.subtitle!==null&&t.subtitle.length>0)return t.subtitle;if(Y.value===0)return lineStr;if(Y.value>1){const c=ie.value,f=Ie.value,p=N.value.monthsShort;return p[c.month-1]+(c.year!==f.year?" "+c.year+lineStr+p[f.month-1]+" ":c.month!==f.month?lineStr+p[f.month-1]:"")+" "+f.year}return E.value[0].year}),ae=computed(()=>{const c=[a.iconSet.datetime.arrowLeft,a.iconSet.datetime.arrowRight];return a.lang.rtl===!0?c.reverse():c}),pe=computed(()=>t.firstDayOfWeek!==void 0?Number(t.firstDayOfWeek):N.value.firstDayOfWeek),Ne=computed(()=>{const c=N.value.daysShort,f=pe.value;return f>0?c.slice(f,7).concat(c.slice(0,f)):c}),W=computed(()=>{const c=S.value;return t.calendar!=="persian"?new Date(c.year,c.month,0).getDate():jalaaliMonthLength(c.year,c.month)}),ke=computed(()=>typeof t.eventColor=="function"?t.eventColor:()=>t.eventColor),V=computed(()=>{if(t.navigationMinYearMonth===void 0)return null;const c=t.navigationMinYearMonth.split("/");return{year:parseInt(c[0],10),month:parseInt(c[1],10)}}),O=computed(()=>{if(t.navigationMaxYearMonth===void 0)return null;const c=t.navigationMaxYearMonth.split("/");return{year:parseInt(c[0],10),month:parseInt(c[1],10)}}),le=computed(()=>{const c={month:{prev:!0,next:!0},year:{prev:!0,next:!0}};return V.value!==null&&V.value.year>=S.value.year&&(c.year.prev=!1,V.value.year===S.value.year&&V.value.month>=S.value.month&&(c.month.prev=!1)),O.value!==null&&O.value.year<=S.value.year&&(c.year.next=!1,O.value.year===S.value.year&&O.value.month<=S.value.month&&(c.month.next=!1)),c}),oe=computed(()=>{const c={};return E.value.forEach(f=>{const p=getMonthHash(f);c[p]===void 0&&(c[p]=[]),c[p].push(f.day)}),c}),ve=computed(()=>{const c={};return I.value.forEach(f=>{const p=getMonthHash(f.from),_=getMonthHash(f.to);if(c[p]===void 0&&(c[p]=[]),c[p].push({from:f.from.day,to:p===_?f.to.day:void 0,range:f}),p<_){let v;const{year:k,month:w}=f.from,P=w<12?{year:k,month:w+1}:{year:k+1,month:1};for(;(v=getMonthHash(P))<=_;)c[v]===void 0&&(c[v]=[]),c[v].push({from:void 0,to:v===_?f.to.day:void 0,range:f}),P.month++,P.month>12&&(P.year++,P.month=1)}}),c}),ee=computed(()=>{if(x.value===null)return;const{init:c,initHash:f,final:p,finalHash:_}=x.value,[v,k]=f<=_?[c,p]:[p,c],w=getMonthHash(v),P=getMonthHash(k);if(w!==B.value&&P!==B.value)return;const A={};return w===B.value?(A.from=v.day,A.includeFrom=!0):A.from=1,P===B.value?(A.to=k.day,A.includeTo=!0):A.to=W.value,A}),B=computed(()=>getMonthHash(S.value)),Ae=computed(()=>{const c={};if(t.options===void 0){for(let p=1;p<=W.value;p++)c[p]=!0;return c}const f=typeof t.options=="function"?t.options:p=>t.options.includes(p);for(let p=1;p<=W.value;p++){const _=B.value+"/"+pad(p);c[p]=f(_)}return c}),xe=computed(()=>{const c={};if(t.events===void 0)for(let f=1;f<=W.value;f++)c[f]=!1;else{const f=typeof t.events=="function"?t.events:p=>t.events.includes(p);for(let p=1;p<=W.value;p++){const _=B.value+"/"+pad(p);c[p]=f(_)===!0&&ke.value(_)}}return c}),De=computed(()=>{let c,f;const{year:p,month:_}=S.value;if(t.calendar!=="persian")c=new Date(p,_-1,1),f=new Date(p,_-1,0).getDate();else{const v=toGregorian(p,_,1);c=new Date(v.gy,v.gm-1,v.gd);let k=_-1,w=p;k===0&&(k=12,w--),f=jalaaliMonthLength(w,k)}return{days:c.getDay()-pe.value-1,endDay:f}}),_e=computed(()=>{const c=[],{days:f,endDay:p}=De.value,_=f<0?f+7:f;if(_<6)for(let w=p-_;w<=p;w++)c.push({i:w,fill:!0});const v=c.length;for(let w=1;w<=W.value;w++){const P={i:w,event:xe.value[w],classes:[]};Ae.value[w]===!0&&(P.in=!0,P.flat=!0),c.push(P)}if(oe.value[B.value]!==void 0&&oe.value[B.value].forEach(w=>{const P=v+w-1;Object.assign(c[P],{selected:!0,unelevated:!0,flat:!1,color:q.value,textColor:j.value})}),ve.value[B.value]!==void 0&&ve.value[B.value].forEach(w=>{if(w.from!==void 0){const P=v+w.from-1,A=v+(w.to||W.value)-1;for(let te=P;te<=A;te++)Object.assign(c[te],{range:w.range,unelevated:!0,color:q.value,textColor:j.value});Object.assign(c[P],{rangeFrom:!0,flat:!1}),w.to!==void 0&&Object.assign(c[A],{rangeTo:!0,flat:!1})}else if(w.to!==void 0){const P=v+w.to-1;for(let A=v;A<=P;A++)Object.assign(c[A],{range:w.range,unelevated:!0,color:q.value,textColor:j.value});Object.assign(c[P],{flat:!1,rangeTo:!0})}else{const P=v+W.value-1;for(let A=v;A<=P;A++)Object.assign(c[A],{range:w.range,unelevated:!0,color:q.value,textColor:j.value})}}),ee.value!==void 0){const w=v+ee.value.from-1,P=v+ee.value.to-1;for(let A=w;A<=P;A++)c[A].color=q.value,c[A].editRange=!0;ee.value.includeFrom===!0&&(c[w].editRangeFrom=!0),ee.value.includeTo===!0&&(c[P].editRangeTo=!0)}S.value.year===R.value.year&&S.value.month===R.value.month&&(c[v+R.value.day-1].today=!0);const k=c.length%7;if(k>0){const w=7-k;for(let P=1;P<=w;P++)c.push({i:P,fill:!0})}return c.forEach(w=>{let P="q-date__calendar-item ";w.fill===!0?P+="q-date__calendar-item--fill":(P+=`q-date__calendar-item--${w.in===!0?"in":"out"}`,w.range!==void 0&&(P+=` q-date__range${w.rangeTo===!0?"-to":w.rangeFrom===!0?"-from":""}`),w.editRange===!0&&(P+=` q-date__edit-range${w.editRangeFrom===!0?"-from":""}${w.editRangeTo===!0?"-to":""}`),(w.range!==void 0||w.editRange===!0)&&(P+=` text-${w.color}`)),w.classes=P}),c}),Re=computed(()=>t.disable===!0?{"aria-disabled":"true"}:t.readonly===!0?{"aria-readonly":"true"}:{});watch(()=>t.modelValue,c=>{if(u===c)u=0;else{const f=we(T.value,N.value);X(f.year,f.month,f)}}),watch(D,()=>{C.value!==null&&n.$el.contains(document.activeElement)===!0&&C.value.focus()}),watch(()=>S.value.year+"|"+S.value.month,()=>{r("navigation",{year:S.value.year,month:S.value.month})}),watch(M,c=>{Te(c,N.value,"mask"),T.value=c}),watch(K,c=>{Te(T.value,c,"locale"),N.value=c});function ye(){const c=R.value,f=oe.value[getMonthHash(c)];(f===void 0||f.includes(c.day)===!1)&&he(c),ce(c.year,c.month)}function Ve(c){viewIsValid(c)===!0&&(D.value=c)}function Oe(c,f){["month","year"].includes(c)&&(c==="month"?Ee:de)(f===!0?-1:1)}function ce(c,f){D.value="Calendar",X(c,f)}function Le(c,f){if(t.range===!1||!c){x.value=null;return}const p=Object.assign({...S.value},c),_=f!==void 0?Object.assign({...S.value},f):p;x.value={init:p,initHash:getDayHash(p),final:_,finalHash:getDayHash(_)},ce(p.year,p.month)}function be(){return t.calendar==="persian"?"YYYY/MM/DD":t.mask}function ue(c,f,p){return __splitDate(c,f,p,t.calendar,{hour:0,minute:0,second:0,millisecond:0})}function we(c,f){const p=Array.isArray(t.modelValue)===!0?t.modelValue:t.modelValue?[t.modelValue]:[];if(p.length===0)return Se();const _=p[p.length-1],v=ue(_.from!==void 0?_.from:_,c,f);return v.dateHash===null?Se():v}function Se(){let c,f;if(t.defaultYearMonth!==void 0){const p=t.defaultYearMonth.split("/");c=parseInt(p[0],10),f=parseInt(p[1],10)}else{const p=R.value!==void 0?R.value:l();c=p.year,f=p.month}return{year:c,month:f,day:1,hour:0,minute:0,second:0,millisecond:0,dateHash:c+"/"+pad(f)+"/01"}}function Ee(c){let f=S.value.year,p=Number(S.value.month)+c;p===13?(p=1,f++):p===0&&(p=12,f--),X(f,p),F.value===!0&&se("month")}function de(c){const f=Number(S.value.year)+c;X(f,S.value.month),F.value===!0&&se("year")}function Be(c){X(c,S.value.month),D.value=t.defaultView==="Years"?"Months":"Calendar",F.value===!0&&se("year")}function $e(c){X(S.value.year,c),D.value="Calendar",F.value===!0&&se("month")}function Me(c,f){const p=oe.value[f];(p!==void 0&&p.includes(c.day)===!0?fe:he)(c)}function J(c){return{year:c.year,month:c.month,day:c.day}}function X(c,f,p){if(V.value!==null&&c<=V.value.year&&(c=V.value.year,f<V.value.month&&(f=V.value.month)),O.value!==null&&c>=O.value.year&&(c=O.value.year,f>O.value.month&&(f=O.value.month)),p!==void 0){const{hour:v,minute:k,second:w,millisecond:P,timezoneOffset:A,timeHash:te}=p;Object.assign(S.value,{hour:v,minute:k,second:w,millisecond:P,timezoneOffset:A,timeHash:te})}const _=c+"/"+pad(f)+"/01";_!==S.value.dateHash&&($.value=S.value.dateHash<_==(a.lang.rtl!==!0)?"left":"right",c!==S.value.year&&(z.value=$.value),nextTick(()=>{Q.value=c-c%yearsInterval-(c<0?yearsInterval:0),Object.assign(S.value,{year:c,month:f,day:1,dateHash:_})}))}function Ce(c,f,p){const _=c!==null&&c.length===1&&t.multiple===!1?c[0]:c;u=_;const{reason:v,details:k}=Pe(f,p);r("update:modelValue",_,v,k)}function se(c){const f=E.value[0]!==void 0&&E.value[0].dateHash!==null?{...E.value[0]}:{...S.value};nextTick(()=>{f.year=S.value.year,f.month=S.value.month;const p=t.calendar!=="persian"?new Date(f.year,f.month,0).getDate():jalaaliMonthLength(f.year,f.month);f.day=Math.min(Math.max(1,f.day),p);const _=Z(f);u=_;const{details:v}=Pe("",f);r("update:modelValue",_,c,v)})}function Pe(c,f){return f.from!==void 0?{reason:`${c}-range`,details:{...J(f.target),from:J(f.from),to:J(f.to)}}:{reason:`${c}-day`,details:J(f)}}function Z(c,f,p){return c.from!==void 0?{from:G.value(c.from,f,p),to:G.value(c.to,f,p)}:G.value(c,f,p)}function he(c){let f;if(t.multiple===!0)if(c.from!==void 0){const p=getDayHash(c.from),_=getDayHash(c.to),v=E.value.filter(w=>w.dateHash<p||w.dateHash>_),k=I.value.filter(({from:w,to:P})=>P.dateHash<p||w.dateHash>_);f=v.concat(k).concat(c).map(w=>Z(w))}else{const p=b.value.slice();p.push(Z(c)),f=p}else f=Z(c);Ce(f,"add",c)}function fe(c){if(t.noUnset===!0)return;let f=null;if(t.multiple===!0&&Array.isArray(t.modelValue)===!0){const p=Z(c);c.from!==void 0?f=t.modelValue.filter(_=>_.from!==void 0?_.from!==p.from&&_.to!==p.to:!0):f=t.modelValue.filter(_=>_!==p),f.length===0&&(f=null)}Ce(f,"remove",c)}function Te(c,f,p){const _=E.value.concat(I.value).map(v=>Z(v,c,f)).filter(v=>v.from!==void 0?v.from.dateHash!==null&&v.to.dateHash!==null:v.dateHash!==null);r("update:modelValue",(t.multiple===!0?_:_[0])||null,p)}function Ue(){if(t.minimal!==!0)return h("div",{class:"q-date__header "+d.value},[h("div",{class:"relative-position"},[h(Transition,{name:"q-transition--fade"},()=>h("div",{key:"h-yr-"+me.value,class:"q-date__header-subtitle q-date__header-link "+(D.value==="Years"?"q-date__header-link--active":"cursor-pointer"),tabindex:i.value,...s("vY",{onClick(){D.value="Years"},onKeyup(c){c.keyCode===13&&(D.value="Years")}})},[me.value]))]),h("div",{class:"q-date__header-title relative-position flex no-wrap"},[h("div",{class:"relative-position col"},[h(Transition,{name:"q-transition--fade"},()=>h("div",{key:"h-sub"+ne.value,class:"q-date__header-title-label q-date__header-link "+(D.value==="Calendar"?"q-date__header-link--active":"cursor-pointer"),tabindex:i.value,...s("vC",{onClick(){D.value="Calendar"},onKeyup(c){c.keyCode===13&&(D.value="Calendar")}})},[ne.value]))]),t.todayBtn===!0?h(QBtn,{class:"q-date__header-today self-start",icon:a.iconSet.datetime.today,flat:!0,size:"sm",round:!0,tabindex:i.value,onClick:ye}):null])])}function ge({label:c,type:f,key:p,dir:_,goTo:v,boundaries:k,cls:w}){return[h("div",{class:"row items-center q-date__arrow"},[h(QBtn,{round:!0,dense:!0,size:"sm",flat:!0,icon:ae.value[0],tabindex:i.value,disable:k.prev===!1,...s("go-#"+f,{onClick(){v(-1)}})})]),h("div",{class:"relative-position overflow-hidden flex flex-center"+w},[h(Transition,{name:"q-transition--jump-"+_},()=>h("div",{key:p},[h(QBtn,{flat:!0,dense:!0,noCaps:!0,label:c,tabindex:i.value,...s("view#"+f,{onClick:()=>{D.value=f}})})]))]),h("div",{class:"row items-center q-date__arrow"},[h(QBtn,{round:!0,dense:!0,size:"sm",flat:!0,icon:ae.value[1],tabindex:i.value,disable:k.next===!1,...s("go+#"+f,{onClick(){v(1)}})})])]}const qe={Calendar:()=>[h("div",{key:"calendar-view",class:"q-date__view q-date__calendar"},[h("div",{class:"q-date__navigation row items-center no-wrap"},ge({label:N.value.months[S.value.month-1],type:"Months",key:S.value.month,dir:$.value,goTo:Ee,boundaries:le.value.month,cls:" col"}).concat(ge({label:S.value.year,type:"Years",key:S.value.year,dir:z.value,goTo:de,boundaries:le.value.year,cls:""}))),h("div",{class:"q-date__calendar-weekdays row items-center no-wrap"},Ne.value.map(c=>h("div",{class:"q-date__calendar-item"},[h("div",c)]))),h("div",{class:"q-date__calendar-days-container relative-position overflow-hidden"},[h(Transition,{name:"q-transition--slide-"+$.value},()=>h("div",{key:B.value,class:"q-date__calendar-days fit"},_e.value.map(c=>h("div",{class:c.classes},[c.in===!0?h(QBtn,{class:c.today===!0?"q-date__today":"",dense:!0,flat:c.flat,unelevated:c.unelevated,color:c.color,textColor:c.textColor,label:c.i,tabindex:i.value,...s("day#"+c.i,{onClick:()=>{Fe(c.i)},onMouseover:()=>{He(c.i)}})},c.event!==!1?()=>h("div",{class:"q-date__event bg-"+c.event}):null):h("div",""+c.i)]))))])])],Months(){const c=S.value.year===R.value.year,f=_=>V.value!==null&&S.value.year===V.value.year&&V.value.month>_||O.value!==null&&S.value.year===O.value.year&&O.value.month<_,p=N.value.monthsShort.map((_,v)=>{const k=S.value.month===v+1;return h("div",{class:"q-date__months-item flex flex-center"},[h(QBtn,{class:c===!0&&R.value.month===v+1?"q-date__today":null,flat:k!==!0,label:_,unelevated:k,color:k===!0?q.value:null,textColor:k===!0?j.value:null,tabindex:i.value,disable:f(v+1),...s("month#"+v,{onClick:()=>{$e(v+1)}})})])});return t.yearsInMonthView===!0&&p.unshift(h("div",{class:"row no-wrap full-width"},[ge({label:S.value.year,type:"Years",key:S.value.year,dir:z.value,goTo:de,boundaries:le.value.year,cls:" col"})])),h("div",{key:"months-view",class:"q-date__view q-date__months flex flex-center"},p)},Years(){const c=Q.value,f=c+yearsInterval,p=[],_=v=>V.value!==null&&V.value.year>v||O.value!==null&&O.value.year<v;for(let v=c;v<=f;v++){const k=S.value.year===v;p.push(h("div",{class:"q-date__years-item flex flex-center"},[h(QBtn,{key:"yr"+v,class:R.value.year===v?"q-date__today":null,flat:!k,label:v,dense:!0,unelevated:k,color:k===!0?q.value:null,textColor:k===!0?j.value:null,tabindex:i.value,disable:_(v),...s("yr#"+v,{onClick:()=>{Be(v)}})})]))}return h("div",{class:"q-date__view q-date__years flex flex-center"},[h("div",{class:"col-auto"},[h(QBtn,{round:!0,dense:!0,flat:!0,icon:ae.value[0],tabindex:i.value,disable:_(c),...s("y-",{onClick:()=>{Q.value-=yearsInterval}})})]),h("div",{class:"q-date__years-content col self-stretch row items-center"},p),h("div",{class:"col-auto"},[h(QBtn,{round:!0,dense:!0,flat:!0,icon:ae.value[1],tabindex:i.value,disable:_(f),...s("y+",{onClick:()=>{Q.value+=yearsInterval}})})])])}};function Fe(c){const f={...S.value,day:c};if(t.range===!1){Me(f,B.value);return}if(x.value===null){const p=_e.value.find(v=>v.fill!==!0&&v.i===c);if(t.noUnset!==!0&&p.range!==void 0){fe({target:f,from:p.range.from,to:p.range.to});return}if(p.selected===!0){fe(f);return}const _=getDayHash(f);x.value={init:f,initHash:_,final:f,finalHash:_},r("rangeStart",J(f))}else{const p=x.value.initHash,_=getDayHash(f),v=p<=_?{from:x.value.init,to:f}:{from:f,to:x.value.init};x.value=null,he(p===_?f:{target:f,...v}),r("rangeEnd",{from:J(v.from),to:J(v.to)})}}function He(c){if(x.value!==null){const f={...S.value,day:c};Object.assign(x.value,{final:f,finalHash:getDayHash(f)})}}return Object.assign(n,{setToday:ye,setView:Ve,offsetCalendar:Oe,setCalendarTo:ce,setEditingRange:Le}),()=>{const c=[h("div",{class:"q-date__content col relative-position"},[h(Transition,{name:"q-transition--fade"},qe[D.value])])],f=hSlot(e.default);return f!==void 0&&c.push(h("div",{class:"q-date__actions"},f)),t.name!==void 0&&t.disable!==!0&&y(c,"push"),h("div",{class:re.value,...Re.value},[Ue(),h("div",{ref:C,class:"q-date__main col column",tabindex:-1},c)])}}});const alignValues=["top","middle","bottom"];var QBadge=createComponent({name:"QBadge",props:{color:String,textColor:String,floating:Boolean,transparent:Boolean,multiLine:Boolean,outline:Boolean,rounded:Boolean,label:[Number,String],align:{type:String,validator:t=>alignValues.includes(t)}},setup(t,{slots:e}){const r=computed(()=>t.align!==void 0?{verticalAlign:t.align}:null),n=computed(()=>{const a=t.outline===!0&&t.color||t.textColor;return`q-badge flex inline items-center no-wrap q-badge--${t.multiLine===!0?"multi":"single"}-line`+(t.outline===!0?" q-badge--outline":t.color!==void 0?` bg-${t.color}`:"")+(a!==void 0?` text-${a}`:"")+(t.floating===!0?" q-badge--floating":"")+(t.rounded===!0?" q-badge--rounded":"")+(t.transparent===!0?" q-badge--transparent":"")});return()=>h("div",{class:n.value,style:r.value,role:"status","aria-label":t.label},hMergeSlot(e.default,t.label!==void 0?[t.label]:[]))}}),dist={exports:{}},request={},browser$1={exports:{}};(function(t,e){var r=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof n!="undefined")return n;throw new Error("unable to locate global object")},n=r();t.exports=e=n.fetch,n.fetch&&(e.default=n.fetch.bind(n)),e.Headers=n.Headers,e.Request=n.Request,e.Response=n.Response})(browser$1,browser$1.exports);var errors={};Object.defineProperty(errors,"__esModule",{value:!0});errors.citationError=errors.pdfError=errors.fcError=errors.eventsError=errors.mediaError=errors.relatedError=errors.introError=errors.preloadError=errors.infoboxError=errors.coordinatesError=errors.geoSearchError=errors.linksError=errors.categoriesError=errors.contentError=errors.htmlError=errors.imageError=errors.summaryError=errors.pageError=errors.autocompletionsError=errors.searchError=errors.wikiError=void 0;class wikiError extends Error{constructor(e,r){super(e),this.name="wikiError",this.code=r}}errors.wikiError=wikiError;class searchError extends wikiError{constructor(e){super(e),this.name="searchError"}}errors.searchError=searchError;class autocompletionsError extends wikiError{constructor(e){super(e),this.name="autocompletionsError"}}errors.autocompletionsError=autocompletionsError;class pageError extends wikiError{constructor(e){super(e),this.name="pageError"}}errors.pageError=pageError;class summaryError extends wikiError{constructor(e){super(e),this.name="summaryError"}}errors.summaryError=summaryError;class imageError extends wikiError{constructor(e){super(e),this.name="imageError"}}errors.imageError=imageError;class htmlError extends wikiError{constructor(e){super(e),this.name="htmlError"}}errors.htmlError=htmlError;class contentError extends wikiError{constructor(e){super(e),this.name="contentError"}}errors.contentError=contentError;class categoriesError extends wikiError{constructor(e){super(e),this.name="categoriesError"}}errors.categoriesError=categoriesError;class linksError extends wikiError{constructor(e){super(e),this.name="linksError"}}errors.linksError=linksError;class geoSearchError extends wikiError{constructor(e){super(e),this.name="geoSearchError"}}errors.geoSearchError=geoSearchError;class coordinatesError extends wikiError{constructor(e){super(e),this.name="coordinatesError"}}errors.coordinatesError=coordinatesError;class infoboxError extends wikiError{constructor(e){super(e),this.name="infoboxError"}}errors.infoboxError=infoboxError;class preloadError extends wikiError{constructor(e){super(e),this.name="preloadError"}}errors.preloadError=preloadError;class introError extends wikiError{constructor(e){super(e),this.name="introError"}}errors.introError=introError;class relatedError extends wikiError{constructor(e){super(e),this.name="relatedError"}}errors.relatedError=relatedError;class mediaError extends wikiError{constructor(e){super(e),this.name="mediaError"}}errors.mediaError=mediaError;class eventsError extends wikiError{constructor(e){super(e),this.name="eventsError"}}errors.eventsError=eventsError;class fcError extends wikiError{constructor(e){super(e),this.name="featuredContentError"}}errors.fcError=fcError;class pdfError extends wikiError{constructor(e){super(e),this.name="pdfError"}}errors.pdfError=pdfError;class citationError extends wikiError{constructor(e){super(e),this.name="citationError"}}errors.citationError=citationError;Object.defineProperty(request,"__esModule",{value:!0});request.setAPIUrl=request.returnRestUrl=request.makeRestRequest=void 0;const node_fetch_1=browser$1.exports,errors_1$1=errors;let API_URL="https://en.wikipedia.org/w/api.php?",REST_API_URL="https://en.wikipedia.org/api/rest_v1/";const USER_AGENT="wikipedia (https://github.com/dopecodez/Wikipedia/)";async function makeRequest(t,e=!0){try{const r={...t};r.format="json",e&&(r.redirects=""),t.action||(r.action="query"),r.origin="*";const n={headers:{"Api-User-Agent":USER_AGENT}};let a="";return Object.keys(r).forEach(i=>{a+=`${i}=${r[i]}&`}),await(await(0,node_fetch_1.default)(encodeURI(API_URL+a),n)).json()}catch(r){throw new errors_1$1.wikiError(r)}}async function makeRestRequest(t,e=!0){try{e||(t+="?redirect=false");const r={headers:{"Api-User-Agent":USER_AGENT}};let a=await(await(0,node_fetch_1.default)(encodeURI(REST_API_URL+t),r)).text();try{a=JSON.parse(a)}finally{return a}}catch(r){throw new errors_1$1.wikiError(r)}}request.makeRestRequest=makeRestRequest;function returnRestUrl(t){return encodeURI(REST_API_URL+t)}request.returnRestUrl=returnRestUrl;function setAPIUrl(t){return API_URL="https://"+t.toLowerCase()+".wikipedia.org/w/api.php?",REST_API_URL="https://"+t.toLowerCase()+".wikipedia.org/api/rest_v1/",API_URL}request.setAPIUrl=setAPIUrl;request.default=makeRequest;var page={},utils={},messages={};Object.defineProperty(messages,"__esModule",{value:!0});messages.MSGS=void 0;messages.MSGS={PAGE_NOT_SUGGEST:"No page with given title suggested : ",PAGE_NOT_EXIST:"No page with given title exists : ",INFOBOX_NOT_EXIST:"Info cannot be parsed for given page"};Object.defineProperty(utils,"__esModule",{value:!0});utils.getCurrentDay=utils.getCurrentMonth=utils.getCurrentYear=utils.setPageId=utils.setPageIdOrTitleParam=utils.setTitleForPage=utils.isString=void 0;const _1=dist.exports,errors_1=errors,messages_1=messages;function isString(t){return isNaN(t)}utils.isString=isString;async function setTitleForPage(t){{const e=await _1.default.search(t,{limit:1,suggestion:!0});if(!e.suggestion&&e.results.length==0)throw new errors_1.pageError(`${messages_1.MSGS.PAGE_NOT_SUGGEST}${t}`);return t=e.suggestion||t,t}}utils.setTitleForPage=setTitleForPage;function setPageIdOrTitleParam(t,e){return isString(e)?t.titles=e:t.pageids=e,t}utils.setPageIdOrTitleParam=setPageIdOrTitleParam;function setPageId(t,e){let r;return t.pageIds?r=t.pageIds:r=Object.keys(e.query.pages)[0],r}utils.setPageId=setPageId;function getCurrentYear(){return new Date().getFullYear()}utils.getCurrentYear=getCurrentYear;function getCurrentMonth(){return new Date().getMonth()+1}utils.getCurrentMonth=getCurrentMonth;function getCurrentDay(){return new Date().getDate()}utils.getCurrentDay=getCurrentDay;function preserveCamelCase(t){let e=!1,r=!1,n=!1;for(let a=0;a<t.length;a++){const o=t[a];e&&/[a-zA-Z]/.test(o)&&o.toUpperCase()===o?(t=t.substr(0,a)+"-"+t.substr(a),e=!1,n=r,r=!0,a++):r&&n&&/[a-zA-Z]/.test(o)&&o.toLowerCase()===o?(t=t.substr(0,a-1)+"-"+t.substr(a-1),n=r,r=!1,e=!0):(e=o.toLowerCase()===o,n=r,r=o.toUpperCase()===o)}return t}var camelcase=function(t){return arguments.length>1?t=Array.from(arguments).map(r=>r.trim()).filter(r=>r.length).join("-"):t=t.trim(),t.length===0?"":t.length===1?t.toLowerCase():/^[a-z0-9]+$/.test(t)?t:(t!==t.toLowerCase()&&(t=preserveCamelCase(t)),t.replace(/^[_.\- ]+/,"").toLowerCase().replace(/[_.\- ]+(\w|$)/g,(r,n)=>n.toUpperCase()))};function _interopDefault(t){return t&&typeof t=="object"&&"default"in t?t.default:t}function trimWrappers(t){return t.replace(/\[\[/g,"").replace(/\]\]/g,"").replace(/\{\{/g,"").replace(/\}\}/g,"").trim()}function trimOr(t){var e=t.indexOf("|");return e!==-1?t.substring(0,e):t}function getValue(t,e){if(!t)return null;var r=t.trim().replace(/File:/,"").replace(/\{\{\d+\}\}/g,"").replace(extraPropertyPattern,"").replace(endingPattern,"");if(r==="y"||r==="yes")return!0;if(e=="birthPlace")return t.trim();var n=r.match(linksPattern);return n?n[0].split(linkSeparatorPattern).filter(function(a){return a}):trimOr(trimWrappers(r))}function dataType(t){var e=t.globalPattern,r=t.parsePattern,n=t.parse,a=t.variable,o=t.name;return function(s){var i=s.match(e);if(!i){var d;return d={},defineProperty(d,o,[]),defineProperty(d,"sourceAfter",s),d}var g=i.map(function(u){return n(u.match(r))}),l=i.reduce(function(u,m,y){return g[y]===DO_NOT_REPLACE?u:u.replace(m,"$"+a+"_"+y)},s);return{data:defineProperty({},o,g),sourceAfter:l}}}function byDataHandler(t,e){var r=t.source,n=t.context,a=e(r),o=a.data,s=a.sourceAfter;return{context:Object.assign({},n,o),source:s}}function extractData(t){return dataTypes$1.map(function(e){return e.handler}).reduce(byDataHandler,{context:{},source:t})}function findPropertyList(t){var e=t.match(keyValueGlobalPattern);return e?e.map(function(r){var n=keyValuePattern.exec(r);if(!n)return null;var a=slicedToArray(n,3),o=a[1],s=a[2],i=camelCase(o.trim());return{key:i,value:getValue(s,i)}}).filter(function(r){return r}):[]}function fillVariable(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=r.simplifyDataValues;if(typeof t!="string")return console.log("Warning: Something went wrong. Could not fill variables in: ("+(t===void 0?"undefined":_typeof(t))+") "+JSON.stringify(t)),{};var a=dataTypes$1.find(function(l){return t.match(l.pattern)});if(a){var o=a.pattern.exec(t),s=slicedToArray(o,2),i=s[0],d=s[1],g=e[a.name][parseInt(d,10)];return n||typeof g!="string"?g:t.replace(i,g)}return t}function fillVariables(t,e,r){if(t===void 0||t instanceof Date||typeof t=="number")return t;if(Array.isArray(t))return t.map(function(a){return fillVariables(a,e,r)});if((t===void 0?"undefined":_typeof(t))==="object")return Object.keys(t).reduce(function(a,o){return Object.assign(a,defineProperty({},o,fillVariables(t[o],e,r)))},{});var n=fillVariable(t,e,r);return n===t?t:fillVariables(n,e,r)}function handleSmallData(t,e,r){var n=r.simplifyDataValues;if(typeof t=="string"&&t.match(smallDataType.pattern)){var a=t.replace(smallDataType.pattern,"").replace(/,/,"").trim(),o=smallDataType.pattern.exec(t),s=slicedToArray(o,2),i=s[1],d=e[smallDataType.name][parseInt(i,10)],g={primary:getVariableValue(a,e,{simplifyDataValues:n}),secondary:getVariableValue(d,e,{simplifyDataValues:n})};return n?g.primary:g}return null}function getVariableValue(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=r.simplifyDataValues,a=handleSmallData(t,e,{simplifyDataValues:n});return a||fillVariables(t,e,{simplifyDataValues:n})}function reduceVariable(t,e,r,n){if(e===null)return null;if(typeof e=="boolean")return e;if(Array.isArray(e))return e.map(function(i){return getVariableValue(i,r,n)});if(t.match(/areaTotal/)||t.match(/population/)){var a=numberParse(e);if(a===!1&&(a=parseFloat(e,10)),!isNaN(a))return a}if(t.match(/date/i)){var o=+new Date(e);if(!isNaN(o))return new Date(e)}var s=getVariableValue(e,r,n);return Array.isArray(s)?s.map(function(i){return getVariableValue(i,r,n)}):s}function byVariableReduction(t,e){return function(r,n){var a=n.key,o=n.value,s=reduceVariable(a,o,t,e);return s===""||s===null?r:Object.assign({},r,defineProperty({},a,s))}}function extractProperties(t){var e=t.source,r=t.context,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.simplifyDataValues,o=a===void 0||a;return findPropertyList(e).reduce(byVariableReduction(r,{simplifyDataValues:o}),{})}function transformProperties(t){return Object.keys(t).reduce(function(e,r){var n=t[r],a=r.match(blankNamePattern);if(a){var o=a[1]||"",s=t["blank"+o+"NameSec2"],i=t["blank"+o+"InfoSec2"];return typeof s!="string"?e:Object.assign(e,defineProperty({},camelCase(s),i))}return r.match(blankInfoPattern)?e:Object.assign(e,defineProperty({},r,n))},{})}function findOuterIndex(t){for(var e=[],r=0;r<t.length-1;r++){var n=t.substr(r,2);if(n!=="{{"){if(n==="}}"){if(e.pop(),e.length===0)return r+2;r++}}else e.push(r),r++}}function parse(t){var e=t.match(infoBoxStartPattern);if(!e)return{data:t,sourceLeft:null};var r=e.index,n=t.substring(r),a=findOuterIndex(n);if(!a)return{data:t,sourceLeft:null};var o=n.substring(0,a),s=t.substring(a);return{data:o,sourceLeft:s.match(infoBoxStartPattern)?s:null}}function extractInfoboxes(t){for(var e=parse(t),r=[e.data];e.sourceLeft;)e=parse(e.sourceLeft),r.push(e.data);return r}function cleanSource(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.removeSmall,n=r!==void 0&&r,a=e.removeReferences;return(a===void 0||a)&&(t=t.replace(/<ref(\s\w+=[^>]+)?>.*<\/ref>/g,"").replace(/<ref(\s\w+=[^>]+)?\s?\/>/g,"")),n&&(t=t.replace(/<small>.*<\/small>/g,"")),t.replace(/'''?/g,"").replace(/\|display=inline/g,"").replace(/<br\s?\/?>/g,",").replace(/&minus;/g,"-").replace(/<sup>/g,"^").replace(/\{\{sfn\|([^\}\}]+)\}\}/g,"").replace(/\{\{efn\|([^\}\}]+)\}\}/g,"").replace(/−/g,"-").replace(/<\/sup>/g,"").replace(/\{\{\s*nowrap\s*\|([^\n\}]+)\}\}/gi,"$1").replace(/<!--([\s\S]*?)-->/g,"").replace(/&nbsp;/g," ").replace("|''See list''","")}function transformRowSpan(t){return t.map(transformCells).reduce(function(e,r,n){for(var a=n===0?0:1,o=0;o<r.length;o++)e[o+a]||(e[o+a]={}),r[o]&&(e[o+a][r[o]]=1);return e},[]).map(function(e){return Object.keys(e).join(",")}).join(" || ")}function clean(t){return t.substring(2,t.length-2).replace(linkPattern$1,function(e,r){return r.split("|")[0]}).replace(/'''?/g,"")}function parseRow(t){var e=t[0].match(/BS(\d)/),r=t[0].substring(2),n=1,a=[],o=1;for(e&&(n=e[1],r=t[0].substring(3));o<=n;o++)a.push(t[o]);return{type:r,margin:t[o++],text1:t[o++],text2:t[o++],comment:t[o++],icons:a}}function getMatches(t,e){for(var r=void 0,n=[];(r=e.exec(t))!==null;)n.push({value:r[1]&&r[1].trim(),start:r.index,end:r.index+r[0].length});return n}function parseTableData(t){var e=t.match(rowPattern$1);return e?e.map(function(r){var n=r.match(rowPatternSingle);return slicedToArray(n,2)[1].trim().split("|").slice(1)}):[]}function getTables(t){var e=getMatches(t,tableStartPattern$1),r=getMatches(t,tableEndPattern$1);return e.map(function(n,a){var o=r[a];if(!o)throw new Error("[Table Parsing] Failed to pair table");return{rows:parseTableData(t.substring(n.end,o.start).trim().replace(/'''/g,"")),start:n.start,end:o.end}})}function last(t){return t.length?t[t.length-1]:void 0}function parseInfobox(t,e){var r=extractInfoboxes(t).map(function(a){return transformProperties(extractProperties(extractData(cleanSource(a,e)),e))});if(!r.length)return{};var n={general:r.shift()};return r.forEach(function(a){var o=a.type;o?n[camelCase(o)]=a:Object.assign(n,{general:Object.assign({},n.general,a)})}),n.tables=parseTables(t),n.bsTables=parseBsTables(t),n.lists=parseLists(t),n}var camelCase=_interopDefault(camelcase),_typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},defineProperty=function(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t},slicedToArray=function(){function t(e,r){var n=[],a=!0,o=!1,s=void 0;try{for(var i,d=e[Symbol.iterator]();!(a=(i=d.next()).done)&&(n.push(i.value),!r||n.length!==r);a=!0);}catch(g){o=!0,s=g}finally{try{!a&&d.return&&d.return()}finally{if(o)throw s}}return n}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),toConsumableArray=function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)},smallGlobalPattern=/\{\{small\|([^\}\}]+)\}\}/g,smallPattern=/small\|([^\}\}]+)\}\}/,small={globalPattern:smallGlobalPattern,parsePattern:smallPattern,parse:function(t){return slicedToArray(t,2)[1]},variable:"SMALL",name:"smalls"},flagGlobalPattern=/\{\{flag\|([^\}\}]+)\}\}/g,flagPattern=/flag\|([^\}\}]+)\}\}/,flag={globalPattern:flagGlobalPattern,parsePattern:flagPattern,parse:function(t){return slicedToArray(t,2)[1]},variable:"FLAG",name:"flags"},coordsGlobalPattern=/\{\{coord\|([^\}\}]+)\}\}/g,coordsPattern=/coord\|([^\}\}]+)\}\}/,coords={globalPattern:coordsGlobalPattern,parsePattern:coordsPattern,parse:function(t){return slicedToArray(t,2)[1]},variable:"COORD",name:"coords"},globalPattern=/\[\[([^\]\|]+)\|?([^\]]+)?\]\]/g,pattern=/\[\[([^\]\|]+)\|?([^\]]+)?\]\]/,instances={globalPattern,parsePattern:pattern,parse:function(t){var e=slicedToArray(t,3),r=e[1],n=e[2];return r||n},variable:"INSTANCE",name:"instances"},extraPropertyPattern=/\n?\s?\|\s?\w+$/,endingPattern=/\n\}\}$/,linksPattern=/((\$\w+_\d+)\s*,?\s*){2,}/g,linkSeparatorPattern=/[,\s?]/g,listItemPrefixPattern=/^\|\s?/,unbulletedListGlobalPattern=/\{\{(?:unbulleted list|ubl|ubt|ublist|unbullet)\s?\|([^\}\}]+)\}\}/gi,unbulletedListItemPattern=/\|\s*([^|}]+)/g,unbulletedLists={globalPattern:unbulletedListGlobalPattern,parsePattern:unbulletedListItemPattern,parse:function(t){return t?t.map(function(e){return e.replace(listItemPrefixPattern,"").trim()}).filter(function(e){return e&&e.length}):[]},variable:"UNBULLETED_LIST",name:"unbulletedLists"},listItemPrefixPattern$1=/^\*\s*/,plainListGlobalPattern=/\n(\*\s*[^*|]+)+/g,plainListItemPattern=/\*\s*([^*|]+)/g,unmarkedLists={globalPattern:plainListGlobalPattern,parsePattern:plainListItemPattern,parse:function(t){return t?t.map(function(e){return e.replace(listItemPrefixPattern$1,"").trim()}).filter(function(e){return e&&e.length}):[]},variable:"UNMARKED_LIST",name:"unmarkedLists"},listItemPrefixPattern$2=/^\*\s?/,plainListGlobalPattern$1=/\{\{f?p?P?l?a?i?n?t?\s?list\s?\|([^\}\}]+)\}\}/g,plainListItemPattern$1=/\*\s*([^*}]+)/g,plainLists={globalPattern:plainListGlobalPattern$1,parsePattern:plainListItemPattern$1,parse:function(t){return t?t.map(function(e){return e.replace(listItemPrefixPattern$2,"").trim()}).filter(function(e){return e&&e.length}):[]},variable:"PLAIN_LIST",name:"plainLists"},marriageGlobalPattern=/\{\{Marriage\|([^\}\}]+)\}\}/gi,marriagePattern=/Marriage\|([^|]+)\|(.*)\}\}/i,marriages={globalPattern:marriageGlobalPattern,parsePattern:marriagePattern,parse:function(t){var e=slicedToArray(t,3);return{who:e[1],married:e[2]}},variable:"MARRIAGE",name:"marriages"},nbayGlobalPattern=/\{\{nbay\|([^\}\}]+)\}\}/gi,nbayPattern=/nbay\|([^|]+)\|(.*)\}\}/i,nbay={globalPattern:nbayGlobalPattern,parsePattern:nbayPattern,parse:function(t){var e=slicedToArray(t,3),r=e[1];return e[2],r},variable:"nbay",name:"nbay"},otherGlobalPattern=/\{\{([^|\n]+)\|([^|\n]+)\|?([^\}\n]+)?\}\}/g,otherPattern=/\{\{([^|\n]+)\|([^|\n]+)\|?([^\}\n]+)?\}\}/,other={globalPattern:otherGlobalPattern,parsePattern:otherPattern,parse:function(t){var e=slicedToArray(t,4),r=e[1];return e[2],e[3],r},variable:"OTHER",name:"others"},hlistGlobalPattern=/\{\{hlist\|([^\}\}]+)\}\}/gi,hlistPattern=/hlist\|(.*)\n?\}\}/i,hlist={globalPattern:hlistGlobalPattern,parsePattern:hlistPattern,parse:function(t){return slicedToArray(t,2)[1].split("|")},variable:"HLIST",name:"hlists"},birthDateGlobalPattern=/\{\{birth\sdate([^\}\}]+)\}\}/gi,birthDatePattern=/(\d+)\|(\d+)\|(\d+)/,millisInYear=31536e6,birthDates={globalPattern:birthDateGlobalPattern,parsePattern:birthDatePattern,parse:function(t){var e=slicedToArray(t,4),r=e[1],n=e[2],a=e[3],o=new Date(r,n-1,a);return{date:o,age:Math.floor((Date.now()-+o)/millisInYear)}},variable:"BIRTH_DATE",name:"birthDates"},DO_NOT_REPLACE=Symbol("DO NOT REPLACE"),labeledDateGlobalPattern=/\{\{([^\n\}\}]+)\}\}/g,labeledDatePattern=/(.*)/,labeledDates={globalPattern:labeledDateGlobalPattern,parsePattern:labeledDatePattern,parse:function(t){var e=t[0].indexOf("|");if(e>-1){var r=t[0].substring(e+1).slice(0,-2),n=new Date(r+" GMT");if(!isNaN(n.getTime()))return{date:n};if(n=new Date(r.split("|").join("-")+" GMT"),!isNaN(n.getTime()))return{date:n}}return DO_NOT_REPLACE},variable:"LABELED_DATE",name:"labeledDates"},deathDateGlobalPattern=/\{\{death\sdate\sand\sage([^\}\}]+)\}\}/gi,deathDatePattern=/(\d+)\|(\d+)\|(\d+)\|(\d+)\|?(\d+)?\|?(\d+)?/,millisInYear$1=31536e6,deathDates={globalPattern:deathDateGlobalPattern,parsePattern:deathDatePattern,parse:function(t){var e=slicedToArray(t,7),r=e[1],n=e[2],a=e[3],o=e[4],s=e[5],i=s===void 0?0:s,d=e[6],g=d===void 0?0:d,l=new Date(r,n-1,a),u=new Date(o,i-1,g);return{date:l,age:Math.floor((Number(l)-Number(u))/millisInYear$1)}},variable:"DEATH_DATE",name:"deathDates"},URLGlobalPattern=/\{\{URL\|([^\}\}]+)\}\}/g,URLPattern=/URL\|([^\}\}]+)\}\}/,url={globalPattern:URLGlobalPattern,parsePattern:URLPattern,parse:function(t){return slicedToArray(t,2)[1]},variable:"URL",name:"urls"},websiteGlobalPattern=/\[(https?):\/\/((?:www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6})\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)\s+([\w\s]+)\]/g,websitePattern=/\[(https?):\/\/((?:www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6})\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)\s+([\w\s]+)\]/,website={globalPattern:websiteGlobalPattern,parsePattern:websitePattern,parse:function(t){var e=slicedToArray(t,5),r=e[1],n=e[2],a=e[3];return{protocol:r,hostname:n,path:a,title:e[4],url:r+"://"+n+a}},variable:"WEBSITE",name:"websites"},globalPattern$1=/\{\{Extra[^}}]+\}\}/gi,parsePattern=/\|\s?(\w+)\s+=\s+(.+)/g,propPattern=/\|\s?(\w+)\s+=\s+(.+)/,extra={globalPattern:globalPattern$1,parsePattern,parse:function(t){return t.reduce(function(e,r){var n=r.match(propPattern),a=slicedToArray(n,3),o=a[1],s=a[2];return e[o]=s,e},{})},variable:"EXTRA",name:"extra"},convertGlobalPattern=/\{\{convert\|([\d\.]+)\|(\w+)/g,convertPattern=/\{\{convert\|([\d\.]+)\|(\w+)/,convert={globalPattern:convertGlobalPattern,parsePattern:convertPattern,parse:function(t){var e=slicedToArray(t,3);return e[1]+" "+e[2]},variable:"CONVERT",name:"converts"},filmDatesPattern=/\{\{film\sdate([^\}\}]+)\}\}/gi,filmDatePatternGlobal=/(\d+)\|?(\d+)\|?(\d+)\|?([^\|\}]*)\|?(ref\d+=([^\|\}]*))?/g,filmDatePattern=/(\d+)\|?(\d+)\|?(\d+)\|?([^\|\}]*)\|?(ref\d+=([^\|\}]*))?/,filmDates={globalPattern:filmDatesPattern,parsePattern:filmDatePatternGlobal,parse:function(t){return t.map(function(e){var r=e.match(filmDatePattern),n=slicedToArray(r,7),a=(n[0],n[1]),o=n[2],s=n[3],i=n[4],d=(n[5],n[6]);return{date:new Date(a,o&&o-1,s),location:i,ref:d}})},variable:"FILM_DATES",name:"filmDates"},otherGlobalPattern$1=/<ref(\s\w+=[^>]+)?>(.*)<\/ref>/g,otherPattern$1=/<ref(\s\w+=[^>]+)?>(.*)<\/ref>/,attributeGlobalPattern=/(\w+)=(["\w]+)/g,attributePattern=/(\w+)=(["\w]+)/,ref1={globalPattern:otherGlobalPattern$1,parsePattern:otherPattern$1,parse:function(t){var e=slicedToArray(t,3),r=(e[0],e[1]),n=e[2];return{attributes:((r||"").match(attributeGlobalPattern)||[]).reduce(function(a,o){if(o){var s=o.match(attributePattern),i=slicedToArray(s,3),d=(i[0],i[1]),g=i[2];a[d]=g.replace(/"/g,"")}return a},{}),contents:n}},variable:"REF",name:"refs"},otherGlobalPattern$2=/<ref(\s\w+=[^>]+)?\/>/g,otherPattern$2=/<ref(\s\w+=[^>]+)?\/>/,attributeGlobalPattern$1=/(\w+)=(["\w]+)/g,attributePattern$1=/(\w+)=(["\w]+)/,ref2={globalPattern:otherGlobalPattern$2,parsePattern:otherPattern$2,parse:function(t){return{attributes:t[1].match(attributeGlobalPattern$1).reduce(function(e,r){var n=r.match(attributePattern$1),a=slicedToArray(n,3),o=(a[0],a[1]),s=a[2];return e[o]=s.replace(/"/g,""),e},{})}},variable:"REF",name:"refs"},globalPattern$2=/\{\{formatnum:\d+\}\}/gi,parsePattern$1=/\{\{formatnum:(\d+)\}\}/,formatNum={globalPattern:globalPattern$2,parsePattern:parsePattern$1,parse:function(t){var e=slicedToArray(t,2),r=e[1];return parseFloat(r)},variable:"FORMAT_NUM",name:"formatNum"},dataTypes=[instances,ref1,ref2,small,formatNum,flag,coords,marriages,birthDates,labeledDates,deathDates,unbulletedLists,website,hlist,url,convert,nbay,filmDates,other,extra,plainLists,unmarkedLists],dataTypes$1=dataTypes.map(function(t){return{handler:dataType(t),name:t.name,pattern:new RegExp("\\$"+t.variable+"_(\\d+)")}}),keyValueGlobalPattern=/\|\s*([-'\u0400-\u04FF\w\s]+)\s*=\s*([^|]+)?/g,keyValuePattern=/\|\s*([-'\u0400-\u04FF\w\s]+)\s*=\s*([^|]+)?/,numberParse=function(t){return typeof t=="string"&&(t=t.trim().replace(/ /g,""),t.match(/,/)&&t.match(/\./)?t.indexOf(",")<t.indexOf(".")?parseEnglish(t):parseSpanish(t):t.match(/,/)&&!t.match(/\./)?t.match(/,/g).length>1||t.match(/,[0-9]{3}($|^[0-9])/)?parseEnglish(t):parseSpanish(t):!t.match(/,/)&&t.match(/\./)?t.match(/\./g).length>1||t.match(/\.[0-9]{3}($|^[0-9])/)?parseSpanish(t):parseEnglish(t):(+t).toString()===t&&+t)},parseEnglish=function(t){return+t.replace(/,/g,"")},parseSpanish=function(t){return+t.replace(/\./g,"").replace(/,/g,".")},smallDataType=dataTypes$1.find(function(t){return t.name==="smalls"}),blankNamePattern=/blank(\d+)?NameSec2/,blankInfoPattern=/blank(\d+)?InfoSec2/,infoBoxStartPattern=/{{\w*box/,tableStartPattern=/{\|(.*)\n?/,tableEndPattern=/\n\|}/,headersPattern=/!\s?(.*)/g,rowPattern=/\|-/,cellSeparatorPattern=/(?:\n\|)|(?:\|\|)/,linkPattern=/\[\[([^\]]+)\]\]/g,linkNamePattern=/^.*\|/,inlineHeaderPattern="!!",actionPattern=/{{anchor\|(.*)}}/g,rowSpanCountPattern=/rowspan="(\d+)"/,stripLinks=function(t){return t.replace(linkPattern,function(e,r){return r.replace(linkNamePattern,"").trim()||r})},removeActions=function(t){return t.replace(actionPattern,"")},transformCell=function(t){return stripLinks(removeActions(t||"")).replace(rowSpanCountPattern,"").replace(linkNamePattern,"").trim()},transformCells=function(t){return t.split(cellSeparatorPattern).map(transformCell)},findIndex=function(t,e){var r=t.match(e);return r?r.index:-1},findTableStart=function(t){var e=t.match(tableStartPattern);return e?e.index+e[0].length:-1},findTableEnd=function(t){return findIndex(t,tableEndPattern)},getHeaders=function(t){for(var e=[],r=void 0;r=headersPattern.exec(t);)e.push.apply(e,toConsumableArray(r[1].split(inlineHeaderPattern).map(transformCell)));return e},getRows=function(t){var e=t.split(rowPattern).map(function(y){return y.replace(/^.*\n+?\|/,"").trim()}).filter(function(y){return y}),r=[],n=0,a=0,o=[],s=!0,i=!1,d=void 0;try{for(var g,l=e[Symbol.iterator]();!(s=(g=l.next()).done);s=!0){var u=g.value,m=u.match(rowSpanCountPattern);m&&(n=0,a=parseInt(m[1]),o=[]),n<a?(o.push(u),++n===a&&r.push(transformRowSpan(o))):r.push(u)}}catch(y){i=!0,d=y}finally{try{!s&&l.return&&l.return()}finally{if(i)throw d}}return r},getNextTable=function(t,e,r){var n=t,a=findTableStart(n);if(a===-1)return null;n=n.substring(a);var o=findTableEnd(n);if(o===-1)return null;n=n.substring(0,o);var s=getRows(n);if(!s.length)return null;var i=getHeaders(s[0]);return i.length?{data:s.slice(1).map(transformCells).map(function(d){return i.reduce(function(g,l,u){return g[camelCase(fillVariable(l,e,r))]=fillVariables(d[u],e,r),g},{})}),end:a+o}:null},parseTables=function(t,e){for(var r=cleanSource(t,e),n=extractData(r),a=[],o=n.source,s=null;s=getNextTable(o,n.context,e);){if(!s)return a;a.push(s.data),o=o.substring(s.end)}return a},linkPattern$1=/\[\[([^\]]+)\]\]/g,kmPattern=/{{BSkm\|([\dx]+,[\dx]+)\|([\dx]+,[\dx]+)}}/g,parseBsTables=function(t){var e=t.replace(kmPattern,"$1/$2").match(/{{BS([^}}]+)}}/g);return e?e.map(function(r){return clean(r).split("|")}).map(parseRow).filter(function(r){return r.type[0]!=="-"}):null},headingPattern=/[^=]==\s?([\w\s]+)\s?==/g,subheadingPattern=/===([\w\s]+)===/g,tableStartPattern$1=/{{list.+start.*}}/gi,tableEndPattern$1=/{{list.+end.*}}/gi,rowPattern$1=/{{(.*)}}/g,rowPatternSingle=/{{(.*)}}/,parseLists=function(t){var e=getMatches(t,headingPattern),r=getMatches(t,subheadingPattern),n=getTables(t);return n.forEach(function(a){var o=e.filter(function(i){return i.end<a.start}).map(function(i){return i.value});a.heading=last(o);var s=r.filter(function(i){return i.end<a.start}).map(function(i){return i.value});a.subheading=last(s),delete a.start,delete a.end}),n},bundle_min=parseInfobox;(function(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.citation=exports.pdf=exports.mobileHtml=exports.media=exports.related=exports.summary=exports.rawInfo=exports.tables=exports.infobox=exports.langLinks=exports.coordinates=exports.references=exports.links=exports.categories=exports.content=exports.html=exports.intro=exports.images=exports.Page=void 0;const errors_1=errors,request_1=request,utils_1=utils,messages_1=messages,infoboxParser=bundle_min;class Page{constructor(t){this.intro=async e=>{try{if(!this._intro){const r=await(0,exports.intro)(this.pageid.toString(),e==null?void 0:e.redirect);this._intro=r}return this._intro}catch(r){throw new errors_1.introError(r)}},this.images=async e=>{try{if(!this._images){const r=await(0,exports.images)(this.pageid.toString(),e);this._images=r}return this._images}catch(r){throw new errors_1.imageError(r)}},this.summary=async e=>{try{if(!this._summary){const r=await(0,exports.summary)(this.title,e==null?void 0:e.redirect);this._summary=r}return this._summary}catch(r){throw new errors_1.summaryError(r)}},this.html=async e=>{try{if(!this._html){const r=await(0,exports.html)(this.pageid.toString(),e==null?void 0:e.redirect);this._html=r}return this._html}catch(r){throw new errors_1.htmlError(r)}},this.content=async e=>{try{if(!this._content){const r=await(0,exports.content)(this.pageid.toString(),e==null?void 0:e.redirect);this.parentid=r.ids.parentId,this.revid=r.ids.revId,this._content=r.result}return this._content}catch(r){throw new errors_1.contentError(r)}},this.categories=async e=>{try{if(!this._categories){const r=await(0,exports.categories)(this.pageid.toString(),e);this._categories=r}return this._categories}catch(r){throw new errors_1.categoriesError(r)}},this.links=async e=>{try{if(!this._links){const r=await(0,exports.links)(this.pageid.toString(),e);this._links=r}return this._links}catch(r){throw new errors_1.linksError(r)}},this.references=async e=>{try{if(!this._references){const r=await(0,exports.references)(this.pageid.toString(),e);this._references=r}return this._references}catch(r){throw new errors_1.linksError(r)}},this.coordinates=async e=>{try{if(!this._coordinates){const r=await(0,exports.coordinates)(this.pageid.toString(),e==null?void 0:e.redirect);this._coordinates=r}return this._coordinates}catch(r){throw new errors_1.coordinatesError(r)}},this.langLinks=async e=>{try{if(!this._langLinks){const r=await(0,exports.langLinks)(this.pageid.toString(),e);this._langLinks=r}return this._langLinks}catch(r){throw new errors_1.linksError(r)}},this.infobox=async e=>{try{if(!this._infobox){const r=await(0,exports.infobox)(this.pageid.toString(),e==null?void 0:e.redirect);this._infobox=r}return this._infobox}catch(r){throw new errors_1.infoboxError(r)}},this.tables=async e=>{try{if(!this._tables){const r=await(0,exports.tables)(this.pageid.toString(),e==null?void 0:e.redirect);this._tables=r}return this._tables}catch(r){throw new errors_1.infoboxError(r)}},this.related=async e=>{try{if(!this._related){const r=await(0,exports.related)(this.title,e==null?void 0:e.redirect);this._related=r}return this._related}catch(r){throw new errors_1.relatedError(r)}},this.media=async e=>{try{if(!this._media){const r=await(0,exports.media)(this.title,e==null?void 0:e.redirect);this._media=r}return this._media}catch(r){throw new errors_1.mediaError(r)}},this.mobileHtml=async e=>{try{if(!this._mobileHtml){const r=await(0,exports.mobileHtml)(this.title,e==null?void 0:e.redirect);this._mobileHtml=r}return this._mobileHtml}catch(r){throw new errors_1.htmlError(r)}},this.pdf=async e=>{try{return await(0,exports.pdf)(this.title,e)}catch(r){throw new errors_1.pdfError(r)}},this.pageid=t.pageid,this.ns=t.ns,this.title=t.title,this.contentmodel=t.contentmodel,this.pagelanguage=t.pagelanguage,this.pagelanguagedir=t.pagelanguagedir,this.touched=t.touched,this.lastrevid=t.lastrevid,this.length=t.length,this.fullurl=t.fullurl,this.editurl=t.editurl,this.canonicalurl=t.canonicalurl}async runMethod(functionName){try{const result=await eval(`this.${functionName}()`);return result}catch(t){throw new errors_1.preloadError(t)}}}exports.Page=Page;const images=async(t,e)=>{try{let r={generator:"images",gimlimit:(e==null?void 0:e.limit)||5,prop:"imageinfo",iiprop:"url"};r=(0,utils_1.setPageIdOrTitleParam)(r,t);const n=await(0,request_1.default)(r,e==null?void 0:e.redirect),a=[],o=Object.keys(n.query.pages);for(const s of o){const i=n.query.pages[s];i.url=i.imageinfo[0].url,a.push(i)}return a}catch(r){throw new errors_1.imageError(r)}};exports.images=images;const intro=async(t,e=!0)=>{var r;try{let n={prop:"extracts",explaintext:"",exintro:""};n=(0,utils_1.setPageIdOrTitleParam)(n,t);const a=await(0,request_1.default)(n,e),o=(0,utils_1.setPageId)(n,a);return(r=a==null?void 0:a.query)===null||r===void 0?void 0:r.pages[o].extract}catch(n){throw new errors_1.introError(n)}};exports.intro=intro;const html=async(t,e=!0)=>{try{let r={prop:"revisions",rvprop:"content",rvlimit:1,rvparse:""};r=(0,utils_1.setPageIdOrTitleParam)(r,t);const n=await(0,request_1.default)(r,e),a=(0,utils_1.setPageId)(r,n);return n.query.pages[a].revisions[0]["*"]}catch(r){throw new errors_1.htmlError(r)}};exports.html=html;const content=async(t,e=!0)=>{try{let r={prop:"extracts|revisions",explaintext:"",rvprop:"ids"};r=(0,utils_1.setPageIdOrTitleParam)(r,t);const n=await(0,request_1.default)(r,e),a=(0,utils_1.setPageId)(r,n),o=n.query.pages[a].extract,s={revisionId:n.query.pages[a].revisions[0].revid,parentId:n.query.pages[a].revisions[0].parentid};return{result:o,ids:s}}catch(r){throw new errors_1.contentError(r)}};exports.content=content;const categories=async(t,e)=>{try{let r={prop:"categories",pllimit:e==null?void 0:e.limit};r=(0,utils_1.setPageIdOrTitleParam)(r,t);const n=await(0,request_1.default)(r,e==null?void 0:e.redirect),a=(0,utils_1.setPageId)(r,n);return n.query.pages[a].categories.map(o=>o.title)}catch(r){throw new errors_1.categoriesError(r)}};exports.categories=categories;const links=async(t,e)=>{try{let r={prop:"links",plnamespace:0,pllimit:(e==null?void 0:e.limit)||"max"};r=(0,utils_1.setPageIdOrTitleParam)(r,t);const n=await(0,request_1.default)(r,e==null?void 0:e.redirect),a=(0,utils_1.setPageId)(r,n);return n.query.pages[a].links.map(s=>s.title)}catch(r){throw new errors_1.linksError(r)}};exports.links=links;const references=async(t,e)=>{try{let r={prop:"extlinks",ellimit:(e==null?void 0:e.limit)||"max"};r=(0,utils_1.setPageIdOrTitleParam)(r,t);const n=await(0,request_1.default)(r,e==null?void 0:e.redirect),a=(0,utils_1.setPageId)(r,n);return n.query.pages[a].extlinks.map(s=>s["*"])}catch(r){throw new errors_1.linksError(r)}};exports.references=references;const coordinates=async(t,e=!0)=>{try{let r={prop:"coordinates"};r=(0,utils_1.setPageIdOrTitleParam)(r,t);const n=await(0,request_1.default)(r,e),a=(0,utils_1.setPageId)(r,n),o=n.query.pages[a].coordinates;return o?o[0]:null}catch(r){throw new errors_1.coordinatesError(r)}};exports.coordinates=coordinates;const langLinks=async(t,e)=>{try{let r={prop:"langlinks",lllimit:(e==null?void 0:e.limit)||"max",llprop:"url"};r=(0,utils_1.setPageIdOrTitleParam)(r,t);const n=await(0,request_1.default)(r,e==null?void 0:e.redirect),a=(0,utils_1.setPageId)(r,n);return n.query.pages[a].langlinks.map(s=>({lang:s.lang,title:s["*"],url:s.url}))}catch(r){throw new errors_1.linksError(r)}};exports.langLinks=langLinks;const infobox=async(t,e=!0)=>{try{const r={prop:"revisions",rvprop:"content",rvsection:0},n=await(0,exports.rawInfo)(t,r,e);return infoboxParser(n).general}catch(r){throw new errors_1.infoboxError(r)}};exports.infobox=infobox;const tables=async(t,e=!0)=>{try{const r={prop:"revisions",rvprop:"content"},n=await(0,exports.rawInfo)(t,r,e);return infoboxParser(n).tables}catch(r){throw new errors_1.infoboxError(r)}};exports.tables=tables;const rawInfo=async(t,e,r=!0)=>{var n;try{e=(0,utils_1.setPageIdOrTitleParam)(e,t);const a=await(0,request_1.default)(e,r);if(!(!((n=a.query)===null||n===void 0)&&n.pages))throw new errors_1.wikiError(messages_1.MSGS.INFOBOX_NOT_EXIST);const o=(0,utils_1.setPageId)(e,a),s=a.query.pages[o].revisions[0];return s?s["*"]:""}catch(a){throw new errors_1.infoboxError(a)}};exports.rawInfo=rawInfo;const summary=async(t,e=!0)=>{try{const r="page/summary/"+t.replace(" ","_");return await(0,request_1.makeRestRequest)(r,e)}catch(r){throw new errors_1.summaryError(r)}};exports.summary=summary;const related=async(t,e=!0)=>{try{const r="page/related/"+t.replace(" ","_");return await(0,request_1.makeRestRequest)(r,e)}catch(r){throw new errors_1.relatedError(r)}};exports.related=related;const media=async(t,e=!0)=>{try{const r="page/media-list/"+t.replace(" ","_");return await(0,request_1.makeRestRequest)(r,e)}catch(r){throw new errors_1.mediaError(r)}};exports.media=media;const mobileHtml=async(t,e=!0)=>{try{const r=`page/mobile-html/${t}`;return await(0,request_1.makeRestRequest)(r,e)}catch(r){throw new errors_1.htmlError(r)}};exports.mobileHtml=mobileHtml;const pdf=async(t,e)=>{try{let r=`page/pdf/${t}`;return e!=null&&e.format&&(r+=`/${e.format}`),e!=null&&e.type&&(r+=`/${e.type}`),(0,request_1.returnRestUrl)(r)}catch(r){throw new errors_1.pdfError(r)}};exports.pdf=pdf;const citation=async(t,e,r)=>{try{let n="data/citation";return n+=e?`/${e}`:"/mediawiki",n+=`/${t}`,r&&(n+=`/${r}`),await(0,request_1.makeRestRequest)(n)}catch(n){throw new errors_1.citationError(n)}};exports.citation=citation,exports.default=Page})(page);var resultTypes={};Object.defineProperty(resultTypes,"__esModule",{value:!0});var optionTypes={};Object.defineProperty(optionTypes,"__esModule",{value:!0});(function(t,e){var r=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(l,u,m,y){y===void 0&&(y=m);var C=Object.getOwnPropertyDescriptor(u,m);(!C||("get"in C?!u.__esModule:C.writable||C.configurable))&&(C={enumerable:!0,get:function(){return u[m]}}),Object.defineProperty(l,y,C)}:function(l,u,m,y){y===void 0&&(y=m),l[y]=u[m]}),n=commonjsGlobal&&commonjsGlobal.__exportStar||function(l,u){for(var m in l)m!=="default"&&!Object.prototype.hasOwnProperty.call(u,m)&&r(u,l,m)};Object.defineProperty(e,"__esModule",{value:!0});const a=request,o=page,s=errors,i=messages,d=utils,g=async(l,u)=>g.page(l,u);g.search=async(l,u)=>{try{const m={list:"search",srprop:"",srlimit:(u==null?void 0:u.limit)||10,srsearch:l};u!=null&&u.suggestion&&(m.srinfo="suggestion");const y=await(0,a.default)(m);return{results:y.query.search,suggestion:y.query.searchinfo?y.query.searchinfo.suggestion:null}}catch(m){throw new s.searchError(m)}},g.page=async(l,u)=>{try{u!=null&&u.autoSuggest&&(l=await(0,d.setTitleForPage)(l));let m={prop:"info|pageprops",inprop:"url",ppprop:"disambiguation"};m=(0,d.setPageIdOrTitleParam)(m,l);const y=await(0,a.default)(m);let C=y.query.pages;const T=(0,d.setPageId)(m,y);if(C=C[T],C.missing=="")throw new s.pageError(`${i.MSGS.PAGE_NOT_EXIST}${l}`);const N=new o.default(C);if(u!=null&&u.preload){u!=null&&u.fields||(u.fields=["summary","images"]);for(const M of u.fields)await N.runMethod(M)}return N}catch(m){throw new s.pageError(m)}},g.intro=async(l,u)=>{try{return u!=null&&u.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,o.intro)(l,u==null?void 0:u.redirect)}catch(m){throw new s.introError(m)}},g.images=async(l,u)=>{try{return u!=null&&u.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,o.images)(l,u)}catch(m){throw new s.imageError(m)}},g.summary=async(l,u)=>{try{return u!=null&&u.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,o.summary)(l,u==null?void 0:u.redirect)}catch(m){throw new s.summaryError(m)}},g.html=async(l,u)=>{try{return u!=null&&u.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,o.html)(l,u==null?void 0:u.redirect)}catch(m){throw new s.htmlError(m)}},g.content=async(l,u)=>{try{return u!=null&&u.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),(await(0,o.content)(l,u==null?void 0:u.redirect)).result}catch(m){throw new s.contentError(m)}},g.categories=async(l,u)=>{try{return u!=null&&u.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,o.categories)(l,u)}catch(m){throw new s.categoriesError(m)}},g.related=async(l,u)=>{try{return u!=null&&u.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,o.related)(l,u==null?void 0:u.redirect)}catch(m){throw new s.relatedError(m)}},g.media=async(l,u)=>{try{return u!=null&&u.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,o.media)(l,u==null?void 0:u.redirect)}catch(m){throw new s.mediaError(m)}},g.links=async(l,u)=>{try{return u!=null&&u.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,o.links)(l,u)}catch(m){throw new s.linksError(m)}},g.references=async(l,u)=>{try{return u!=null&&u.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,o.references)(l,u)}catch(m){throw new s.linksError(m)}},g.coordinates=async(l,u)=>{try{return u!=null&&u.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,o.coordinates)(l,u==null?void 0:u.redirect)}catch(m){throw new s.coordinatesError(m)}},g.langLinks=async(l,u)=>{try{return u!=null&&u.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,o.langLinks)(l,u)}catch(m){throw new s.linksError(m)}},g.infobox=async(l,u)=>{try{return u!=null&&u.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,o.infobox)(l,u==null?void 0:u.redirect)}catch(m){throw new s.infoboxError(m)}},g.tables=async(l,u)=>{try{return u!=null&&u.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,o.tables)(l,u==null?void 0:u.redirect)}catch(m){throw new s.infoboxError(m)}},g.languages=async()=>{try{const l={meta:"siteinfo",siprop:"languages"},u=await(0,a.default)(l),m=[];for(const y of u.query.languages)m.push({[y.code]:y["*"]});return m}catch(l){throw new s.wikiError(l)}},g.setLang=l=>(0,a.setAPIUrl)(l),g.geoSearch=async(l,u,m)=>{try{const y={list:"geosearch",gsradius:(m==null?void 0:m.radius)||1e3,gscoord:`${l}|${u}`,gslimit:(m==null?void 0:m.limit)||10,gsprop:"type"};return(await(0,a.default)(y)).query.geosearch}catch(y){throw new s.geoSearchError(y)}},g.suggest=async l=>{var u,m,y,C;try{const T={list:"search",srinfo:"suggestion",srprop:"",srsearch:l},N=await(0,a.default)(T);return!((m=(u=N.query)===null||u===void 0?void 0:u.searchinfo)===null||m===void 0)&&m.suggestion?(C=(y=N.query)===null||y===void 0?void 0:y.searchinfo)===null||C===void 0?void 0:C.suggestion:null}catch(T){throw new s.searchError(T)}},g.onThisDay=async(l={})=>{try{const u=l.type||"all",m=(l.month||(0,d.getCurrentMonth)()).toString().padStart(2,"0"),y=(l.day||(0,d.getCurrentDay)()).toString().padStart(2,"0"),C=`feed/onthisday/${u}/${m}/${y}`;return await(0,a.makeRestRequest)(C,!0)}catch(u){throw new s.eventsError(u)}},g.featuredContent=async(l={})=>{try{const u=(l.year||(0,d.getCurrentYear)()).toString(),m=(l.month||(0,d.getCurrentMonth)()).toString().padStart(2,"0"),y=(l.day||(0,d.getCurrentDay)()).toString().padStart(2,"0"),C=`feed/featured/${u}/${m}/${y}`;return await(0,a.makeRestRequest)(C,!0)}catch(u){throw new s.fcError(u)}},g.random=async l=>{try{l||(l="summary");const u=`page/random/${l}`;return await(0,a.makeRestRequest)(u)}catch(u){throw new s.wikiError(u)}},g.mobileHtml=async(l,u)=>{try{return u!=null&&u.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,o.mobileHtml)(l,u==null?void 0:u.redirect)}catch(m){throw new s.htmlError(m)}},g.pdf=async(l,u)=>{try{return u!=null&&u.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,o.pdf)(l,u)}catch(m){throw new s.pdfError(m)}},g.citation=async(l,u,m)=>{try{return await(0,o.citation)(l,u,m)}catch(y){throw new s.citationError(y)}},g.autocompletions=async(l,u)=>{try{const m={list:"search",limit:(u==null?void 0:u.limit)||10,search:l,action:"opensearch",redirect:"return"},[,y]=await(0,a.default)(m,!1);return y}catch(m){throw new s.autocompletionsError(m)}},e.default=g,t.exports=g,t.exports.default=g,n(errors,e),n(resultTypes,e),n(optionTypes,e),n(page,e)})(dist,dist.exports);var WPComponent_vue_vue_type_style_index_0_lang="";Plugin.setDefaults({color:"primary",size:"15px",position:"bottom"});const _sfc_main$3=defineComponent({name:"WPComponent",props:[],setup(){const t=Date.now(),e=date.formatDate(t,"MM/DD");return{store:useStore(),guideWords:ref(""),promptGW:ref(!1),promptSearch:ref(!1),promptLanguage:ref(!1),flagName:ref("fi fi-gb"),searchSize:ref(50),searchResults:ref([]),imageResultsSize:ref(50),promptSearchSize:ref(!1),promptImageResultsSize:ref(!1),otditems:ref([]),promptOTDDate:ref(!1),otddate:ref(Date.now()),otdlabel:ref(e),otdtype:ref("selected"),history:ref([]),historySize:ref(20),promptHistorySize:ref(!1),numPages:ref(5),promptNumPages:ref(!1)}},mounted(){this.flagName=this.store.langVoices[this.store.userSnapshot.preferences.langVoiceKey].flagName;const t=this.store.userSnapshot.preferences.langVoiceKey,e=this.store.langVoices[t].flagName;selectAll("#sfi").classed(e,!0),this.init()},methods:{async init(){const t=this.store.userSnapshot.preferences.langVoiceKey;await dist.exports.setLang(this.store.langVoices[t].langName);const e=await dist.exports.onThisDay({type:this.otdtype});this.otditems=e[this.otdtype]},generateCourse(){const e=this.store.newCourse().ck;console.log("created course ",e);for(let r=0;r<5;r++){const n=this.generateAssignment();console.log("aid = ",n)}},generateAssignment(){if(!this.store.ck){this.store.notify("Must select course to generate assignments");return}if(!this.store.aid){const e=this.store.newAssignment();this.store.aid=e,console.log("created assignment ",e)}this.store.currentAssignment.title=this.guideWords.split(",")[0];const t=this.generatePages(this.numPages);console.log("generatePages returned ",t);try{this.store.currentAssignment.coverUrl=this.store.currentAssignment.pages[0].imgs[0].url}catch(e){console.log(e)}return this.store.router.push("/courses/assignments"),this.store.aid},async generatePages(t){t||(t=1),Plugin.start(0),this.clearSearchResults();const e=this.store.langVoices[this.store.userSnapshot.preferences.langVoiceKey];console.log("generatePages ",e,this.searchTerms),dist.exports.setLang(e.langName);const r=await dist.exports.search(this.guideWords,{suggestion:!1,limit:t});console.log("generatePages res.results.length: ",r.results.length),this.searchResults=r.results;for(let n=0;n<r.results.length;n++)await this.loadSearch(n),Plugin.increment(parseInt(1/r.results.length*100));Plugin.stop(),this.store.pgIdx=0},async getPage(t,e,r){selectAll(".assignment").classed("hidden",!1),selectAll(".coverslide").classed("hidden",!0);const n=this.store.langVoices;console.log("getPage ",r,n[r]);const a=this.store.currentPage;try{for(;a.imgs.length>0;)a.imgs.pop()}catch(l){console.log(l)}const o=await dist.exports.setLang(n[r].langName);console.log("res (promise)",o);let s,i,d;if(t.length>0){const l=t.split(",");for(const C in parseInt(Math.random()*Math.random()))console.log("dummy ",C);const u=parseInt(Math.random()*l.length);console.log("searchTerm: ",l[u]);const m=await dist.exports.search(l[u],{suggestion:!1,limit:this.searchSize}),y=parseInt(Math.random()*m.results.length);d=m.results[y].pageid,i=await dist.exports.page(d),s=await i.summary()}else e!==null?(i=await dist.exports.page(e),d=e,s=await i.summary()):(s=await dist.exports.random(),d=s.pageid,i=await dist.exports.page(d));await i.media().then(l=>{for(const u in l.items)u.type==="image"&&u.showInGallery===!0&&a.imgs.push({url:u.srcset[0].src,cap:u.caption.text})});try{a.currentLangLinks=await i.langLinks()}catch{console.log("Failed to get langLinks")}await i.coordinates().then(l=>{console.log("resolved coords ",l),l!==null?a&&(a.mapCoords=`${l.lat}, ${l.lon}`):a&&(a.mapCoords="-999, -999")});try{this.page.imgs.unshift({url:s.originalimage.source,cap:s.title})}catch{}try{await i.images({limit:this.imageResultsSize}).then(l=>{for(const u in l)!u||(l[0].title.indexOf(".svg")>1?console.log("SVG ",l[0].title):l[0].title.indexOf("airytale")>0?console.log("Fairytale warning ",l[0].title):l[0].title.indexOf("kguitar")>1?console.log("kguitar ",l[0].title):l[0].title.indexOf("Blank.png")>-1?console.log("Blank.png ",l[0].title):l[0].title.indexOf(".oga")>1?console.log("OGA ",l[0].title):l[0].title.indexOf(".webm")>1?console.log("WEBM ",l[0].title):l[0].title.indexOf(".ogg")>1?console.log("OGG ",l[0].title):l[0].title.indexOf(".tif")>1?console.log("TIF ",l[0].title):l[0].title.indexOf(".mid")>1?console.log("MID ",l[0].title):l[0].title.indexOf(".ogv")>1?console.log("OGV ",l[0].title):l[0].title.indexOf("Icon")>1?console.log("ICON ",l[0].title):l[0].title.indexOf("icon")>1?console.log("icon ",l[0].title):l[0].title.indexOf("podagraria1")>0?console.log("podagraria1 ",l[0].title):l[0].title.indexOf("Bluetank")>1||l[0].title.indexOf("rab Nebula.jpg")>0?console.log("BLUETANK ",l[0].title):l[0].title.indexOf("viacionavion")>1||l[0].title.indexOf("input-microphone")>1?console.log("viacionavion",l[0].title):l[0].title.indexOf("clouds in fair weather")>0?console.log("clouds in fair weather",l[0].title):(console.log("Attempting to add "),a.imgs.push({url:l[0].url,cap:l[0].title}),console.log("Added ",l[0].title)),l.push(l.shift()))})}catch(l){console.log("error retrieving fp.images ",i,l)}a&&a.imgs.length===0&&a.imgs.push({url:"https://readingedgeca.s3.us-west-1.amazonaws.com/static/pub/img/readingedge_cover.png",cap:"No images available"}),a.langVoiceKey=r,a.isCustom=!1,a.pageid=d,a.pageTitle=s.title,a.guideWords=t,a.pctReplace=15,a.pageText=s.extract,a.canonicalUrl=i.canonicalurl;const g={pageid:d,title:s.title,langVoiceKey:r};for(this.history.unshift(g);this.history.length>this.historySize;)this.history.pop();for(const[l,u]of Object.entries(this.store.langVoices)){const m=u.flagName;l||console.log("blooh blah"),selectAll(".pfi").classed(m,!1)}return selectAll(".pfi").classed(this.store.langVoices[r].flagName,!0),1},langChangeCB(t){console.log(t);const e=this.flagName;selectAll("#sfi").classed(e,!1),console.log(this.store.langVoices),this.flagName=this.store.langVoices[t].flagName,console.log("langChangeCB",t,this.flagName),selectAll("#sfi").classed(this.flagName,!0),this.init()},async loadOTDPageId(t,e){const r=await this.createAsNeededForPageLoad();console.log("check returned ",r),console.log("WPComponent.loadSearchPageId: ",t,e),await this.getPage("",t,e).then(n=>(console.log("getPage returned rval ",n),this.store.imgIdx=0,this.store.router.replace("/courses/assignments/pages"),t))},async loadSearchPageId(t,e){console.log("store loadSearchPageId: ",t,e),await this.getPage("",t,e).then(r=>(console.log("getPage returned rval ",r,"pgIdx",this.store.pgIdx),this.store.imgIdx=0,t))},async loadOTD(t){console.log("load",this.otditems[t].text),console.log("load",this.otditems[t]);const e=this.store.userSnapshot.preferences.langVoiceKey;console.log("OTD load ",e);const r=await this.createAsNeededForPageLoad();console.log("check returned ",r);const n=await this.loadOTDPageId(this.otditems[t].pages[0].pageid,e);console.log("loadOTDPageId returned ",n),this.store.imgIdx=0,this.store.router.replace("/courses/assignments/pages")},async loadSearch(t){console.log(t),console.log(this.searchResults[t]);const e=this.store.userSnapshot.preferences.langVoiceKey;console.log("calling loadSearchPageId ",this.searchResults[t].pageid,e);const r=await this.createAsNeededForPageLoad();console.log("check returned ",r);const n=await this.loadSearchPageId(this.searchResults[t].pageid,e);console.log("loadSearch pageid ",n),this.store.imgIdx=0;try{this.store.carousel.goTo(this.store.currentAssignment.pages.length-1)}catch(a){console.log(a)}return this.store.router.replace("/courses/assignments/pages"),n},async createAsNeededForPageLoad(){let t=0;if(this.store.imgIdx=0,console.log("createAsNeededForpgLoad",t),this.store.ck===null||this.store.ck==="undefined"){console.log("creating new course");const e=await this.store.newCourse();this.store.ck=e,t+=4}if(this.store.aid===null||this.store.aid===-1){console.log("creating new assignment");const e=this.store.newAssignment();this.store.aid=e,t+=2}return console.log("appending new page to current assignment"),this.store.newPage(),this.store.pgIdx=this.store.currentAssignment.pages.length-1,t+=1,t},async doSearch(){this.clearSearchResults();const t=this.store.langVoices[this.store.userSnapshot.preferences.langVoiceKey];console.log("doSearch ",t,this.searchTerms),dist.exports.setLang(t.langName);const e=await dist.exports.search(this.guideWords,{suggestion:!1,limit:this.searchSize});console.log("res.results.length: ",e.results.length),this.searchResults=e.results},clearSearchResults(){for(;this.searchResults.length;)this.searchResults.pop()},async updateOTDDate(){const t=await dist.exports.onThisDay({type:"selected",month:this.otddate.split("/")[1],day:this.otddate.split("/")[2]});this.otditems=t.selected,this.otdtype="selected",this.otdlabel=date.formatDate(this.otddate,"MM/DD")},async otdOptionsCB(t){const e=await dist.exports.onThisDay({type:this.otdtype});this.otditems=e[this.otdtype]},loadImage(t){try{this.store.currentPage.imgs[this.store.imgIdx]=t}catch(e){console.log(e),this.store.notify("Please create or open a page to load the image into")}},updateHistoryBuffer(){for(;this.history.length>this.historySize;)this.history.pop()}}}),_hoisted_1$3=createBaseVNode("div",{class:"text-h6"},"Select Date",-1),_hoisted_2$3=createBaseVNode("div",{class:"text-h6"},"Limit Search Results Size",-1),_hoisted_3$3=createBaseVNode("div",{class:"text-h6"},"Number of pages generated",-1),_hoisted_4$3=createBaseVNode("div",{class:"text-h6"},"Limit Image Results Size",-1),_hoisted_5$3=createBaseVNode("div",null,"The initial search does not return images. This limit applies when loading a search result.",-1),_hoisted_6$3=createBaseVNode("div",{class:"text-h6"},"History Size",-1),_hoisted_7$3=createBaseVNode("div",{class:"text-h6"},"Set Language For WP",-1),_hoisted_8$3=createBaseVNode("span",{class:"on-right",id:"sfi"},null,-1),_hoisted_9$3={width:"100%",class:"z-max"},_hoisted_10$3=createBaseVNode("div",{class:"text-h6"},"Guide Words",-1),_hoisted_11$2=createBaseVNode("div",{class:"text-h6"},"Search Terms",-1),_hoisted_12$2=createBaseVNode("br",null,null,-1),_hoisted_13$2=createBaseVNode("br",null,null,-1),_hoisted_14$1={key:0},_hoisted_15$1={class:"row cardheader ptr justify-between"},_hoisted_16$1=["onClick"],_hoisted_17$1=createBaseVNode("br",null,null,-1),_hoisted_18$1={class:"q-pa-md",style:{"max-width":"350px"}},_hoisted_19$1={key:0},_hoisted_20$1={class:"row cardheader ptr justify-between"},_hoisted_21$1=["onClick"],_hoisted_22$1={class:"hidden"},_hoisted_23$1={class:"q-pa-md",style:{"max-width":"350px"}},_hoisted_24$1={class:"row cardheader ptr justify-between"},_hoisted_25=["onClick"],_hoisted_26={class:"hidden"},_hoisted_27={class:"q-pa-md",style:{"max-width":"350px"}},_hoisted_28={class:"row cardheader ptr justify-between"},_hoisted_29=["onClick"],_hoisted_30={class:"hidden"};function _sfc_render$3(t,e,r,n,a,o){return openBlock(),createElementBlock(Fragment,null,[createVNode(QDialog,{modelValue:t.promptOTDDate,"onUpdate:modelValue":e[2]||(e[2]=s=>t.promptOTDDate=s),persistent:""},{default:withCtx(()=>[createVNode(QCard,{style:{"min-width":"350px"}},{default:withCtx(()=>[createVNode(QCardSection,{align:"center"},{default:withCtx(()=>[_hoisted_1$3]),_:1}),createVNode(QDate,{modelValue:t.otddate,"onUpdate:modelValue":e[0]||(e[0]=s=>t.otddate=s),minimal:""},null,8,["modelValue"]),createVNode(QCardActions,{align:"center",class:"text-white"},{default:withCtx(()=>[withDirectives(createVNode(QBtn,{flat:"",label:"Cancel"},null,512),[[ClosePopup]]),withDirectives(createVNode(QBtn,{flat:"",label:"Update OTD date",onClick:e[1]||(e[1]=s=>this.updateOTDDate())},null,512),[[ClosePopup]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),createVNode(QDialog,{modelValue:t.promptSearchSize,"onUpdate:modelValue":e[4]||(e[4]=s=>t.promptSearchSize=s),persistent:""},{default:withCtx(()=>[createVNode(QCard,{style:{"min-width":"350px"}},{default:withCtx(()=>[createVNode(QCardSection,{align:"center"},{default:withCtx(()=>[_hoisted_2$3]),_:1}),createVNode(QCardSection,{class:"q-pt-none",align:"center"},{default:withCtx(()=>[createVNode(QKnob,{"show-value":"",size:"140px",thickness:.5,color:"positive","track-color":"green-3","center-color":"grey-8",class:"text-white col q-ma-md",modelValue:t.searchSize,"onUpdate:modelValue":e[3]||(e[3]=s=>t.searchSize=s)},null,8,["modelValue"])]),_:1}),createVNode(QCardActions,{align:"center",class:"text-white"},{default:withCtx(()=>[withDirectives(createVNode(QBtn,{flat:"",label:"Done"},null,512),[[ClosePopup]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),createVNode(QDialog,{modelValue:t.promptNumPages,"onUpdate:modelValue":e[6]||(e[6]=s=>t.promptNumPages=s),persistent:""},{default:withCtx(()=>[createVNode(QCard,{style:{"min-width":"350px"}},{default:withCtx(()=>[createVNode(QCardSection,{align:"center"},{default:withCtx(()=>[_hoisted_3$3]),_:1}),createVNode(QCardSection,{class:"q-pt-none",align:"center"},{default:withCtx(()=>[createVNode(QKnob,{"show-value":"",size:"140px",thickness:.5,color:"positive","track-color":"green-3","center-color":"grey-8",class:"text-white col q-ma-md",modelValue:t.numPages,"onUpdate:modelValue":e[5]||(e[5]=s=>t.numPages=s)},null,8,["modelValue"])]),_:1}),createVNode(QCardActions,{align:"center",class:"text-white"},{default:withCtx(()=>[withDirectives(createVNode(QBtn,{flat:"",label:"Done"},null,512),[[ClosePopup]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),createVNode(QDialog,{modelValue:t.promptImageResultsSize,"onUpdate:modelValue":e[8]||(e[8]=s=>t.promptImageResultsSize=s),persistent:""},{default:withCtx(()=>[createVNode(QCard,{style:{"min-width":"350px"}},{default:withCtx(()=>[createVNode(QCardSection,{align:"center"},{default:withCtx(()=>[_hoisted_4$3,_hoisted_5$3]),_:1}),createVNode(QCardSection,{class:"q-pt-none",align:"center"},{default:withCtx(()=>[createVNode(QKnob,{"show-value":"",size:"140px",thickness:.5,color:"positive","track-color":"green-3","center-color":"grey-8",class:"text-white col q-ma-md",modelValue:t.imageResultsSize,"onUpdate:modelValue":e[7]||(e[7]=s=>t.imageResultsSize=s)},null,8,["modelValue"])]),_:1}),createVNode(QCardActions,{align:"center",class:"text-white"},{default:withCtx(()=>[withDirectives(createVNode(QBtn,{flat:"",label:"Done"},null,512),[[ClosePopup]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),createVNode(QDialog,{modelValue:t.promptHistorySize,"onUpdate:modelValue":e[11]||(e[11]=s=>t.promptHistorySize=s),persistent:""},{default:withCtx(()=>[createVNode(QCard,{style:{"min-width":"350px"}},{default:withCtx(()=>[createVNode(QCardSection,{align:"center"},{default:withCtx(()=>[_hoisted_6$3]),_:1}),createVNode(QCardSection,{class:"q-pt-none",align:"center"},{default:withCtx(()=>[createVNode(QKnob,{"show-value":"",size:"140px",thickness:.5,color:"positive","track-color":"green-3","center-color":"grey-8",class:"text-white col q-ma-md",modelValue:t.historySize,"onUpdate:modelValue":e[9]||(e[9]=s=>t.historySize=s)},null,8,["modelValue"])]),_:1}),createVNode(QCardActions,{align:"center",class:"text-white"},{default:withCtx(()=>[withDirectives(createVNode(QBtn,{flat:"",label:"Done",onClick:e[10]||(e[10]=s=>this.updateHistoryBuffer())},null,512),[[ClosePopup]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),createVNode(QDialog,{modelValue:t.promptLanguage,"onUpdate:modelValue":e[13]||(e[13]=s=>t.promptLanguage=s),persistent:""},{default:withCtx(()=>[createVNode(QCard,{style:{"min-width":"350px"}},{default:withCtx(()=>[createVNode(QCardSection,null,{default:withCtx(()=>[_hoisted_7$3,createTextVNode(),_hoisted_8$3]),_:1}),createVNode(QCardSection,{class:"q-pt-none"},{default:withCtx(()=>[createBaseVNode("table",_hoisted_9$3,[createBaseVNode("tr",null,[createBaseVNode("td",null,[createVNode(QSelect,{class:"z-max",outlined:"",modelValue:this.store.userSnapshot.preferences.langVoiceKey,"onUpdate:modelValue":[e[12]||(e[12]=s=>this.store.userSnapshot.preferences.langVoiceKey=s),this.langChangeCB],options:this.store.userSnapshot.preferences.langVoices},null,8,["modelValue","options","onUpdate:modelValue"])])])])]),_:1}),createVNode(QCardActions,{align:"right",class:"text-white"},{default:withCtx(()=>[withDirectives(createVNode(QBtn,{outline:"",flat:"",label:"Done"},null,512),[[ClosePopup]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),createVNode(QDialog,{modelValue:t.promptGW,"onUpdate:modelValue":e[18]||(e[18]=s=>t.promptGW=s),persistent:""},{default:withCtx(()=>[createVNode(QCard,{style:{"min-width":"350px"}},{default:withCtx(()=>[createVNode(QCardSection,null,{default:withCtx(()=>[_hoisted_10$3]),_:1}),createVNode(QCardSection,{class:"q-pt-none"},{default:withCtx(()=>[createVNode(QInput,{dense:"",modelValue:this.guideWords,"onUpdate:modelValue":e[14]||(e[14]=s=>this.guideWords=s),autofocus:"",onKeyup:e[15]||(e[15]=withKeys(s=>{this.generateAssignment(),t.promptGW=!1},["enter"]))},null,8,["modelValue"])]),_:1}),createVNode(QCardActions,{align:"right"},{default:withCtx(()=>[withDirectives(createVNode(QBtn,{outline:"",label:"Close",onClick:e[16]||(e[16]=s=>this.promptGW=!1)},null,512),[[ClosePopup]]),withDirectives(createVNode(QBtn,{outline:"",label:"Generate",onClick:e[17]||(e[17]=s=>this.generateAssignment())},null,512),[[ClosePopup]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),createVNode(QDialog,{modelValue:t.promptSearch,"onUpdate:modelValue":e[23]||(e[23]=s=>t.promptSearch=s),persistent:""},{default:withCtx(()=>[createVNode(QCard,{style:{"min-width":"350px"}},{default:withCtx(()=>[createVNode(QCardSection,null,{default:withCtx(()=>[_hoisted_11$2]),_:1}),createVNode(QCardSection,{class:"q-pt-none"},{default:withCtx(()=>[createVNode(QInput,{dense:"",modelValue:this.guideWords,"onUpdate:modelValue":e[19]||(e[19]=s=>this.guideWords=s),autofocus:"",onKeyup:e[20]||(e[20]=withKeys(s=>{this.doSearch(),t.promptSearch=!1},["enter"]))},null,8,["modelValue"])]),_:1}),createVNode(QCardActions,{align:"right"},{default:withCtx(()=>[withDirectives(createVNode(QBtn,{outline:"",label:"Close",onClick:e[21]||(e[21]=s=>this.promptSearch=!1)},null,512),[[ClosePopup]]),withDirectives(createVNode(QBtn,{outline:"",label:"Search",onClick:e[22]||(e[22]=s=>this.doSearch())},null,512),[[ClosePopup]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),createVNode(QCard,{flat:"",bordered:"","no-padding":"",class:"q-ma-md cursor-pointer flex flex-center card-component"},{default:withCtx(()=>[createVNode(QList,{dense:"",bordered:"",class:"full-width"},{default:withCtx(()=>[createVNode(QBar,null,{default:withCtx(()=>[createTextVNode("Wikipedia Content")]),_:1}),createVNode(QExpansionItem,{label:"Generate Courses",class:"hidden"},{default:withCtx(()=>[createVNode(QBar,null,{default:withCtx(()=>[createVNode(QBtn,{onClick:e[24]||(e[24]=s=>this.generateCourse())},{default:withCtx(()=>[createTextVNode("Generate Course")]),_:1}),createVNode(QBtn,{onClick:e[25]||(e[25]=s=>t.promptGW=!0)},{default:withCtx(()=>[createTextVNode("Guide Words")]),_:1})]),_:1})]),_:1}),createVNode(QExpansionItem,{label:"Generate Assignment"},{default:withCtx(()=>[createVNode(QBar,{class:"q-py-lg"},{default:withCtx(()=>[createVNode(QBtn,{onClick:e[26]||(e[26]=s=>this.promptNumPages=!0)},{default:withCtx(()=>[createTextVNode(toDisplayString(this.numPages)+" ",1),createVNode(QTooltip,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:withCtx(()=>[createVNode(QCard,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:withCtx(()=>[createTextVNode(" Change number of pages generated ")]),_:1})]),_:1})]),_:1}),createBaseVNode("span",{class:"on-right cursor-pointer",id:"sfi",onClick:e[27]||(e[27]=s=>t.promptLanguage=!0)},[createVNode(QTooltip,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:withCtx(()=>[createVNode(QCard,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:withCtx(()=>[createTextVNode(" Change Wikipedia language for new pages ")]),_:1})]),_:1})]),createVNode(QSpace),createVNode(QBtn,{class:"on-right",onClick:e[28]||(e[28]=s=>t.promptGW=!0),icon:"play_arrow"},{default:withCtx(()=>[createVNode(QTooltip,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:withCtx(()=>[createVNode(QCard,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:withCtx(()=>[createTextVNode(" Generate pages ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),createVNode(QExpansionItem,{label:"Generate Pages",class:"hidden"},{default:withCtx(()=>[createVNode(QBar,null,{default:withCtx(()=>[createVNode(QBtn,{onClick:e[29]||(e[29]=s=>this.generatePages())},{default:withCtx(()=>[createTextVNode("Generate Page")]),_:1}),createVNode(QBtn,{onClick:e[30]||(e[30]=s=>t.promptGW=!0)},{default:withCtx(()=>[createTextVNode("Guide Words")]),_:1})]),_:1})]),_:1}),createVNode(QExpansionItem,{label:"Search"},{default:withCtx(()=>[createVNode(QBar,{class:"q-py-lg"},{default:withCtx(()=>[createVNode(QBtn,{dark:"",standout:"",onClick:e[31]||(e[31]=s=>t.promptSearchSize=!0)},{default:withCtx(()=>[createTextVNode(toDisplayString(this.searchSize)+" ",1),createVNode(QTooltip,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:withCtx(()=>[createVNode(QCard,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:withCtx(()=>[createTextVNode(" Change results limit ("+toDisplayString(this.searchSize)+") ",1)]),_:1})]),_:1})]),_:1}),createVNode(QBtn,{dark:"",standout:"",onClick:e[32]||(e[32]=s=>t.promptImageResultsSize=!0)},{default:withCtx(()=>[createTextVNode(toDisplayString(this.imageResultsSize)+" ",1),createVNode(QTooltip,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:withCtx(()=>[createVNode(QCard,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:withCtx(()=>[createTextVNode(" Change number of images returned ("+toDisplayString(this.imageResultsSize)+").",1),_hoisted_12$2,createTextVNode(" The initial search does not return images."),_hoisted_13$2,createTextVNode(" This limit applies when loading a search result. ")]),_:1})]),_:1})]),_:1}),createBaseVNode("span",{class:"on-right cursor-pointer",id:"sfi",onClick:e[33]||(e[33]=s=>t.promptLanguage=!0)}),createVNode(QSpace),createVNode(QBtn,{class:"on-right",onClick:e[34]||(e[34]=s=>t.promptSearch=!0),icon:"search"})]),_:1}),this.searchResults.length?(openBlock(),createElementBlock("div",_hoisted_14$1,[(openBlock(!0),createElementBlock(Fragment,null,renderList(this.searchResults,(s,i)=>(openBlock(),createBlock(QCard,{class:"q-ma-sm",flat:"",bordered:"",modelValue:this.searchResults,"onUpdate:modelValue":e[35]||(e[35]=d=>this.searchResults=d),key:i},{default:withCtx(()=>[createBaseVNode("div",_hoisted_15$1,[createBaseVNode("span",{class:"history-title col-grow",onClick:d=>this.loadSearch(i)},toDisplayString(i)+". "+toDisplayString(s.title.slice(0,25)),9,_hoisted_16$1)])]),_:2},1032,["modelValue"]))),128))])):createCommentVNode("",!0)]),_:1}),createVNode(QExpansionItem,{label:"On This Day"},{default:withCtx(()=>[createVNode(QBar,{class:"q-py-lg"},{default:withCtx(()=>[createVNode(QBtn,{dark:"",standout:"",icon:"calendar_today",onClick:e[36]||(e[36]=s=>t.promptOTDDate=!0)}),createBaseVNode("span",{class:"on-right cursor-pointer",id:"sfi",onClick:e[37]||(e[37]=s=>t.promptLanguage=!0)}),createVNode(QSpace),createVNode(QSelect,{dark:"",dense:"",modelValue:this.otdtype,"onUpdate:modelValue":e[38]||(e[38]=s=>this.otdtype=s),options:["events","holidays","births","deaths","selected"],"emit-value":"",onPopupHide:e[39]||(e[39]=s=>this.otdOptionsCB()),class:"on-right"},null,8,["modelValue"])]),_:1}),(openBlock(!0),createElementBlock(Fragment,null,renderList(t.otditems,(s,i)=>(openBlock(),createBlock(QCard,{class:"q-pa-sm q-ma-sm",flat:"",bordered:"",modelValue:t.otditems,"onUpdate:modelValue":e[40]||(e[40]=d=>t.otditems=d),key:i},{default:withCtx(()=>[createVNode(QBadge,{class:"on-left",style:{cursor:"pointer"},onClick:d=>this.loadOTD(i)},{default:withCtx(()=>[createVNode(QTooltip,null,{default:withCtx(()=>[createTextVNode("OTD result "+toDisplayString(i),1)]),_:2},1024),createVNode(QIcon,{size:"xs",name:"link"})]),_:2},1032,["onClick"]),createTextVNode(" "+toDisplayString(s.year)+" "+toDisplayString(s.text),1),_hoisted_17$1,(openBlock(!0),createElementBlock(Fragment,null,renderList(s.pages,(d,g)=>(openBlock(),createElementBlock("span",{key:g},[createVNode(QBadge,{class:"on-left",style:{cursor:"pointer"},onClick:l=>this.loadOTDPageId(d.pageid,this.store.userSnapshot.preferences.langVoiceKey)},{default:withCtx(()=>[createVNode(QTooltip,null,{default:withCtx(()=>[createTextVNode(toDisplayString(d.title),1)]),_:2},1024),createVNode(QIcon,{size:"xs",name:"link"})]),_:2},1032,["onClick"])]))),128))]),_:2},1032,["modelValue"]))),128))]),_:1})]),_:1})]),_:1}),createBaseVNode("div",_hoisted_18$1,[createVNode(QList,{bordered:"",class:"rounded-borders",icon:"gear"},{default:withCtx(()=>[createVNode(QExpansionItem,{label:"Saved Bookmarks"},{default:withCtx(()=>{var s;return[(s=this.store.userSnapshot)!=null&&s.bookmarks?(openBlock(),createElementBlock("div",_hoisted_19$1,[(openBlock(!0),createElementBlock(Fragment,null,renderList(this.store.userSnapshot.bookmarks,(i,d)=>(openBlock(),createBlock(QCard,{class:"q-ma-sm",flat:"",bordered:"",modelValue:this.store.userSnapshot.bookmarks,"onUpdate:modelValue":e[41]||(e[41]=g=>this.store.userSnapshot.bookmarks=g),key:d},{default:withCtx(()=>[createBaseVNode("div",_hoisted_20$1,[createBaseVNode("span",{class:"history-title col-grow q-py-xs q-px-sm",onClick:g=>this.loadOTDPageId(i.pageid,i.langVoiceKey)},toDisplayString(d.slice(0,20)),9,_hoisted_21$1),createBaseVNode("span",_hoisted_22$1,toDisplayString(i),1),createVNode(QIcon,{class:"q-pb-xs q-pt-sm q-px-sm",size:t.xl,color:t.primary,name:"clear",onClick:g=>this.store.removeBookmark(d)},null,8,["size","color","onClick"])])]),_:2},1032,["modelValue"]))),128))])):createCommentVNode("",!0)]}),_:1})]),_:1})]),createBaseVNode("div",_hoisted_23$1,[createVNode(QList,{bordered:"",class:"rounded-borders",icon:"gear"},{default:withCtx(()=>[createVNode(QExpansionItem,{label:"Saved Images"},{default:withCtx(()=>{var s;return[(openBlock(!0),createElementBlock(Fragment,null,renderList((s=this.store.userSnapshot)==null?void 0:s.images,(i,d)=>(openBlock(),createBlock(QCard,{class:"q-ma-sm",flat:"",bordered:"",modelValue:this.store.userSnapshot.images,"onUpdate:modelValue":e[42]||(e[42]=g=>this.store.userSnapshot.images=g),key:d},{default:withCtx(()=>[createBaseVNode("div",_hoisted_24$1,[createBaseVNode("span",{class:"history-title col-grow q-py-xs q-px-sm",onClick:g=>this.loadImage(i)},toDisplayString(i.cap.slice(0,20)),9,_hoisted_25),createBaseVNode("span",_hoisted_26,toDisplayString(d),1),createVNode(QIcon,{class:"q-pb-xs q-pt-sm q-px-sm",size:t.xl,color:t.primary,name:"clear",onClick:g=>this.store.removeImage(d)},null,8,["size","color","onClick"])])]),_:2},1032,["modelValue"]))),128))]}),_:1})]),_:1})]),createBaseVNode("div",_hoisted_27,[createVNode(QList,{bordered:"",class:"rounded-borders",icon:"gear"},{default:withCtx(()=>[createVNode(QExpansionItem,{label:"Saved History"},{default:withCtx(()=>[createVNode(QBar,{class:"q-py-lg"},{default:withCtx(()=>[createVNode(QBtn,{dark:"",standout:"",onClick:e[43]||(e[43]=s=>t.promptHistorySize=!0)},{default:withCtx(()=>[createTextVNode(toDisplayString(this.historySize)+" ",1),createVNode(QTooltip,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:withCtx(()=>[createVNode(QCard,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:withCtx(()=>[createTextVNode(" Change history size ("+toDisplayString(this.historySize)+") ",1)]),_:1})]),_:1})]),_:1}),createVNode(QBtn,{icon:"clear",onClick:e[44]||(e[44]=s=>this.history=[])})]),_:1}),(openBlock(!0),createElementBlock(Fragment,null,renderList(this.history,(s,i)=>(openBlock(),createBlock(QCard,{class:"q-ma-sm",flat:"",bordered:"",modelValue:this.history,"onUpdate:modelValue":e[45]||(e[45]=d=>this.history=d),key:i},{default:withCtx(()=>[createBaseVNode("div",_hoisted_28,[createBaseVNode("span",{class:"history-title col-grow q-py-xs q-px-sm",onClick:d=>this.loadOTDPageId(s.pageid,s.langVoiceKey)},toDisplayString(s.title),9,_hoisted_29),createBaseVNode("span",_hoisted_30,toDisplayString(i),1)])]),_:2},1032,["modelValue"]))),128))]),_:1})]),_:1})])],64)}var WPComponent=_export_sfc(_sfc_main$3,[["render",_sfc_render$3]]);const separatorValues=["horizontal","vertical","cell","none"];var QMarkupTable=createComponent({name:"QMarkupTable",props:{...useDarkProps,dense:Boolean,flat:Boolean,bordered:Boolean,square:Boolean,wrapCells:Boolean,separator:{type:String,default:"horizontal",validator:t=>separatorValues.includes(t)}},setup(t,{slots:e}){const r=getCurrentInstance(),n=useDark(t,r.proxy.$q),a=computed(()=>`q-markup-table q-table__container q-table__card q-table--${t.separator}-separator`+(n.value===!0?" q-table--dark q-table__card--dark q-dark":"")+(t.dense===!0?" q-table--dense":"")+(t.flat===!0?" q-table--flat":"")+(t.bordered===!0?" q-table--bordered":"")+(t.square===!0?" q-table--square":"")+(t.wrapCells===!1?" q-table--no-wrap":""));return()=>h("div",{class:a.value},[h("table",{class:"q-table"},hSlot(e.default))])}}),V3_URL="https://js.stripe.com/v3",V3_URL_REGEX=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,EXISTING_SCRIPT_MESSAGE="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",findScript=function t(){for(var e=document.querySelectorAll('script[src^="'.concat(V3_URL,'"]')),r=0;r<e.length;r++){var n=e[r];if(!!V3_URL_REGEX.test(n.src))return n}return null},injectScript=function t(e){var r=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",n=document.createElement("script");n.src="".concat(V3_URL).concat(r);var a=document.head||document.body;if(!a)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return a.appendChild(n),n},registerWrapper=function t(e,r){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"1.52.1",startTime:r})},stripePromise=null,loadScript=function t(e){return stripePromise!==null||(stripePromise=new Promise(function(r,n){if(typeof window=="undefined"||typeof document=="undefined"){r(null);return}if(window.Stripe&&e&&console.warn(EXISTING_SCRIPT_MESSAGE),window.Stripe){r(window.Stripe);return}try{var a=findScript();a&&e?console.warn(EXISTING_SCRIPT_MESSAGE):a||(a=injectScript(e)),a.addEventListener("load",function(){window.Stripe?r(window.Stripe):n(new Error("Stripe.js not available"))}),a.addEventListener("error",function(){n(new Error("Failed to load Stripe.js"))})}catch(o){n(o);return}})),stripePromise},initStripe=function t(e,r,n){if(e===null)return null;var a=e.apply(void 0,r);return registerWrapper(a,n),a},stripePromise$1=Promise.resolve().then(function(){return loadScript(null)}),loadCalled=!1;stripePromise$1.catch(function(t){loadCalled||console.warn(t)});var loadStripe=function t(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];loadCalled=!0;var a=Date.now();return stripePromise$1.then(function(o){return initStripe(o,r,a)})};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const stringToByteArray$1$1=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let a=t.charCodeAt(n);a<128?e[r++]=a:a<2048?(e[r++]=a>>6|192,e[r++]=a&63|128):(a&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=a>>18|240,e[r++]=a>>12&63|128,e[r++]=a>>6&63|128,e[r++]=a&63|128):(e[r++]=a>>12|224,e[r++]=a>>6&63|128,e[r++]=a&63|128)}return e},byteArrayToString$1=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const a=t[r++];if(a<128)e[n++]=String.fromCharCode(a);else if(a>191&&a<224){const o=t[r++];e[n++]=String.fromCharCode((a&31)<<6|o&63)}else if(a>239&&a<365){const o=t[r++],s=t[r++],i=t[r++],d=((a&7)<<18|(o&63)<<12|(s&63)<<6|i&63)-65536;e[n++]=String.fromCharCode(55296+(d>>10)),e[n++]=String.fromCharCode(56320+(d&1023))}else{const o=t[r++],s=t[r++];e[n++]=String.fromCharCode((a&15)<<12|(o&63)<<6|s&63)}}return e.join("")},base64$1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let a=0;a<t.length;a+=3){const o=t[a],s=a+1<t.length,i=s?t[a+1]:0,d=a+2<t.length,g=d?t[a+2]:0,l=o>>2,u=(o&3)<<4|i>>4;let m=(i&15)<<2|g>>6,y=g&63;d||(y=64,s||(m=64)),n.push(r[l],r[u],r[m],r[y])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(stringToByteArray$1$1(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):byteArrayToString$1(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let a=0;a<t.length;){const o=r[t.charAt(a++)],i=a<t.length?r[t.charAt(a)]:0;++a;const g=a<t.length?r[t.charAt(a)]:64;++a;const u=a<t.length?r[t.charAt(a)]:64;if(++a,o==null||i==null||g==null||u==null)throw Error();const m=o<<2|i>>4;if(n.push(m),g!==64){const y=i<<4&240|g>>2;if(n.push(y),u!==64){const C=g<<6&192|u;n.push(C)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},base64Encode=function(t){const e=stringToByteArray$1$1(t);return base64$1.encodeByteArray(e,!0)},base64urlEncodeWithoutPadding=function(t){return base64Encode(t).replace(/\./g,"")};function isIndexedDBAvailable(){return typeof indexedDB=="object"}function validateIndexedDBOpenable(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},a.onupgradeneeded=()=>{r=!1},a.onerror=()=>{var o;e(((o=a.error)===null||o===void 0?void 0:o.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERROR_NAME$1="FirebaseError";class FirebaseError$1 extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=ERROR_NAME$1,Object.setPrototypeOf(this,FirebaseError$1.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ErrorFactory$1.prototype.create)}}class ErrorFactory$1{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},a=`${this.service}/${e}`,o=this.errors[e],s=o?replaceTemplate$1(o,n):"Error",i=`${this.serviceName}: ${s} (${a}).`;return new FirebaseError$1(a,i,n)}}function replaceTemplate$1(t,e){return t.replace(PATTERN$1,(r,n)=>{const a=e[n];return a!=null?String(a):`<${n}?>`})}const PATTERN$1=/\{\$([^}]+)}/g;class Component$1{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var LogLevel$1;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(LogLevel$1||(LogLevel$1={}));const levelStringToEnum$1={debug:LogLevel$1.DEBUG,verbose:LogLevel$1.VERBOSE,info:LogLevel$1.INFO,warn:LogLevel$1.WARN,error:LogLevel$1.ERROR,silent:LogLevel$1.SILENT},defaultLogLevel$1=LogLevel$1.INFO,ConsoleMethod$1={[LogLevel$1.DEBUG]:"log",[LogLevel$1.VERBOSE]:"log",[LogLevel$1.INFO]:"info",[LogLevel$1.WARN]:"warn",[LogLevel$1.ERROR]:"error"},defaultLogHandler$1=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),a=ConsoleMethod$1[e];if(a)console[a](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Logger$1{constructor(e){this.name=e,this._logLevel=defaultLogLevel$1,this._logHandler=defaultLogHandler$1,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in LogLevel$1))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?levelStringToEnum$1[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel$1.DEBUG,...e),this._logHandler(this,LogLevel$1.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel$1.VERBOSE,...e),this._logHandler(this,LogLevel$1.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel$1.INFO,...e),this._logHandler(this,LogLevel$1.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel$1.WARN,...e),this._logHandler(this,LogLevel$1.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel$1.ERROR,...e),this._logHandler(this,LogLevel$1.ERROR,...e)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PlatformLoggerServiceImpl{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(isVersionServiceProvider(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function isVersionServiceProvider(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const name$o="@firebase/app",version$1="0.7.33";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logger=new Logger$1("@firebase/app"),name$n="@firebase/app-compat",name$m="@firebase/analytics-compat",name$l="@firebase/analytics",name$k="@firebase/app-check-compat",name$j="@firebase/app-check",name$i="@firebase/auth",name$h="@firebase/auth-compat",name$g="@firebase/database",name$f="@firebase/database-compat",name$e="@firebase/functions",name$d="@firebase/functions-compat",name$c="@firebase/installations",name$b="@firebase/installations-compat",name$a="@firebase/messaging",name$9="@firebase/messaging-compat",name$8="@firebase/performance",name$7="@firebase/performance-compat",name$6="@firebase/remote-config",name$5="@firebase/remote-config-compat",name$4="@firebase/storage",name$3="@firebase/storage-compat",name$2="@firebase/firestore",name$1="@firebase/firestore-compat",name$p="firebase",version$2="9.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ENTRY_NAME="[DEFAULT]",PLATFORM_LOG_STRING={[name$o]:"fire-core",[name$n]:"fire-core-compat",[name$l]:"fire-analytics",[name$m]:"fire-analytics-compat",[name$j]:"fire-app-check",[name$k]:"fire-app-check-compat",[name$i]:"fire-auth",[name$h]:"fire-auth-compat",[name$g]:"fire-rtdb",[name$f]:"fire-rtdb-compat",[name$e]:"fire-fn",[name$d]:"fire-fn-compat",[name$c]:"fire-iid",[name$b]:"fire-iid-compat",[name$a]:"fire-fcm",[name$9]:"fire-fcm-compat",[name$8]:"fire-perf",[name$7]:"fire-perf-compat",[name$6]:"fire-rc",[name$5]:"fire-rc-compat",[name$4]:"fire-gcs",[name$3]:"fire-gcs-compat",[name$2]:"fire-fst",[name$1]:"fire-fst-compat","fire-js":"fire-js",[name$p]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _apps=new Map,_components=new Map;function _addComponent(t,e){try{t.container.addComponent(e)}catch(r){logger.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function _registerComponent(t){const e=t.name;if(_components.has(e))return logger.debug(`There were multiple attempts to register component ${e}.`),!1;_components.set(e,t);for(const r of _apps.values())_addComponent(r,t);return!0}function _getProvider(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERRORS={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["idb-open"]:"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",["idb-get"]:"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",["idb-set"]:"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",["idb-delete"]:"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},ERROR_FACTORY=new ErrorFactory$1("app","Firebase",ERRORS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SDK_VERSION=version$2;function getApp(t=DEFAULT_ENTRY_NAME){const e=_apps.get(t);if(!e)throw ERROR_FACTORY.create("no-app",{appName:t});return e}function registerVersion(t,e,r){var n;let a=(n=PLATFORM_LOG_STRING[t])!==null&&n!==void 0?n:t;r&&(a+=`-${r}`);const o=a.match(/\s|\//),s=e.match(/\s|\//);if(o||s){const i=[`Unable to register library "${a}" with version "${e}":`];o&&i.push(`library name "${a}" contains illegal characters (whitespace or "/")`),o&&s&&i.push("and"),s&&i.push(`version name "${e}" contains illegal characters (whitespace or "/")`),logger.warn(i.join(" "));return}_registerComponent(new Component$1(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DB_NAME$1="firebase-heartbeat-database",DB_VERSION$1=1,STORE_NAME="firebase-heartbeat-store";let dbPromise=null;function getDbPromise(){return dbPromise||(dbPromise=openDB(DB_NAME$1,DB_VERSION$1,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(STORE_NAME)}}}).catch(t=>{throw ERROR_FACTORY.create("idb-open",{originalErrorMessage:t.message})})),dbPromise}async function readHeartbeatsFromIndexedDB(t){var e;try{return(await getDbPromise()).transaction(STORE_NAME).objectStore(STORE_NAME).get(computeKey(t))}catch(r){if(r instanceof FirebaseError$1)logger.warn(r.message);else{const n=ERROR_FACTORY.create("idb-get",{originalErrorMessage:(e=r)===null||e===void 0?void 0:e.message});logger.warn(n.message)}}}async function writeHeartbeatsToIndexedDB(t,e){var r;try{const a=(await getDbPromise()).transaction(STORE_NAME,"readwrite");return await a.objectStore(STORE_NAME).put(e,computeKey(t)),a.done}catch(n){if(n instanceof FirebaseError$1)logger.warn(n.message);else{const a=ERROR_FACTORY.create("idb-set",{originalErrorMessage:(r=n)===null||r===void 0?void 0:r.message});logger.warn(a.message)}}}function computeKey(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MAX_HEADER_BYTES=1024,STORED_HEARTBEAT_RETENTION_MAX_MILLIS=30*24*60*60*1e3;class HeartbeatServiceImpl{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new HeartbeatStorageImpl(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=getUTCDateString();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(a=>a.date===n)))return this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=STORED_HEARTBEAT_RETENTION_MAX_MILLIS}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=getUTCDateString(),{heartbeatsToSend:r,unsentEntries:n}=extractHeartbeatsForHeader(this._heartbeatsCache.heartbeats),a=base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}}function getUTCDateString(){return new Date().toISOString().substring(0,10)}function extractHeartbeatsForHeader(t,e=MAX_HEADER_BYTES){const r=[];let n=t.slice();for(const a of t){const o=r.find(s=>s.agent===a.agent);if(o){if(o.dates.push(a.date),countBytes(r)>e){o.dates.pop();break}}else if(r.push({agent:a.agent,dates:[a.date]}),countBytes(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class HeartbeatStorageImpl{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return isIndexedDBAvailable()?validateIndexedDBOpenable().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await readHeartbeatsFromIndexedDB(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const a=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const a=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function countBytes(t){return base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function registerCoreComponents(t){_registerComponent(new Component$1("platform-logger",e=>new PlatformLoggerServiceImpl(e),"PRIVATE")),_registerComponent(new Component$1("heartbeat",e=>new HeartbeatServiceImpl(e),"PRIVATE")),registerVersion(name$o,version$1,t),registerVersion(name$o,version$1,"esm2017"),registerVersion("fire-js","")}registerCoreComponents("");registerVersion("firestore-stripe-payments","0.0.6");function getStripePayments(t,e){return StripePayments.create(t,e)}class StripePayments{constructor(e,r){this.app=e,this.options=r,this.components={}}static create(e,r){return new StripePayments(e,r)}get customersCollection(){return this.options.customersCollection}get productsCollection(){return this.options.productsCollection}getComponent(e){let r=this.components[e];return r||null}setComponent(e,r){this.components[e]=r}}class StripePaymentsError extends Error{constructor(e,r,n){super(r),this.code=e,this.message=r,this.cause=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var stringToByteArray$1=function(t){for(var e=[],r=0,n=0;n<t.length;n++){var a=t.charCodeAt(n);a<128?e[r++]=a:a<2048?(e[r++]=a>>6|192,e[r++]=a&63|128):(a&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=a>>18|240,e[r++]=a>>12&63|128,e[r++]=a>>6&63|128,e[r++]=a&63|128):(e[r++]=a>>12|224,e[r++]=a>>6&63|128,e[r++]=a&63|128)}return e},byteArrayToString=function(t){for(var e=[],r=0,n=0;r<t.length;){var a=t[r++];if(a<128)e[n++]=String.fromCharCode(a);else if(a>191&&a<224){var o=t[r++];e[n++]=String.fromCharCode((a&31)<<6|o&63)}else if(a>239&&a<365){var o=t[r++],s=t[r++],i=t[r++],d=((a&7)<<18|(o&63)<<12|(s&63)<<6|i&63)-65536;e[n++]=String.fromCharCode(55296+(d>>10)),e[n++]=String.fromCharCode(56320+(d&1023))}else{var o=t[r++],s=t[r++];e[n++]=String.fromCharCode((a&15)<<12|(o&63)<<6|s&63)}}return e.join("")},base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[],a=0;a<t.length;a+=3){var o=t[a],s=a+1<t.length,i=s?t[a+1]:0,d=a+2<t.length,g=d?t[a+2]:0,l=o>>2,u=(o&3)<<4|i>>4,m=(i&15)<<2|g>>6,y=g&63;d||(y=64,s||(m=64)),n.push(r[l],r[u],r[m],r[y])}return n.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(stringToByteArray$1(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):byteArrayToString(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[],a=0;a<t.length;){var o=r[t.charAt(a++)],s=a<t.length,i=s?r[t.charAt(a)]:0;++a;var d=a<t.length,g=d?r[t.charAt(a)]:64;++a;var l=a<t.length,u=l?r[t.charAt(a)]:64;if(++a,o==null||i==null||g==null||u==null)throw Error();var m=o<<2|i>>4;if(n.push(m),g!==64){var y=i<<4&240|g>>2;if(n.push(y),u!==64){var C=g<<6&192|u;n.push(C)}}}return n},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},base64Decode=function(t){try{return base64.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getUA(){return typeof navigator!="undefined"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function isMobileCordova(){return typeof window!="undefined"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA())}function isBrowserExtension(){var t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function isReactNative(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function isIE(){var t=getUA();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ERROR_NAME="FirebaseError",FirebaseError=function(t){__extends(e,t);function e(r,n,a){var o=t.call(this,n)||this;return o.code=r,o.customData=a,o.name=ERROR_NAME,Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,ErrorFactory.prototype.create),o}return e}(Error),ErrorFactory=function(){function t(e,r,n){this.service=e,this.serviceName=r,this.errors=n}return t.prototype.create=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var a=r[0]||{},o=this.service+"/"+e,s=this.errors[e],i=s?replaceTemplate(s,a):"Error",d=this.serviceName+": "+i+" ("+o+").",g=new FirebaseError(o,d,a);return g},t}();function replaceTemplate(t,e){return t.replace(PATTERN,function(r,n){var a=e[n];return a!=null?String(a):"<"+n+"?>"})}var PATTERN=/\{\$([^}]+)}/g;function isEmpty(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function deepEqual(t,e){if(t===e)return!0;for(var r=Object.keys(t),n=Object.keys(e),a=0,o=r;a<o.length;a++){var s=o[a];if(!n.includes(s))return!1;var i=t[s],d=e[s];if(isObject(i)&&isObject(d)){if(!deepEqual(i,d))return!1}else if(i!==d)return!1}for(var g=0,l=n;g<l.length;g++){var s=l[g];if(!r.includes(s))return!1}return!0}function isObject(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function querystring(t){for(var e=[],r=function(d,g){Array.isArray(g)?g.forEach(function(l){e.push(encodeURIComponent(d)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(d)+"="+encodeURIComponent(g))},n=0,a=Object.entries(t);n<a.length;n++){var o=a[n],s=o[0],i=o[1];r(s,i)}return e.length?"&"+e.join("&"):""}function createSubscribe(t,e){var r=new ObserverProxy(t,e);return r.subscribe.bind(r)}var ObserverProxy=function(){function t(e,r){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(function(){e(n)}).catch(function(a){n.error(a)})}return t.prototype.next=function(e){this.forEachObserver(function(r){r.next(e)})},t.prototype.error=function(e){this.forEachObserver(function(r){r.error(e)}),this.close(e)},t.prototype.complete=function(){this.forEachObserver(function(e){e.complete()}),this.close()},t.prototype.subscribe=function(e,r,n){var a=this,o;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");implementsAnyMethods(e,["next","error","complete"])?o=e:o={next:e,error:r,complete:n},o.next===void 0&&(o.next=noop),o.error===void 0&&(o.error=noop),o.complete===void 0&&(o.complete=noop);var s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{a.finalError?o.error(a.finalError):o.complete()}catch{}}),this.observers.push(o),s},t.prototype.unsubscribeOne=function(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))},t.prototype.forEachObserver=function(e){if(!this.finalized)for(var r=0;r<this.observers.length;r++)this.sendOne(r,e)},t.prototype.sendOne=function(e,r){var n=this;this.task.then(function(){if(n.observers!==void 0&&n.observers[e]!==void 0)try{r(n.observers[e])}catch(a){typeof console!="undefined"&&console.error&&console.error(a)}})},t.prototype.close=function(e){var r=this;this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(function(){r.observers=void 0,r.onNoObservers=void 0}))},t}();function implementsAnyMethods(t,e){if(typeof t!="object"||t===null)return!1;for(var r=0,n=e;r<n.length;r++){var a=n[r];if(a in t&&typeof t[a]=="function")return!0}return!1}function noop(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getModularInstance(t){return t&&t._delegate?t._delegate:t}/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function __spreadArrays(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),a=0,e=0;e<r;e++)for(var o=arguments[e],s=0,i=o.length;s<i;s++,a++)n[a]=o[s];return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _a,LogLevel;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(LogLevel||(LogLevel={}));var levelStringToEnum={debug:LogLevel.DEBUG,verbose:LogLevel.VERBOSE,info:LogLevel.INFO,warn:LogLevel.WARN,error:LogLevel.ERROR,silent:LogLevel.SILENT},defaultLogLevel=LogLevel.INFO,ConsoleMethod=(_a={},_a[LogLevel.DEBUG]="log",_a[LogLevel.VERBOSE]="log",_a[LogLevel.INFO]="info",_a[LogLevel.WARN]="warn",_a[LogLevel.ERROR]="error",_a),defaultLogHandler=function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];if(!(e<t.logLevel)){var a=new Date().toISOString(),o=ConsoleMethod[e];if(o)console[o].apply(console,__spreadArrays(["["+a+"]  "+t.name+":"],r));else throw new Error("Attempted to log a message with an invalid logType (value: "+e+")")}},Logger=function(){function t(e){this.name=e,this._logLevel=defaultLogLevel,this._logHandler=defaultLogHandler,this._userLogHandler=null}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in LogLevel))throw new TypeError('Invalid value "'+e+'" assigned to `logLevel`');this._logLevel=e},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(e){this._logLevel=typeof e=="string"?levelStringToEnum[e]:e},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,__spreadArrays([this,LogLevel.DEBUG],e)),this._logHandler.apply(this,__spreadArrays([this,LogLevel.DEBUG],e))},t.prototype.log=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,__spreadArrays([this,LogLevel.VERBOSE],e)),this._logHandler.apply(this,__spreadArrays([this,LogLevel.VERBOSE],e))},t.prototype.info=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,__spreadArrays([this,LogLevel.INFO],e)),this._logHandler.apply(this,__spreadArrays([this,LogLevel.INFO],e))},t.prototype.warn=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,__spreadArrays([this,LogLevel.WARN],e)),this._logHandler.apply(this,__spreadArrays([this,LogLevel.WARN],e))},t.prototype.error=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,__spreadArrays([this,LogLevel.ERROR],e)),this._logHandler.apply(this,__spreadArrays([this,LogLevel.ERROR],e))},t}(),Component=function(){function t(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},t.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},t.prototype.setServiceProps=function(e){return this.serviceProps=e,this},t.prototype.setInstanceCreatedCallback=function(e){return this.onInstanceCreated=e,this},t}();function _prodErrorMap(){return{["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const prodErrorMap=_prodErrorMap,_DEFAULT_AUTH_ERROR_FACTORY=new ErrorFactory("auth","Firebase",_prodErrorMap());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logClient=new Logger("@firebase/auth");function _logError(t,...e){logClient.logLevel<=LogLevel.ERROR&&logClient.error(`Auth (${SDK_VERSION}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _fail(t,...e){throw createErrorInternal(t,...e)}function _createError(t,...e){return createErrorInternal(t,...e)}function _errorWithCustomMessage(t,e,r){const n=Object.assign(Object.assign({},prodErrorMap()),{[e]:r});return new ErrorFactory("auth","Firebase",n).create(e,{appName:t.name})}function createErrorInternal(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return _DEFAULT_AUTH_ERROR_FACTORY.create(t,...e)}function _assert(t,e,...r){if(!t)throw createErrorInternal(e,...r)}function debugFail(t){const e="INTERNAL ASSERTION FAILED: "+t;throw _logError(e),new Error(e)}function debugAssert(t,e){t||debugFail(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const instanceCache=new Map;function _getInstance(t){debugAssert(t instanceof Function,"Expected a class definition");let e=instanceCache.get(t);return e?(debugAssert(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,instanceCache.set(t,e),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function initializeAuth(t,e){const r=_getProvider(t,"auth");if(r.isInitialized()){const a=r.getImmediate(),o=r.getOptions();if(deepEqual(o,e!=null?e:{}))return a;_fail(a,"already-initialized")}return r.initialize({options:e})}function _initializeAuthInstance(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(_getInstance);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getCurrentUrl(){var t;return typeof self!="undefined"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function _isHttpOrHttps(){return _getCurrentScheme()==="http:"||_getCurrentScheme()==="https:"}function _getCurrentScheme(){var t;return typeof self!="undefined"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _isOnline(){return typeof navigator!="undefined"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(_isHttpOrHttps()||isBrowserExtension()||"connection"in navigator)?navigator.onLine:!0}function _getUserLanguage(){if(typeof navigator=="undefined")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Delay{constructor(e,r){this.shortDelay=e,this.longDelay=r,debugAssert(r>e,"Short delay should be less than long delay!"),this.isMobile=isMobileCordova()||isReactNative()}get(){return _isOnline()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _emulatorUrl(t,e){debugAssert(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FetchProvider{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self!="undefined"&&"fetch"in self)return self.fetch;debugFail("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self!="undefined"&&"Headers"in self)return self.Headers;debugFail("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self!="undefined"&&"Response"in self)return self.Response;debugFail("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SERVER_ERROR_MAP={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_API_TIMEOUT_MS=new Delay(3e4,6e4);function _addTidIfNecessary(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function _performApiRequest(t,e,r,n,a={}){return _performFetchWithErrorHandling(t,a,()=>{let o={},s={};n&&(e==="GET"?s=n:o={body:JSON.stringify(n)});const i=querystring(Object.assign({key:t.config.apiKey},s)).slice(1),d=new(FetchProvider.headers());return d.set("Content-Type","application/json"),d.set("X-Client-Version",t._getSdkClientVersion()),t.languageCode&&d.set("X-Firebase-Locale",t.languageCode),FetchProvider.fetch()(_getFinalTarget(t,t.config.apiHost,r,i),Object.assign({method:e,headers:d,referrerPolicy:"no-referrer"},o))})}async function _performFetchWithErrorHandling(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},SERVER_ERROR_MAP),e);try{const a=new NetworkTimeout(t),o=await Promise.race([r(),a.promise]);a.clearNetworkTimeout();const s=await o.json();if("needConfirmation"in s)throw _makeTaggedError(t,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{const i=o.ok?s.errorMessage:s.error.message,[d,g]=i.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw _makeTaggedError(t,"credential-already-in-use",s);if(d==="EMAIL_EXISTS")throw _makeTaggedError(t,"email-already-in-use",s);const l=n[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(g)throw _errorWithCustomMessage(t,l,g);_fail(t,l)}}catch(a){if(a instanceof FirebaseError)throw a;_fail(t,"network-request-failed")}}async function _performSignInRequest(t,e,r,n,a={}){const o=await _performApiRequest(t,e,r,n,a);return"mfaPendingCredential"in o&&_fail(t,"multi-factor-auth-required",{serverResponse:o}),o}function _getFinalTarget(t,e,r,n){const a=`${e}${r}?${n}`;return t.config.emulator?_emulatorUrl(t.config,a):`${t.config.apiScheme}://${a}`}class NetworkTimeout{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(_createError(this.auth,"timeout")),DEFAULT_API_TIMEOUT_MS.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function _makeTaggedError(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const a=_createError(t,e,n);return a.customData._tokenResponse=r,a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function deleteAccount(t,e){return _performApiRequest(t,"POST","/v1/accounts:delete",e)}async function getAccountInfo(t,e){return _performApiRequest(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function utcTimestampToDateString(t){if(!!t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function getIdTokenResult(t,e=!1){const r=getModularInstance(t),n=await r.getIdToken(e),a=_parseToken(n);_assert(a&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error");const o=typeof a.firebase=="object"?a.firebase:void 0,s=o==null?void 0:o.sign_in_provider;return{claims:a,token:n,authTime:utcTimestampToDateString(secondsStringToMilliseconds(a.auth_time)),issuedAtTime:utcTimestampToDateString(secondsStringToMilliseconds(a.iat)),expirationTime:utcTimestampToDateString(secondsStringToMilliseconds(a.exp)),signInProvider:s||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function secondsStringToMilliseconds(t){return Number(t)*1e3}function _parseToken(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return _logError("JWT malformed, contained fewer than 3 sections"),null;try{const a=base64Decode(r);return a?JSON.parse(a):(_logError("Failed to decode base64 JWT payload"),null)}catch(a){return _logError("Caught error parsing JWT payload as JSON",a),null}}function _tokenExpiresIn(t){const e=_parseToken(t);return _assert(e,"internal-error"),_assert(typeof e.exp!="undefined","internal-error"),_assert(typeof e.iat!="undefined","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _logoutIfInvalidated(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof FirebaseError&&isUserInvalidated(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function isUserInvalidated({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ProactiveRefresh{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const a=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UserMetadata{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=utcTimestampToDateString(this.lastLoginAt),this.creationTime=utcTimestampToDateString(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _reloadWithoutSaving(t){var e;const r=t.auth,n=await t.getIdToken(),a=await _logoutIfInvalidated(t,getAccountInfo(r,{idToken:n}));_assert(a==null?void 0:a.users.length,r,"internal-error");const o=a.users[0];t._notifyReloadListener(o);const s=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?extractProviderData(o.providerUserInfo):[],i=mergeProviderData(t.providerData,s),d=t.isAnonymous,g=!(t.email&&o.passwordHash)&&!(i!=null&&i.length),l=d?g:!1,u={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:i,metadata:new UserMetadata(o.createdAt,o.lastLoginAt),isAnonymous:l};Object.assign(t,u)}async function reload(t){const e=getModularInstance(t);await _reloadWithoutSaving(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function mergeProviderData(t,e){return[...t.filter(n=>!e.some(a=>a.providerId===n.providerId)),...e]}function extractProviderData(t){return t.map(e=>{var{providerId:r}=e,n=__rest$2(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function requestStsToken(t,e){const r=await _performFetchWithErrorHandling(t,{},()=>{const n=querystring({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:o}=t.config,s=_getFinalTarget(t,a,"/v1/token",`key=${o}`);return FetchProvider.fetch()(s,{method:"POST",headers:{"X-Client-Version":t._getSdkClientVersion(),"Content-Type":"application/x-www-form-urlencoded"},body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class StsTokenManager{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){_assert(e.idToken,"internal-error"),_assert(typeof e.idToken!="undefined","internal-error"),_assert(typeof e.refreshToken!="undefined","internal-error");const r="expiresIn"in e&&typeof e.expiresIn!="undefined"?Number(e.expiresIn):_tokenExpiresIn(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}async getToken(e,r=!1){return _assert(!this.accessToken||this.refreshToken,e,"user-token-expired"),!r&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:a,expiresIn:o}=await requestStsToken(e,r);this.updateTokensAndExpiration(n,a,Number(o))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:a,expirationTime:o}=r,s=new StsTokenManager;return n&&(_assert(typeof n=="string","internal-error",{appName:e}),s.refreshToken=n),a&&(_assert(typeof a=="string","internal-error",{appName:e}),s.accessToken=a),o&&(_assert(typeof o=="number","internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new StsTokenManager,this.toJSON())}_performRefresh(){return debugFail("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function assertStringOrUndefined(t,e){_assert(typeof t=="string"||typeof t=="undefined","internal-error",{appName:e})}class UserImpl{constructor(e){var{uid:r,auth:n,stsTokenManager:a}=e,o=__rest$2(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.emailVerified=!1,this.isAnonymous=!1,this.tenantId=null,this.providerData=[],this.proactiveRefresh=new ProactiveRefresh(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.metadata=new UserMetadata(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const r=await _logoutIfInvalidated(this,this.stsTokenManager.getToken(this.auth,e));return _assert(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return getIdTokenResult(this,e)}reload(){return reload(this)}_assign(e){this!==e&&(_assert(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new UserImpl(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){_assert(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await _reloadWithoutSaving(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await _logoutIfInvalidated(this,deleteAccount(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,a,o,s,i,d,g,l;const u=(n=r.displayName)!==null&&n!==void 0?n:void 0,m=(a=r.email)!==null&&a!==void 0?a:void 0,y=(o=r.phoneNumber)!==null&&o!==void 0?o:void 0,C=(s=r.photoURL)!==null&&s!==void 0?s:void 0,T=(i=r.tenantId)!==null&&i!==void 0?i:void 0,N=(d=r._redirectEventId)!==null&&d!==void 0?d:void 0,M=(g=r.createdAt)!==null&&g!==void 0?g:void 0,K=(l=r.lastLoginAt)!==null&&l!==void 0?l:void 0,{uid:R,emailVerified:S,isAnonymous:D,providerData:H,stsTokenManager:$}=r;_assert(R&&$,e,"internal-error");const z=StsTokenManager.fromJSON(this.name,$);_assert(typeof R=="string",e,"internal-error"),assertStringOrUndefined(u,e.name),assertStringOrUndefined(m,e.name),_assert(typeof S=="boolean",e,"internal-error"),_assert(typeof D=="boolean",e,"internal-error"),assertStringOrUndefined(y,e.name),assertStringOrUndefined(C,e.name),assertStringOrUndefined(T,e.name),assertStringOrUndefined(N,e.name),assertStringOrUndefined(M,e.name),assertStringOrUndefined(K,e.name);const U=new UserImpl({uid:R,auth:e,email:m,emailVerified:S,displayName:u,isAnonymous:D,photoURL:C,phoneNumber:y,tenantId:T,stsTokenManager:z,createdAt:M,lastLoginAt:K});return H&&Array.isArray(H)&&(U.providerData=H.map(Q=>Object.assign({},Q))),N&&(U._redirectEventId=N),U}static async _fromIdTokenResponse(e,r,n=!1){const a=new StsTokenManager;a.updateFromServerResponse(r);const o=new UserImpl({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:n});return await _reloadWithoutSaving(o),o}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class InMemoryPersistence{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}InMemoryPersistence.type="NONE";const inMemoryPersistence=InMemoryPersistence;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _persistenceKeyName(t,e,r){return`firebase:${t}:${e}:${r}`}class PersistenceUserManager{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:a,name:o}=this.auth;this.fullUserKey=_persistenceKeyName(this.userKey,a.apiKey,o),this.fullPersistenceKey=_persistenceKeyName("persistence",a.apiKey,o),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?UserImpl._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new PersistenceUserManager(_getInstance(inMemoryPersistence),e,n);const a=(await Promise.all(r.map(async g=>{if(await g._isAvailable())return g}))).filter(g=>g);let o=a[0]||_getInstance(inMemoryPersistence);const s=_persistenceKeyName(n,e.config.apiKey,e.name);let i=null;for(const g of r)try{const l=await g._get(s);if(l){const u=UserImpl._fromJSON(e,l);g!==o&&(i=u),o=g;break}}catch{}const d=a.filter(g=>g._shouldAllowMigration);return!o._shouldAllowMigration||!d.length?new PersistenceUserManager(o,e,n):(o=d[0],i&&await o._set(s,i.toJSON()),await Promise.all(r.map(async g=>{if(g!==o)try{await g._remove(s)}catch{}})),new PersistenceUserManager(o,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getBrowserName(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(_isIEMobile(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(_isFirefox(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(_isBlackBerry(e))return"Blackberry";if(_isWebOS(e))return"Webos";if(_isSafari(e))return"Safari";if((e.includes("chrome/")||_isChromeIOS(e))&&!e.includes("edge/"))return"Chrome";if(_isAndroid(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function _isFirefox(t=getUA()){return/firefox\//i.test(t)}function _isSafari(t=getUA()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function _isChromeIOS(t=getUA()){return/crios\//i.test(t)}function _isIEMobile(t=getUA()){return/iemobile/i.test(t)}function _isAndroid(t=getUA()){return/android/i.test(t)}function _isBlackBerry(t=getUA()){return/blackberry/i.test(t)}function _isWebOS(t=getUA()){return/webos/i.test(t)}function _isIOS(t=getUA()){return/iphone|ipad|ipod/i.test(t)}function _isIOSStandalone(t=getUA()){var e;return _isIOS(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function _isIE10(){return isIE()&&document.documentMode===10}function _isMobileBrowser(t=getUA()){return _isIOS(t)||_isAndroid(t)||_isWebOS(t)||_isBlackBerry(t)||/windows phone/i.test(t)||_isIEMobile(t)}function _isIframe(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getClientVersion(t,e=[]){let r;switch(t){case"Browser":r=_getBrowserName(getUA());break;case"Worker":r=`${_getBrowserName(getUA())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${SDK_VERSION}/${n}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthImpl{constructor(e,r){this.app=e,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Subscription(this),this.idTokenSubscription=new Subscription(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=_DEFAULT_AUTH_ERROR_FACTORY,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=_getInstance(r)),this._initializationPromise=this.queue(async()=>{var n;this._deleted||(this.persistenceManager=await PersistenceUserManager.create(this,e),!this._deleted&&(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively&&await this._popupRedirectResolver._initialize(this),await this.initializeCurrentUser(r),!this._deleted&&(this._isInitialized=!0)))}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e)}}async initializeCurrentUser(e){var r;let n=await this.assertedPersistence.getCurrentUser();if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=n==null?void 0:n._redirectEventId,s=await this.tryRedirectSignIn(e);(!a||a===o)&&(s==null?void 0:s.user)&&(n=s.user)}return n?n._redirectEventId?(_assert(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)):this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await _reloadWithoutSaving(e)}catch(r){if(r.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=_getUserLanguage()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const r=e?getModularInstance(e):null;return r&&_assert(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e){if(!this._deleted)return e&&_assert(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(_getInstance(e))})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ErrorFactory("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&_getInstance(e)||this._popupRedirectResolver;_assert(r,this,"argument-error"),this.redirectPersistenceManager=await PersistenceUserManager.create(this,[_getInstance(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,a){if(this._deleted)return()=>{};const o=typeof r=="function"?r:r.next.bind(r),s=this._isInitialized?Promise.resolve():this._initializationPromise;return _assert(s,this,"internal-error"),s.then(()=>o(this.currentUser)),typeof r=="function"?e.addObserver(r,n,a):e.addObserver(r)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&(this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh()),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return _assert(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=_getClientVersion(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getSdkClientVersion(){return this.clientVersion}}function _castAuth(t){return getModularInstance(t)}class Subscription{constructor(e){this.auth=e,this.observer=null,this.addObserver=createSubscribe(r=>this.observer=r)}get next(){return _assert(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthCredential{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return debugFail("not implemented")}_getIdTokenResponse(e){return debugFail("not implemented")}_linkToIdToken(e,r){return debugFail("not implemented")}_getReauthenticationResolver(e){return debugFail("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInWithIdp(t,e){return _performSignInRequest(t,"POST","/v1/accounts:signInWithIdp",_addTidIfNecessary(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IDP_REQUEST_URI$1="http://localhost";class OAuthCredential extends AuthCredential{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new OAuthCredential(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):_fail("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:a}=r,o=__rest$2(r,["providerId","signInMethod"]);if(!n||!a)return null;const s=new OAuthCredential(n,a);return Object.assign(s,o),s}_getIdTokenResponse(e){const r=this.buildRequest();return signInWithIdp(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,signInWithIdp(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,signInWithIdp(e,r)}buildRequest(){const e={requestUri:IDP_REQUEST_URI$1,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=querystring(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FederatedAuthProvider{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BaseOAuthProvider extends FederatedAuthProvider{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FacebookAuthProvider extends BaseOAuthProvider{constructor(){super("facebook.com")}static credential(e){return OAuthCredential._fromParams({providerId:FacebookAuthProvider.PROVIDER_ID,signInMethod:FacebookAuthProvider.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return FacebookAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return FacebookAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return FacebookAuthProvider.credential(e.oauthAccessToken)}catch{return null}}}FacebookAuthProvider.FACEBOOK_SIGN_IN_METHOD="facebook.com";FacebookAuthProvider.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GoogleAuthProvider extends BaseOAuthProvider{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return OAuthCredential._fromParams({providerId:GoogleAuthProvider.PROVIDER_ID,signInMethod:GoogleAuthProvider.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return GoogleAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return GoogleAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return GoogleAuthProvider.credential(r,n)}catch{return null}}}GoogleAuthProvider.GOOGLE_SIGN_IN_METHOD="google.com";GoogleAuthProvider.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GithubAuthProvider extends BaseOAuthProvider{constructor(){super("github.com")}static credential(e){return OAuthCredential._fromParams({providerId:GithubAuthProvider.PROVIDER_ID,signInMethod:GithubAuthProvider.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return GithubAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return GithubAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return GithubAuthProvider.credential(e.oauthAccessToken)}catch{return null}}}GithubAuthProvider.GITHUB_SIGN_IN_METHOD="github.com";GithubAuthProvider.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TwitterAuthProvider extends BaseOAuthProvider{constructor(){super("twitter.com")}static credential(e,r){return OAuthCredential._fromParams({providerId:TwitterAuthProvider.PROVIDER_ID,signInMethod:TwitterAuthProvider.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return TwitterAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return TwitterAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return TwitterAuthProvider.credential(r,n)}catch{return null}}}TwitterAuthProvider.TWITTER_SIGN_IN_METHOD="twitter.com";TwitterAuthProvider.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UserCredentialImpl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,a=!1){const o=await UserImpl._fromIdTokenResponse(e,n,a),s=providerIdForResponse(n);return new UserCredentialImpl({user:o,providerId:s,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const a=providerIdForResponse(n);return new UserCredentialImpl({user:e,providerId:a,_tokenResponse:n,operationType:r})}}function providerIdForResponse(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MultiFactorError extends FirebaseError{constructor(e,r,n,a){var o;super(r.code,r.message),this.operationType=n,this.user=a,this.name="FirebaseError",Object.setPrototypeOf(this,MultiFactorError.prototype),this.appName=e.name,this.code=r.code,this.tenantId=(o=e.tenantId)!==null&&o!==void 0?o:void 0,this.serverResponse=r.customData.serverResponse}static _fromErrorAndOperation(e,r,n,a){return new MultiFactorError(e,r,n,a)}}function _processCredentialSavingMfaContextIfNecessary(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?MultiFactorError._fromErrorAndOperation(t,o,e,n):o})}async function _link$1(t,e,r=!1){const n=await _logoutIfInvalidated(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return UserCredentialImpl._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _reauthenticate(t,e,r=!1){const{auth:n}=t,a="reauthenticate";try{const o=await _logoutIfInvalidated(t,_processCredentialSavingMfaContextIfNecessary(n,a,e,t),r);_assert(o.idToken,n,"internal-error");const s=_parseToken(o.idToken);_assert(s,n,"internal-error");const{sub:i}=s;return _assert(t.uid===i,n,"user-mismatch"),UserCredentialImpl._forOperation(t,a,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&_fail(n,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _signInWithCredential(t,e,r=!1){const n="signIn",a=await _processCredentialSavingMfaContextIfNecessary(t,n,e),o=await UserCredentialImpl._fromIdTokenResponse(t,n,a);return r||await t._updateCurrentUser(o.user),o}const STORAGE_AVAILABLE_KEY="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BrowserPersistenceClass{constructor(e,r){this.storage=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(STORAGE_AVAILABLE_KEY,"1"),this.storage.removeItem(STORAGE_AVAILABLE_KEY),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _iframeCannotSyncWebStorage(){const t=getUA();return _isSafari(t)||_isIOS(t)}const _POLLING_INTERVAL_MS$1=1e3,IE10_LOCAL_STORAGE_SYNC_DELAY=10;class BrowserLocalPersistence extends BrowserPersistenceClass{constructor(){super(window.localStorage,"LOCAL"),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=_iframeCannotSyncWebStorage()&&_isIframe(),this.fallbackToPolling=_isMobileBrowser(),this._shouldAllowMigration=!0,this.boundEventHandler=this.onStorageEvent.bind(this)}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),a=this.localCache[r];n!==a&&e(r,a,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((s,i,d)=>{this.notifyListeners(s,d)});return}const n=e.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const s=this.storage.getItem(n);if(e.newValue!==s)e.newValue!==null?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!r)return}const a=()=>{const s=this.storage.getItem(n);!r&&this.localCache[n]===s||this.notifyListeners(n,s)},o=this.storage.getItem(n);_isIE10()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,IE10_LOCAL_STORAGE_SYNC_DELAY):a()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},_POLLING_INTERVAL_MS$1)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}BrowserLocalPersistence.type="LOCAL";const browserLocalPersistence=BrowserLocalPersistence;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BrowserSessionPersistence extends BrowserPersistenceClass{constructor(){super(window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}BrowserSessionPersistence.type="SESSION";const browserSessionPersistence=BrowserSessionPersistence;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _allSettled(t){return Promise.all(t.map(async e=>{try{const r=await e;return{fulfilled:!0,value:r}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Receiver{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(a=>a.isListeningto(e));if(r)return r;const n=new Receiver(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:a,data:o}=r.data,s=this.handlersMap[a];if(!(s!=null&&s.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:a});const i=Array.from(s).map(async g=>g(r.origin,o)),d=await _allSettled(i);r.ports[0].postMessage({status:"done",eventId:n,eventType:a,response:d})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Receiver.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _generateEventId(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sender{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const a=typeof MessageChannel!="undefined"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let o,s;return new Promise((i,d)=>{const g=_generateEventId("",20);a.port1.start();const l=setTimeout(()=>{d(new Error("unsupported_event"))},n);s={messageChannel:a,onMessage(u){const m=u;if(m.data.eventId===g)switch(m.data.status){case"ack":clearTimeout(l),o=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),i(m.data.response);break;default:clearTimeout(l),clearTimeout(o),d(new Error("invalid_response"));break}}},this.handlers.add(s),a.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:g,data:r},[a.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _window(){return window}function _setWindowLocation(t){_window().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _isWorker(){return typeof _window().WorkerGlobalScope!="undefined"&&typeof _window().importScripts=="function"}async function _getActiveServiceWorker(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function _getServiceWorkerController(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function _getWorkerGlobalScope(){return _isWorker()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DB_NAME="firebaseLocalStorageDb",DB_VERSION=1,DB_OBJECTSTORE_NAME="firebaseLocalStorage",DB_DATA_KEYPATH="fbase_key";class DBPromise{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function getObjectStore(t,e){return t.transaction([DB_OBJECTSTORE_NAME],e?"readwrite":"readonly").objectStore(DB_OBJECTSTORE_NAME)}function _deleteDatabase(){const t=indexedDB.deleteDatabase(DB_NAME);return new DBPromise(t).toPromise()}function _openDatabase(){const t=indexedDB.open(DB_NAME,DB_VERSION);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(DB_OBJECTSTORE_NAME,{keyPath:DB_DATA_KEYPATH})}catch(a){r(a)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(DB_OBJECTSTORE_NAME)?e(n):(n.close(),await _deleteDatabase(),e(await _openDatabase()))})})}async function _putObject(t,e,r){const n=getObjectStore(t,!0).put({[DB_DATA_KEYPATH]:e,value:r});return new DBPromise(n).toPromise()}async function getObject(t,e){const r=getObjectStore(t,!1).get(e),n=await new DBPromise(r).toPromise();return n===void 0?null:n.value}function _deleteObject(t,e){const r=getObjectStore(t,!0).delete(e);return new DBPromise(r).toPromise()}const _POLLING_INTERVAL_MS=800,_TRANSACTION_RETRY_COUNT=3;class IndexedDBLocalPersistence{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await _openDatabase(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>_TRANSACTION_RETRY_COUNT)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return _isWorker()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Receiver._getInstance(_getWorkerGlobalScope()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await _getActiveServiceWorker(),!this.activeServiceWorker)return;this.sender=new Sender(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);!n||((e=n[0])===null||e===void 0?void 0:e.fulfilled)&&((r=n[0])===null||r===void 0?void 0:r.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||_getServiceWorkerController()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await _openDatabase();return await _putObject(e,STORAGE_AVAILABLE_KEY,"1"),await _deleteObject(e,STORAGE_AVAILABLE_KEY),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>_putObject(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>getObject(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>_deleteObject(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const o=getObjectStore(a,!1).getAll();return new DBPromise(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;for(const{fbase_key:a,value:o}of e)n.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(o)&&(this.notifyListeners(a,o),r.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!n.has(a)&&(this.notifyListeners(a,null),r.push(a));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),_POLLING_INTERVAL_MS)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}IndexedDBLocalPersistence.type="LOCAL";const indexedDBLocalPersistence=IndexedDBLocalPersistence;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getScriptParentElement(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function _loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=a=>{const o=_createError("internal-error");o.customData=a,r(o)},n.type="text/javascript",n.charset="UTF-8",getScriptParentElement().appendChild(n)})}function _generateCallbackName(t){return`__${t}${Math.floor(Math.random()*1e6)}`}new Delay(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _withDefaultResolver(t,e){return e?_getInstance(e):(_assert(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IdpCredential extends AuthCredential{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return signInWithIdp(e,this._buildIdpRequest())}_linkToIdToken(e,r){return signInWithIdp(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return signInWithIdp(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function _signIn(t){return _signInWithCredential(t.auth,new IdpCredential(t),t.bypassAuthState)}function _reauth(t){const{auth:e,user:r}=t;return _assert(r,e,"internal-error"),_reauthenticate(r,new IdpCredential(t),t.bypassAuthState)}async function _link(t){const{auth:e,user:r}=t;return _assert(r,e,"internal-error"),_link$1(r,new IdpCredential(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AbstractPopupRedirectOperation{constructor(e,r,n,a,o=!1){this.auth=e,this.resolver=n,this.user=a,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:a,tenantId:o,error:s,type:i}=e;if(s){this.reject(s);return}const d={auth:this.auth,requestUri:r,sessionId:n,tenantId:o||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(i)(d))}catch(g){this.reject(g)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return _signIn;case"linkViaPopup":case"linkViaRedirect":return _link;case"reauthViaPopup":case"reauthViaRedirect":return _reauth;default:_fail(this.auth,"internal-error")}}resolve(e){debugAssert(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){debugAssert(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _POLL_WINDOW_CLOSE_TIMEOUT=new Delay(2e3,1e4);class PopupOperation extends AbstractPopupRedirectOperation{constructor(e,r,n,a,o){super(e,r,a,o),this.provider=n,this.authWindow=null,this.pollId=null,PopupOperation.currentPopupAction&&PopupOperation.currentPopupAction.cancel(),PopupOperation.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return _assert(e,this.auth,"internal-error"),e}async onExecution(){debugAssert(this.filter.length===1,"Popup operations only handle one event");const e=_generateEventId();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(_createError(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(_createError(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,PopupOperation.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_createError(this.auth,"popup-closed-by-user"))},2e3);return}this.pollId=window.setTimeout(e,_POLL_WINDOW_CLOSE_TIMEOUT.get())};e()}}PopupOperation.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PENDING_REDIRECT_KEY="pendingRedirect",redirectOutcomeMap=new Map;class RedirectAction extends AbstractPopupRedirectOperation{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=redirectOutcomeMap.get(this.auth._key());if(!e){try{const n=await _getAndClearPendingRedirectStatus(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}redirectOutcomeMap.set(this.auth._key(),e)}return e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function _getAndClearPendingRedirectStatus(t,e){const r=pendingRedirectKey(e),n=await resolverPersistence(t)._get(r)==="true";return await resolverPersistence(t)._remove(r),n}function resolverPersistence(t){return _getInstance(t._redirectPersistence)}function pendingRedirectKey(t){return _persistenceKeyName(PENDING_REDIRECT_KEY,t.config.apiKey,t.name)}async function _getRedirectResult(t,e,r=!1){const n=_castAuth(t),a=_withDefaultResolver(n,e),s=await new RedirectAction(n,a,r).execute();return s&&!r&&(delete s.user._redirectEventId,await n._persistUserIfCurrent(s.user),await n._setRedirectUser(null,e)),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EVENT_DUPLICATION_CACHE_DURATION_MS=10*60*1e3;class AuthEventManager{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!isRedirectEvent(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!isNullRedirectEvent(e)){const a=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(_createError(this.auth,a))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=EVENT_DUPLICATION_CACHE_DURATION_MS&&this.cachedEventUids.clear(),this.cachedEventUids.has(eventUid(e))}saveEventToCache(e){this.cachedEventUids.add(eventUid(e)),this.lastProcessedEventTime=Date.now()}}function eventUid(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function isNullRedirectEvent({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function isRedirectEvent(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return isNullRedirectEvent(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _getProjectConfig(t,e={}){return _performApiRequest(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IP_ADDRESS_REGEX=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,HTTP_REGEX=/^https?/;async function _validateOrigin(t){if(t.config.emulator)return;const{authorizedDomains:e}=await _getProjectConfig(t);for(const r of e)try{if(matchDomain(r))return}catch{}_fail(t,"unauthorized-domain")}function matchDomain(t){const e=_getCurrentUrl(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const s=new URL(t);return s.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&s.hostname===n}if(!HTTP_REGEX.test(r))return!1;if(IP_ADDRESS_REGEX.test(t))return n===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NETWORK_TIMEOUT=new Delay(3e4,6e4);function resetUnloadedGapiModules(){const t=_window().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function loadGapi(t){return new Promise((e,r)=>{var n,a,o;function s(){resetUnloadedGapiModules(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{resetUnloadedGapiModules(),r(_createError(t,"network-request-failed"))},timeout:NETWORK_TIMEOUT.get()})}if(!((a=(n=_window().gapi)===null||n===void 0?void 0:n.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((o=_window().gapi)===null||o===void 0)&&o.load)s();else{const i=_generateCallbackName("iframefcb");return _window()[i]=()=>{gapi.load?s():r(_createError(t,"network-request-failed"))},_loadJS(`https://apis.google.com/js/api.js?onload=${i}`)}}).catch(e=>{throw cachedGApiLoader=null,e})}let cachedGApiLoader=null;function _loadGapi(t){return cachedGApiLoader=cachedGApiLoader||loadGapi(t),cachedGApiLoader}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PING_TIMEOUT=new Delay(5e3,15e3),IFRAME_PATH="__/auth/iframe",EMULATED_IFRAME_PATH="emulator/auth/iframe",IFRAME_ATTRIBUTES={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},EID_FROM_APIHOST=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function getIframeUrl(t){const e=t.config;_assert(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?_emulatorUrl(e,EMULATED_IFRAME_PATH):`https://${t.config.authDomain}/${IFRAME_PATH}`,n={apiKey:e.apiKey,appName:t.name,v:SDK_VERSION},a=EID_FROM_APIHOST.get(t.config.apiHost);a&&(n.eid=a);const o=t._getFrameworks();return o.length&&(n.fw=o.join(",")),`${r}?${querystring(n).slice(1)}`}async function _openIframe(t){const e=await _loadGapi(t),r=_window().gapi;return _assert(r,t,"internal-error"),e.open({where:document.body,url:getIframeUrl(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:IFRAME_ATTRIBUTES,dontclear:!0},n=>new Promise(async(a,o)=>{await n.restyle({setHideOnLeave:!1});const s=_createError(t,"network-request-failed"),i=_window().setTimeout(()=>{o(s)},PING_TIMEOUT.get());function d(){_window().clearTimeout(i),a(n)}n.ping(d).then(d,()=>{o(s)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BASE_POPUP_OPTIONS={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},DEFAULT_WIDTH=500,DEFAULT_HEIGHT=600,TARGET_BLANK="_blank",FIREFOX_EMPTY_URL="http://localhost";class AuthPopup{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function _open(t,e,r,n=DEFAULT_WIDTH,a=DEFAULT_HEIGHT){const o=Math.max((window.screen.availHeight-a)/2,0).toString(),s=Math.max((window.screen.availWidth-n)/2,0).toString();let i="";const d=Object.assign(Object.assign({},BASE_POPUP_OPTIONS),{width:n.toString(),height:a.toString(),top:o,left:s}),g=getUA().toLowerCase();r&&(i=_isChromeIOS(g)?TARGET_BLANK:r),_isFirefox(g)&&(e=e||FIREFOX_EMPTY_URL,d.scrollbars="yes");const l=Object.entries(d).reduce((m,[y,C])=>`${m}${y}=${C},`,"");if(_isIOSStandalone(g)&&i!=="_self")return openAsNewWindowIOS(e||"",i),new AuthPopup(null);const u=window.open(e||"",i,l);_assert(u,t,"popup-blocked");try{u.focus()}catch{}return new AuthPopup(u)}function openAsNewWindowIOS(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WIDGET_PATH="__/auth/handler",EMULATOR_WIDGET_PATH="emulator/auth/handler";function _getRedirectUrl(t,e,r,n,a,o){_assert(t.config.authDomain,t,"auth-domain-config-required"),_assert(t.config.apiKey,t,"invalid-api-key");const s={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:SDK_VERSION,eventId:a};if(e instanceof FederatedAuthProvider){e.setDefaultLanguage(t.languageCode),s.providerId=e.providerId||"",isEmpty(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,g]of Object.entries(o||{}))s[d]=g}if(e instanceof BaseOAuthProvider){const d=e.getScopes().filter(g=>g!=="");d.length>0&&(s.scopes=d.join(","))}t.tenantId&&(s.tid=t.tenantId);const i=s;for(const d of Object.keys(i))i[d]===void 0&&delete i[d];return`${getHandlerBase(t)}?${querystring(i).slice(1)}`}function getHandlerBase({config:t}){return t.emulator?_emulatorUrl(t,EMULATOR_WIDGET_PATH):`https://${t.authDomain}/${WIDGET_PATH}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WEB_STORAGE_SUPPORT_KEY="webStorageSupport";class BrowserPopupRedirectResolver{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=browserSessionPersistence,this._completeRedirectFn=_getRedirectResult}async _openPopup(e,r,n,a){var o;debugAssert((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const s=_getRedirectUrl(e,r,n,_getCurrentUrl(),a);return _open(e,s,_generateEventId())}async _openRedirect(e,r,n,a){return await this._originValidation(e),_setWindowLocation(_getRedirectUrl(e,r,n,_getCurrentUrl(),a)),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:a,promise:o}=this.eventManagers[r];return a?Promise.resolve(a):(debugAssert(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n}async initAndGetManager(e){const r=await _openIframe(e),n=new AuthEventManager(e);return r.register("authEvent",a=>(_assert(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:n.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(WEB_STORAGE_SUPPORT_KEY,{type:WEB_STORAGE_SUPPORT_KEY},a=>{var o;const s=(o=a==null?void 0:a[0])===null||o===void 0?void 0:o[WEB_STORAGE_SUPPORT_KEY];s!==void 0&&r(!!s),_fail(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=_validateOrigin(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return _isMobileBrowser()||_isSafari()||_isIOS()}}const browserPopupRedirectResolver=BrowserPopupRedirectResolver;var name="@firebase/auth",version="0.17.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthInterop{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{var a;e(((a=n)===null||a===void 0?void 0:a.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);!r||(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){_assert(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getVersionForPlatform(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function registerAuth(t){_registerComponent(new Component("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),{apiKey:a,authDomain:o}=n.options;return(s=>{_assert(a&&!a.includes(":"),"invalid-api-key",{appName:s.name}),_assert(!(o!=null&&o.includes(":")),"argument-error",{appName:s.name});const i={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_getClientVersion(t)},d=new AuthImpl(s,i);return _initializeAuthInstance(d,r),d})(n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),_registerComponent(new Component("auth-internal",e=>{const r=_castAuth(e.getProvider("auth").getImmediate());return(n=>new AuthInterop(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),registerVersion(name,version,getVersionForPlatform(t))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getAuth(t=getApp()){const e=_getProvider(t,"auth");return e.isInitialized()?e.getImmediate():initializeAuth(t,{popupRedirectResolver:browserPopupRedirectResolver,persistence:[indexedDBLocalPersistence,browserLocalPersistence,browserSessionPersistence]})}registerAuth("Browser");function getCurrentUser(t){try{const e=getCurrentUserSync(t);return Promise.resolve(e)}catch(e){return Promise.reject(e)}}function getCurrentUserSync(t){return getOrInitUserDAO(t).getCurrentUser()}class FirebaseAuthUserDAO{constructor(e){this.auth=getAuth(e)}getCurrentUser(){var e;const r=(e=this.auth.currentUser)===null||e===void 0?void 0:e.uid;if(!r)throw new StripePaymentsError("unauthenticated","Failed to determine currently signed in user. User not signed in.");return r}}const USER_DAO_KEY="user-dao";function getOrInitUserDAO(t){let e=t.getComponent(USER_DAO_KEY);return e||(e=new FirebaseAuthUserDAO(t.app),setUserDAO(t,e)),e}function setUserDAO(t,e){t.setComponent(USER_DAO_KEY,e)}function checkNonEmptyString(t,e){if(typeof t!="string"||t==="")throw new Error(e!=null?e:"arg must be a non-empty string.")}function checkPositiveNumber(t,e){if(typeof t!="number"||isNaN(t)||t<=0)throw new Error(e!=null?e:"arg must be positive number.")}function checkNonEmptyArray(t,e){if(!Array.isArray(t)||t.length===0)throw new Error(e!=null?e:"arg must be a non-empty array.")}var __awaiter$2=globalThis&&globalThis.__awaiter||function(t,e,r,n){function a(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function i(l){try{g(n.next(l))}catch(u){s(u)}}function d(l){try{g(n.throw(l))}catch(u){s(u)}}function g(l){l.done?o(l.value):a(l.value).then(i,d)}g((n=n.apply(t,e||[])).next())})},__rest$1=globalThis&&globalThis.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(r[n[a]]=t[n[a]]);return r};function hasLineItems(t){return"line_items"in t}const CREATE_SESSION_TIMEOUT_MILLIS=30*1e3;function createCheckoutSession(t,e,r){e=Object.assign({},e),checkAndUpdateCommonParams(e),hasLineItems(e)?checkLineItemParams(e):checkPriceIdParams(e);const n=getTimeoutMillis(r==null?void 0:r.timeoutMillis);return getCurrentUser(t).then(a=>getOrInitSessionDAO(t).createCheckoutSession(a,e,n))}function checkAndUpdateCommonParams(t){var e;typeof t.cancel_url!="undefined"?checkNonEmptyString(t.cancel_url,"cancel_url must be a non-empty string."):t.cancel_url=window.location.href,(e=t.mode)!==null&&e!==void 0||(t.mode="subscription"),typeof t.success_url!="undefined"?checkNonEmptyString(t.success_url,"success_url must be a non-empty string."):t.success_url=window.location.href}function checkLineItemParams(t){checkNonEmptyArray(t.line_items,"line_items must be a non-empty array.")}function checkPriceIdParams(t){checkNonEmptyString(t.price,"price must be a non-empty string."),typeof t.quantity!="undefined"&&checkPositiveNumber(t.quantity,"quantity must be a positive integer.")}function getTimeoutMillis(t){return typeof t!="undefined"?(checkPositiveNumber(t,"timeoutMillis must be a positive number."),t):CREATE_SESSION_TIMEOUT_MILLIS}class FirestoreSessionDAO{constructor(e,r){this.customersCollection=r,this.firestore=wh(e)}createCheckoutSession(e,r,n){return __awaiter$2(this,void 0,void 0,function*(){const a=yield this.addSessionDoc(e,r);return this.waitForSessionId(a,n)})}addSessionDoc(e,r){return __awaiter$2(this,void 0,void 0,function*(){const n=sh(this.firestore,this.customersCollection,e,"checkout_sessions");try{return yield uf(n,r)}catch(a){throw new StripePaymentsError("internal","Error while querying Firestore.",a)}})}waitForSessionId(e,r){let n;return new Promise((a,o)=>{const s=setTimeout(()=>{o(new StripePaymentsError("deadline-exceeded","Timeout while waiting for session response."))},r);n=cf(e.withConverter(SESSION_CONVERTER),i=>{const d=i.data();hasSessionId(d)&&(clearTimeout(s),a(d))},i=>{clearTimeout(s),o(new StripePaymentsError("internal","Error while querying Firestore.",i))})}).finally(()=>n())}}function hasSessionId(t){return typeof(t==null?void 0:t.id)!="undefined"}const SESSION_CONVERTER={toFirestore:()=>{throw new Error("Not implemented for readonly Session type.")},fromFirestore:t=>{const e=t.data(),{created:r,sessionId:n}=e,a=__rest$1(e,["created","sessionId"]);return typeof n!="undefined"?Object.assign(Object.assign({},a),{id:n,created_at:toUTCDateString$1(r)}):Object.assign({},a)}};function toUTCDateString$1(t){return t.toDate().toUTCString()}const SESSION_DAO_KEY="checkout-session-dao";function getOrInitSessionDAO(t){let e=t.getComponent(SESSION_DAO_KEY);return e||(e=new FirestoreSessionDAO(t.app,t.customersCollection),setSessionDAO(t,e)),e}function setSessionDAO(t,e){t.setComponent(SESSION_DAO_KEY,e)}globalThis&&globalThis.__awaiter;var __awaiter$1=globalThis&&globalThis.__awaiter||function(t,e,r,n){function a(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function i(l){try{g(n.next(l))}catch(u){s(u)}}function d(l){try{g(n.throw(l))}catch(u){s(u)}}function g(l){l.done?o(l.value):a(l.value).then(i,d)}g((n=n.apply(t,e||[])).next())})},__rest=globalThis&&globalThis.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)e.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(r[n[a]]=t[n[a]]);return r};function getProducts(t,e){const r=getOrInitProductDAO(t),n=e!=null?e:{},{includePrices:a}=n,o=__rest(n,["includePrices"]);return r.getProducts(o).then(s=>{if(a){const i=s.map(d=>getProductWithPrices(r,d));return Promise.all(i)}return s})}function getProductWithPrices(t,e){return __awaiter$1(this,void 0,void 0,function*(){const r=yield t.getPrices(e.id);return Object.assign(Object.assign({},e),{prices:r})})}const PRODUCT_CONVERTER={toFirestore:()=>{throw new Error("Not implemented for readonly Product type.")},fromFirestore:t=>Object.assign(Object.assign({},t.data()),{id:t.id,prices:[]})},PRICE_CONVERTER={toFirestore:()=>{throw new Error("Not implemented for readonly Price type.")},fromFirestore:t=>{const e=t.data();return Object.assign(Object.assign({},e),{id:t.id,product:t.ref.parent.parent.id})}};class FirestoreProductDAO{constructor(e,r){this.productsCollection=r,this.firestore=wh(e)}getProduct(e){return __awaiter$1(this,void 0,void 0,function*(){return(yield this.getProductSnapshotIfExists(e)).data()})}getProducts(e){return __awaiter$1(this,void 0,void 0,function*(){const r=yield this.getProductSnapshots(e),n=[];return r.forEach(a=>{n.push(a.data())}),n})}getPrice(e,r){return __awaiter$1(this,void 0,void 0,function*(){return(yield this.getPriceSnapshotIfExists(e,r)).data()})}getPrices(e,r){return __awaiter$1(this,void 0,void 0,function*(){r!=null&&r.assertProduct&&(yield this.getProductSnapshotIfExists(e));const n=yield this.getPriceSnapshots(e),a=[];return n.forEach(o=>{a.push(o.data())}),a})}getProductSnapshotIfExists(e){return __awaiter$1(this,void 0,void 0,function*(){const r=rh(this.firestore,this.productsCollection,e).withConverter(PRODUCT_CONVERTER),n=yield this.queryFirestore(()=>Jl(r));if(!n.exists())throw new StripePaymentsError("not-found",`No product found with the ID: ${e}`);return n})}getProductSnapshots(e){return __awaiter$1(this,void 0,void 0,function*(){let r=sh(this.firestore,this.productsCollection).withConverter(PRODUCT_CONVERTER);const n=[];if(e!=null&&e.activeOnly&&n.push(_l("active","==",!0)),e!=null&&e.where)for(const a of e.where)n.push(_l(...a));return typeof(e==null?void 0:e.limit)!="undefined"&&n.push(El(e.limit)),yield this.queryFirestore(()=>(n.length>0&&(r=dl(r,...n)),tf(r)))})}getPriceSnapshotIfExists(e,r){return __awaiter$1(this,void 0,void 0,function*(){const n=rh(this.firestore,this.productsCollection,e,"prices",r).withConverter(PRICE_CONVERTER),a=yield this.queryFirestore(()=>Jl(n));if(!a.exists())throw new StripePaymentsError("not-found",`No price found with the product ID: ${e} and price ID: ${r}`);return a})}getPriceSnapshots(e){return __awaiter$1(this,void 0,void 0,function*(){const r=sh(this.firestore,this.productsCollection,e,"prices").withConverter(PRICE_CONVERTER);return yield this.queryFirestore(()=>tf(r))})}queryFirestore(e){return __awaiter$1(this,void 0,void 0,function*(){try{return yield e()}catch(r){throw new StripePaymentsError("internal","Unexpected error while querying Firestore",r)}})}}const PRODUCT_DAO_KEY="product-dao";function getOrInitProductDAO(t){let e=t.getComponent(PRODUCT_DAO_KEY);return e||(e=new FirestoreProductDAO(t.app,t.productsCollection),setProductDAO(t,e)),e}function setProductDAO(t,e){t.setComponent(PRODUCT_DAO_KEY,e)}var __awaiter=globalThis&&globalThis.__awaiter||function(t,e,r,n){function a(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function i(l){try{g(n.next(l))}catch(u){s(u)}}function d(l){try{g(n.throw(l))}catch(u){s(u)}}function g(l){l.done?o(l.value):a(l.value).then(i,d)}g((n=n.apply(t,e||[])).next())})};function onCurrentUserSubscriptionUpdate(t,e,r){const n=getCurrentUserSync(t);return getOrInitSubscriptionDAO(t).onSubscriptionUpdate(n,e,r)}const SUBSCRIPTION_CONVERTER={toFirestore:()=>{throw new Error("Not implemented for readonly Subscription type.")},fromFirestore:t=>{var e,r,n;const a=t.data(),s=a.prices.map(i=>({product:i.parent.parent.id,price:i.id}));return{cancel_at:toNullableUTCDateString(a.cancel_at),cancel_at_period_end:a.cancel_at_period_end,canceled_at:toNullableUTCDateString(a.canceled_at),created:toUTCDateString(a.created),current_period_start:toUTCDateString(a.current_period_start),current_period_end:toUTCDateString(a.current_period_end),ended_at:toNullableUTCDateString(a.ended_at),id:t.id,metadata:(e=a.metadata)!==null&&e!==void 0?e:{},price:a.price.id,prices:s,product:a.product.id,quantity:(r=a.quantity)!==null&&r!==void 0?r:null,role:(n=a.role)!==null&&n!==void 0?n:null,status:a.status,stripe_link:a.stripeLink,trial_end:toNullableUTCDateString(a.trial_end),trial_start:toNullableUTCDateString(a.trial_start),uid:t.ref.parent.parent.id}}},SUBSCRIPTIONS_COLLECTION="subscriptions";function toNullableUTCDateString(t){return t===null?null:toUTCDateString(t)}function toUTCDateString(t){return t.toDate().toUTCString()}class FirestoreSubscriptionDAO{constructor(e,r){this.customersCollection=r,this.firestore=wh(e)}getSubscription(e,r){return __awaiter(this,void 0,void 0,function*(){return(yield this.getSubscriptionSnapshotIfExists(e,r)).data()})}getSubscriptions(e,r){return __awaiter(this,void 0,void 0,function*(){const n=yield this.getSubscriptionSnapshots(e,r==null?void 0:r.status),a=[];return n.forEach(o=>{a.push(o.data())}),a})}onSubscriptionUpdate(e,r,n){const a=sh(this.firestore,this.customersCollection,e,SUBSCRIPTIONS_COLLECTION).withConverter(SUBSCRIPTION_CONVERTER);return cf(a,o=>{const s={subscriptions:[],changes:[],size:o.size,empty:o.empty};o.forEach(i=>{s.subscriptions.push(i.data())}),o.docChanges().forEach(i=>{s.changes.push({type:i.type,subscription:i.doc.data()})}),r(s)},o=>{if(n){const s=new StripePaymentsError("internal",`Error while listening to database updates: ${o.message}`,o);n(s)}})}getSubscriptionSnapshotIfExists(e,r){return __awaiter(this,void 0,void 0,function*(){const n=rh(this.firestore,this.customersCollection,e,SUBSCRIPTIONS_COLLECTION,r).withConverter(SUBSCRIPTION_CONVERTER),a=yield this.queryFirestore(()=>Jl(n));if(!a.exists())throw new StripePaymentsError("not-found",`No subscription found with the ID: ${r} for user: ${e}`);return a})}getSubscriptionSnapshots(e,r){return __awaiter(this,void 0,void 0,function*(){let n=sh(this.firestore,this.customersCollection,e,SUBSCRIPTIONS_COLLECTION).withConverter(SUBSCRIPTION_CONVERTER);return r&&(n=dl(n,_l("status","in",r))),yield this.queryFirestore(()=>tf(n))})}queryFirestore(e){return __awaiter(this,void 0,void 0,function*(){try{return yield e()}catch(r){throw new StripePaymentsError("internal","Unexpected error while querying Firestore",r)}})}}const SUBSCRIPTION_DAO_KEY="subscription-dao";function getOrInitSubscriptionDAO(t){let e=t.getComponent(SUBSCRIPTION_DAO_KEY);return e||(e=new FirestoreSubscriptionDAO(t.app,t.customersCollection),setSubscriptionDAO(t,e)),e}function setSubscriptionDAO(t,e){t.setComponent(SUBSCRIPTION_DAO_KEY,e)}let stripe;const _sfc_main$2=defineComponent({name:"PreferencesComponent",setup(){return{store:useStore(),dark:ref(Plugin$1.isActive),promptFontSize:ref(!1),showText:ref(!0)}},mounted(){this.loadStripe()},methods:{async portalCB(){const t="https://billing.stripe.com/p/login/eVa6qm5sSahl7tudQQ";console.log(t),window.open(t,"_blank")},async subscribeCB(){const t=getApp$1(),e=getStripePayments(t,{productsCollection:"products",customersCollection:"customers"});console.log("payments",e);const r=await getProducts(e,{includePrices:!0,activeOnly:!0});for(const o of r)console.log("product",o);const a=await createCheckoutSession(e,{line_items:[{price:"price_1N13y4CCcfiyKH9aXtwGNBan",quantity:"1"}],api_key:"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",fooey:"kablooey",success_url:"https://www.readingedge.org/#/thankyou",cancel_url:"https://www.readingedge.org/#/"});console.log("session",a),console.log(a.url),onCurrentUserSubscriptionUpdate(e,o=>{for(const s in o.changes)s.type==="added"&&console.log(`New subscription added with ID: ${s.subscription.id}`)}),window.location.assign(a.url)},async loadStripe(){stripe=await loadStripe("pk_live_51Myi4CCCcfiyKH9aWeeCgtfqmR7HpOnLE9oDJn1lRbOSkfwxNsnLEfTRS8lHzdM8UNJ9O0IshKAThgnBdjcZosyC00oSLNm68T"),console.log("stripe",stripe)},toggleText(){console.log("toggleText",this.showText),this.showText===!0?(console.log("showing text"),selectAll(".assignment").classed("hidden",!1),selectAll(".q-carousel__thumbnail").classed("hidden",!1)):(console.log("hiding text"),selectAll(".assignment").classed("hidden",!0),selectAll(".q-carousel__thumbnail").classed("hidden",!0))},toggleDark(){Plugin$1.toggle(),console.log(Plugin$1.isActive,this.dark),Plugin$1.isActive},fontSizeCB(t){selectAll("#sampleFontSwatch").style("font-size",t+"pt"),selectAll("#slideTextDiv").style("font-size",t+"pt"),this.store.userSnapshot.preferences.pageFontSize=t},fsCB(){Plugin$2.isActive?Plugin$2.exit().then(()=>{}).catch(t=>{console.log(t)}):Plugin$2.request().then(()=>{}).catch(t=>{console.log(t)})}}}),_hoisted_1$2={class:"q-pa-md",style:{"max-width":"350px"}},_hoisted_2$2={class:"text-center q-mt-md",style:{width:"100%"}},_hoisted_3$2=createBaseVNode("br",null,null,-1),_hoisted_4$2={key:0},_hoisted_5$2=createBaseVNode("br",null,null,-1),_hoisted_6$2=createBaseVNode("span",{class:"text-yellow"},"Thank You!",-1),_hoisted_7$2=[_hoisted_5$2,_hoisted_6$2],_hoisted_8$2={class:"text-center q-mt-md",style:{width:"100%"}},_hoisted_9$2=createBaseVNode("br",null,null,-1),_hoisted_10$2={class:"full-width"},_hoisted_11$1=createBaseVNode("tr",{class:"bg-primary"},[createBaseVNode("th",{colSpan:"2"},"Subscribed Quotas")],-1),_hoisted_12$1=createBaseVNode("tr",null,[createBaseVNode("td",null,"bookmark"),createBaseVNode("td",null,"100")],-1),_hoisted_13$1=createBaseVNode("tr",null,[createBaseVNode("td",null,"image"),createBaseVNode("td",null,"100")],-1),_hoisted_14=createBaseVNode("tr",null,[createBaseVNode("td",null,"page"),createBaseVNode("td",null,"50")],-1),_hoisted_15=createBaseVNode("tr",null,[createBaseVNode("td",null,"assignment"),createBaseVNode("td",null,"30")],-1),_hoisted_16=createBaseVNode("tr",null,[createBaseVNode("td",null,"course"),createBaseVNode("td",null,"10")],-1),_hoisted_17=createBaseVNode("tr",null,[createBaseVNode("td",null,"enrollment"),createBaseVNode("td",null,"30")],-1),_hoisted_18=createBaseVNode("tr",{class:"bg-grey"},[createBaseVNode("th",{colSpan:"2"},"Free quotas")],-1),_hoisted_19=createBaseVNode("tr",null,[createBaseVNode("td",null,"bookmark"),createBaseVNode("td",null,"10")],-1),_hoisted_20=createBaseVNode("tr",null,[createBaseVNode("td",null,"image"),createBaseVNode("td",null,"10")],-1),_hoisted_21=createBaseVNode("tr",null,[createBaseVNode("td",null,"page"),createBaseVNode("td",null,"10")],-1),_hoisted_22=createBaseVNode("tr",null,[createBaseVNode("td",null,"assignment"),createBaseVNode("td",null,"2")],-1),_hoisted_23=createBaseVNode("tr",null,[createBaseVNode("td",null,"course"),createBaseVNode("td",null,"2")],-1),_hoisted_24=createBaseVNode("tr",null,[createBaseVNode("td",null,"enrollment"),createBaseVNode("td",null,"2")],-1);function _sfc_render$2(t,e,r,n,a,o){return openBlock(),createElementBlock("div",_hoisted_1$2,[createVNode(QList,{bordered:"",class:"rounded-borders",icon:"gear"},{default:withCtx(()=>[createVNode(QExpansionItem,{label:"Profile"},{default:withCtx(()=>[createBaseVNode("div",_hoisted_2$2,[createTextVNode(toDisplayString(this.store.userSnapshot.profile.name)+" ",1),_hoisted_3$2,createTextVNode(" "+toDisplayString(this.store.userSnapshot.profile.email)+" ",1),this.store.subscribed?(openBlock(),createElementBlock("span",_hoisted_4$2,_hoisted_7$2)):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_8$2,[this.store.subscribed===1?(openBlock(),createBlock(QBtn,{key:0,"no-caps":"",onClick:e[0]||(e[0]=s=>this.portalCB())},{default:withCtx(()=>[createTextVNode("Manage Subscription")]),_:1})):(openBlock(),createBlock(QBtn,{key:1,"no-caps":"",class:"bg-primary",onClick:e[1]||(e[1]=s=>this.subscribeCB())},{default:withCtx(()=>[createTextVNode("Subscribe")]),_:1}))]),_hoisted_9$2,createBaseVNode("div",_hoisted_10$2,[createVNode(QMarkupTable,null,{default:withCtx(()=>[_hoisted_11$1,_hoisted_12$1,_hoisted_13$1,_hoisted_14,_hoisted_15,_hoisted_16,_hoisted_17,_hoisted_18,_hoisted_19,_hoisted_20,_hoisted_21,_hoisted_22,_hoisted_23,_hoisted_24]),_:1})])]),_:1})]),_:1})])}var ProfileComponent=_export_sfc(_sfc_main$2,[["render",_sfc_render$2]]);const _sfc_main$1=defineComponent({name:"AboutComponent",setup(){return{}},mounted(){},methods:{}}),_hoisted_1$1={class:"q-pa-md",style:{"max-width":"350px"}},_hoisted_2$1={class:"q-mx-md q-mt-md"},_hoisted_3$1=createBaseVNode("div",{class:"text-center text-white"},[createTextVNode(" Try also"),createBaseVNode("br"),createBaseVNode("a",{class:"text-orange",target:"_blank",href:"https://ccosse.github.io/TuxMathScrabble-2015"},"TuxMathScrabble"),createTextVNode(" & "),createBaseVNode("a",{class:"text-blue",target:"_blank",href:"https://ccosse.github.io/colormyworld"},"ColorMyWorld")],-1),_hoisted_4$1=createBaseVNode("a",{class:"text-blue",target:"_blank",href:"https://github.com/ccosse/ccosse.github.io#readme"}," more ...",-1),_hoisted_5$1={class:"text-center q-mt-md",style:{width:"100%"}},_hoisted_6$1=createBaseVNode("a",{class:"text-grey",target:"_blank",href:"https://readingedgeca.s3.us-west-1.amazonaws.com/static/pub/img/Terms+of+use.pdf"},"Terms of Service",-1),_hoisted_7$1=createBaseVNode("br",null,null,-1),_hoisted_8$1=createBaseVNode("a",{class:"text-grey",target:"_blank",href:"https://readingedgeca.s3.us-west-1.amazonaws.com/static/pub/img/Privacy+policy.pdf"},"Privacy Policy",-1),_hoisted_9$1=createBaseVNode("br",null,null,-1),_hoisted_10$1=createBaseVNode("div",{class:"full-width"},null,-1);function _sfc_render$1(t,e,r,n,a,o){const s=resolveComponent("center");return openBlock(),createElementBlock("div",_hoisted_1$1,[createVNode(QList,{bordered:"",class:"rounded-borders",icon:"gear"},{default:withCtx(()=>[createVNode(QExpansionItem,{label:"About"},{default:withCtx(()=>[createVNode(QCard,{class:"full-width"},{default:withCtx(()=>[createBaseVNode("div",_hoisted_2$1,[createVNode(QImg,{src:"https://readingedgeca.s3.us-west-1.amazonaws.com/static/pub/img/asymptopia-logo.png"})]),_hoisted_3$1]),_:1}),createVNode(QCard,{class:"q-px-md q-pt-md text-justify"},{default:withCtx(()=>[createTextVNode(" Reading Edge is built around the APIs for Wikipedia and speak-tts, with Google voices. Reading Edge only stores the text passages and links to external resources. Reading Edge is built with the following software and packages: Vue.js, Quasar, speak-tts Wikipedia vue-confetti-explosion Flag-icons Google Material Icons "),_hoisted_4$1]),_:1}),createBaseVNode("div",_hoisted_5$1,[createVNode(s,null,{default:withCtx(()=>[_hoisted_6$1,_hoisted_7$1,_hoisted_8$1]),_:1})]),_hoisted_9$1,_hoisted_10$1]),_:1})]),_:1})])}var AboutComponent=_export_sfc(_sfc_main$1,[["render",_sfc_render$1]]);const _sfc_main=defineComponent({name:"CoursesLayout",components:{CoursePager,WPComponent,PreferencesComponent,ProfileComponent,AssignmentPager,PagePager,ImagePager,AboutComponent},setup(){const t=ref(!1),e=ref(!1);return{store:useStore(),courseKey:ref(null),promptEnroll:ref(!1),leftDrawerOpen:t,toggleLeftDrawer(){t.value=!t.value},rightDrawerOpen:e,toggleRightDrawer(){e.value=!e.value}}},mounted(){Plugin$1.isActive,this.store.initSpeech()},methods:{goBack(){if(this.store.pgIdx!==null&&this.store.pgIdx>-1){this.store.pgIdx=null,this.store.imgIdx=null,this.store.router.replace("/courses/assignments");return}else if(this.store.aid!==null&&this.store.aid!==-1){this.store.aid=null,this.store.imgIdx=null,this.store.router.replace("/courses");return}else this.store.ck!==null&&(this.store.ck=null,this.store.aid=null,this.store.pgIdx=null,this.store.imgIdx=null);this.store.router.replace("/courses")},enrollCB(){const t=this.store.enroll(this.courseKey);console.log(t)}}}),_hoisted_1=createBaseVNode("div",{class:"text-h6"},"Enter a course-key",-1),_hoisted_2={key:0},_hoisted_3={key:1},_hoisted_4={key:2},_hoisted_5={key:3},_hoisted_6=createBaseVNode("br",null,null,-1),_hoisted_7={key:0},_hoisted_8={key:1},_hoisted_9=createBaseVNode("div",{class:"text-panel q-ma-md text-center text-h6"},"App Sections",-1),_hoisted_10={key:0},_hoisted_11={key:1},_hoisted_12={key:2},_hoisted_13={key:3};function _sfc_render(t,e,r,n,a,o){const s=resolveComponent("WPComponent"),i=resolveComponent("PreferencesComponent"),d=resolveComponent("ProfileComponent"),g=resolveComponent("AboutComponent"),l=resolveComponent("ImagePager"),u=resolveComponent("PagePager"),m=resolveComponent("AssignmentPager"),y=resolveComponent("CoursePager"),C=resolveComponent("router-view");return openBlock(),createElementBlock(Fragment,null,[createVNode(QDialog,{modelValue:t.promptEnroll,"onUpdate:modelValue":e[3]||(e[3]=T=>t.promptEnroll=T),persistent:""},{default:withCtx(()=>[createVNode(QCard,{style:{"min-width":"350px"}},{default:withCtx(()=>[createVNode(QCardSection,null,{default:withCtx(()=>[_hoisted_1]),_:1}),createVNode(QCardSection,{class:"q-pt-none"},{default:withCtx(()=>[createVNode(QInput,{dense:"",modelValue:t.courseKey,"onUpdate:modelValue":e[0]||(e[0]=T=>t.courseKey=T),autofocus:"",onKeyup:e[1]||(e[1]=withKeys(T=>{t.prompt=!1,this.enrollCB()},["enter"]))},null,8,["modelValue"])]),_:1}),createVNode(QCardActions,{align:"right",class:"text-white"},{default:withCtx(()=>[withDirectives(createVNode(QBtn,{flat:"",label:"Cancel"},null,512),[[ClosePopup]]),withDirectives(createVNode(QBtn,{flat:"",label:"Enroll",onClick:e[2]||(e[2]=T=>this.enrollCB())},null,512),[[ClosePopup]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),createVNode(QLayout,{view:"hHh lpR fFf"},{default:withCtx(()=>[createVNode(QHeader,{bordered:"",class:"bg-positive text-white"},{default:withCtx(()=>[createVNode(QToolbar,null,{default:withCtx(()=>[createVNode(QBtn,{flat:"",round:"",icon:"menu",onClick:t.toggleLeftDrawer},null,8,["onClick"]),createVNode(QSpace),this.store.ck!==null?(openBlock(),createBlock(QBtn,{key:0,flat:"",round:"",icon:"north",onClick:e[4]||(e[4]=T=>this.goBack())},{default:withCtx(()=>[createVNode(QTooltip,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:withCtx(()=>[createVNode(QCard,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:withCtx(()=>[createTextVNode(" Go back to "),this.store.ck!==null&&this.store.aid===null?(openBlock(),createElementBlock("span",_hoisted_2,"Home")):this.store.aid!==null&&this.store.pgIdx===null?(openBlock(),createElementBlock("span",_hoisted_3,"Courses")):this.store.pgIdx!==null?(openBlock(),createElementBlock("span",_hoisted_4,"Assignments")):(openBlock(),createElementBlock("span",_hoisted_5,"Pages"))]),_:1})]),_:1})]),_:1})):createCommentVNode("",!0),createVNode(QSpace),this.store.role==="student"?(openBlock(),createBlock(QBtn,{key:1,flat:"",round:"",class:"on-left",icon:"group_add",onClick:e[5]||(e[5]=T=>t.promptEnroll=!0)},{default:withCtx(()=>[createVNode(QTooltip,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:withCtx(()=>[createVNode(QCard,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:withCtx(()=>[createTextVNode(" Have a course-key? Enter it here"),_hoisted_6,createTextVNode("to join your course. ")]),_:1})]),_:1})]),_:1})):createCommentVNode("",!0),this.store.authenticated?(openBlock(),createBlock(QBtn,{key:2,flat:"",round:"",icon:"switch_account",onClick:e[6]||(e[6]=T=>this.store.switchRole())},{default:withCtx(()=>[createVNode(QTooltip,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:withCtx(()=>[createVNode(QCard,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:withCtx(()=>[createTextVNode(" Switch to "),this.store.role==="student"?(openBlock(),createElementBlock("span",_hoisted_7,"Teacher")):(openBlock(),createElementBlock("span",_hoisted_8,"Student")),createTextVNode(" role ")]),_:1})]),_:1})]),_:1})):createCommentVNode("",!0),createVNode(QBtn,{flat:"",round:"",icon:"logout",onClick:e[7]||(e[7]=T=>this.store.logout())},{default:withCtx(()=>[createVNode(QTooltip,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:withCtx(()=>[createVNode(QCard,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:withCtx(()=>[createTextVNode(" Logout ")]),_:1})]),_:1})]),_:1}),createVNode(QBtn,{flat:"",round:"",icon:"menu",onClick:t.toggleRightDrawer},null,8,["onClick"])]),_:1})]),_:1}),createVNode(QDrawer,{"show-if-above":"",modelValue:t.leftDrawerOpen,"onUpdate:modelValue":e[8]||(e[8]=T=>t.leftDrawerOpen=T),side:"left",bordered:""},{default:withCtx(()=>[_hoisted_9,createVNode(s),createVNode(i),createVNode(d),createVNode(g)]),_:1},8,["modelValue"]),createVNode(QDrawer,{"show-if-above":"",modelValue:t.rightDrawerOpen,"onUpdate:modelValue":e[9]||(e[9]=T=>t.rightDrawerOpen=T),side:"right",bordered:""},{default:withCtx(()=>[this.store.currentPage!==null?(openBlock(),createElementBlock("span",_hoisted_10,[createVNode(l)])):this.store.currentAssignment?(openBlock(),createElementBlock("span",_hoisted_11,[createVNode(u)])):this.store.currentCourse?(openBlock(),createElementBlock("span",_hoisted_12,[createVNode(m)])):(openBlock(),createElementBlock("span",_hoisted_13,[createVNode(y)]))]),_:1},8,["modelValue"]),createVNode(QPageContainer,null,{default:withCtx(()=>[createVNode(C)]),_:1})]),_:1})],64)}var CoursesLayout=_export_sfc(_sfc_main,[["render",_sfc_render]]);export{CoursesLayout as default};
