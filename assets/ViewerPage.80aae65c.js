import{Q as X}from"./QPage.8a23db62.js";import{u as J,s as x}from"./store.f28623c6.js";import{u as ye,b as be,Q as j,c as xe,d as ke,C as _e}from"./ClosePopup.43851fc6.js";import{d as C,c as ee,aA as Ce,aB as we,r as k,a as _,ad as te,h as Be,y as Ie,g as se,aM as W,N as K,aS as Se,t as Ae,k as m,F as M,H as Te,ac as $e,s as v,aO as Z,ae as q,j as oe,_ as ne,p as ie,m as N,n as B,q as u,aa as Me,Q as w,af as O,G as R}from"./index.27556a2f.js";import{u as ae,a as re}from"./use-dark.3801c011.js";import{o as Ee,c as Ve}from"./use-checkbox.697b3d05.js";import{Q as qe}from"./QCheckbox.1cce03fc.js";import{Q as ze}from"./QToggle.936b2005.js";import{Q as Pe}from"./QCard.1c1fc691.js";import{Q as Oe}from"./QImg.1f0ad6e0.js";import{u as Ne,r as Re,d as De}from"./firebase.dc843dde.js";import{s as c}from"./select.d6253da9.js";import"./axios.84ae42e4.js";import"./use-prevent-scroll.a4b743cb.js";import"./scroll.12ec9aa0.js";import"./use-timeout.f1e67e13.js";import"./use-tick.a6a8ebf0.js";import"./use-model-toggle.c4b1a6a1.js";const Qe=C("svg",{key:"svg",class:"q-radio__bg absolute non-selectable",viewBox:"0 0 24 24"},[C("path",{d:"M12,22a10,10 0 0 1 -10,-10a10,10 0 0 1 10,-10a10,10 0 0 1 10,10a10,10 0 0 1 -10,10m0,-22a12,12 0 0 0 -12,12a12,12 0 0 0 12,12a12,12 0 0 0 12,-12a12,12 0 0 0 -12,-12"}),C("path",{class:"q-radio__check",d:"M12,6a6,6 0 0 0 -6,6a6,6 0 0 0 6,6a6,6 0 0 0 6,-6a6,6 0 0 0 -6,-6"})]);var Fe=ee({name:"QRadio",props:{...ae,...Ce,...ye,modelValue:{required:!0},val:{required:!0},label:String,leftLabel:Boolean,checkedIcon:String,uncheckedIcon:String,color:String,keepColor:Boolean,dense:Boolean,disable:Boolean,tabindex:[String,Number]},emits:["update:modelValue"],setup(e,{slots:t,emit:h}){const{proxy:o}=se(),l=re(e,o.$q),I=we(e,Ee),d=k(null),{refocusTargetEl:n,refocusTarget:g}=Ve(e,d),f=_(()=>W(e.modelValue)===W(e.val)),i=_(()=>"q-radio cursor-pointer no-outline row inline no-wrap items-center"+(e.disable===!0?" disabled":"")+(l.value===!0?" q-radio--dark":"")+(e.dense===!0?" q-radio--dense":"")+(e.leftLabel===!0?" reverse":"")),E=_(()=>{const s=e.color!==void 0&&(e.keepColor===!0||f.value===!0)?` text-${e.color}`:"";return`q-radio__inner relative-position q-radio__inner--${f.value===!0?"truthy":"falsy"}${s}`}),T=_(()=>(f.value===!0?e.checkedIcon:e.uncheckedIcon)||null),P=_(()=>e.disable===!0?-1:e.tabindex||0),D=_(()=>{const s={type:"radio"};return e.name!==void 0&&Object.assign(s,{".checked":f.value===!0,"^checked":f.value===!0?"checked":void 0,name:e.name,value:e.val}),s}),S=be(D);function y(s){s!==void 0&&(K(s),g(s)),e.disable!==!0&&f.value!==!0&&h("update:modelValue",e.val,s)}function Q(s){(s.keyCode===13||s.keyCode===32)&&K(s)}function F(s){(s.keyCode===13||s.keyCode===32)&&y(s)}return Object.assign(o,{set:y}),()=>{const s=T.value!==null?[C("div",{key:"icon",class:"q-radio__icon-container absolute-full flex flex-center no-wrap"},[C(te,{class:"q-radio__icon",name:T.value})])]:[Qe];e.disable!==!0&&S(s,"unshift"," q-radio__native q-ma-none q-pa-none");const a=[C("div",{class:E.value,style:I.value,"aria-hidden":"true"},s)];n.value!==null&&a.push(n.value);const r=e.label!==void 0?Be(t.default,[e.label]):Ie(t.default);return r!==void 0&&a.push(C("div",{class:"q-radio__label q-anchor--skip"},r)),C("div",{ref:d,class:i.value,tabindex:P.value,role:"radio","aria-label":e.label,"aria-checked":f.value===!0?"true":"false","aria-disabled":e.disable===!0?"true":void 0,onClick:y,onKeydown:Q,onKeyup:F},a)}}});const le={radio:Fe,checkbox:qe,toggle:ze},Le=Object.keys(le);var Ue=ee({name:"QOptionGroup",props:{...ae,modelValue:{required:!0},options:{type:Array,validator:e=>e.every(t=>"value"in t&&"label"in t)},name:String,type:{default:"radio",validator:e=>Le.includes(e)},color:String,keepColor:Boolean,dense:Boolean,size:String,leftLabel:Boolean,inline:Boolean,disable:Boolean},emits:["update:modelValue"],setup(e,{emit:t,slots:h}){const{proxy:{$q:o}}=se(),l=Array.isArray(e.modelValue);e.type==="radio"?l===!0&&console.error("q-option-group: model should not be array"):l===!1&&console.error("q-option-group: model should be array in your case");const I=re(e,o),d=_(()=>le[e.type]),n=_(()=>"q-option-group q-gutter-x-sm"+(e.inline===!0?" q-option-group--inline":"")),g=_(()=>{const i={role:"group"};return e.type==="radio"&&(i.role="radiogroup",e.disable===!0&&(i["aria-disabled"]="true")),i});function f(i){t("update:modelValue",i)}return()=>C("div",{class:n.value,...g.value},e.options.map((i,E)=>{const T=h["label-"+E]!==void 0?()=>h["label-"+E](i):h.label!==void 0?()=>h.label(i):void 0;return C("div",[C(d.value,{modelValue:e.modelValue,val:i.value,name:i.name===void 0?e.name:i.name,disable:e.disable||i.disable,label:T===void 0?i.label:null,leftLabel:i.leftLabel===void 0?e.leftLabel:i.leftLabel,color:i.color===void 0?e.color:i.color,checkedIcon:i.checkedIcon,uncheckedIcon:i.uncheckedIcon,dark:i.dark||I.value,size:i.size===void 0?e.size:i.size,dense:e.dense,keepColor:i.keepColor===void 0?e.keepColor:i.keepColor,"onUpdate:modelValue":f},T)])}))}});const G=200,He=800,je=.1,We=.3,Y=.5,Ke=.5,Ze=12,Ge=800,Ye=1600,Xe=150,Je=3500,et=["#FFC700","#FF0000","#2E3191","#41BBC7"];var H={props:{particleCount:{type:Number,default:Xe},particleSize:{type:Number,default:Ze},duration:{type:Number,default:Je},colors:{type:Array,default:et},force:{type:Number,default:Ke},stageHeight:{type:Number,default:Ge},stageWidth:{type:Number,default:Ye},shouldDestroyAfterDone:{type:Boolean,default:!0}},setup(e){const t=k(!0),h=(s,a)=>{F(s,{degree:a})},o=_(()=>I(e.particleCount,e.colors));Se(()=>{e.particleCount>300&&console.log("[VUE-CONFETTI-EXPLOSION] That's a lot of confetti, you sure about that? A lesser number like 200 will still give off the party vibes while still not bricking the device \u{1F609}")});const l=_(()=>Q(e.particleCount,e.duration,e.colors,e.particleSize,e.force,e.stageHeight,e.stageWidth));Ae(async()=>{await d(e.duration),e.shouldDestroyAfterDone&&(t.value=!1)});const I=(s,a)=>{const r=360/s;return Array.from({length:s},(A,b)=>({color:a[b%a.length],degree:b*r}))},d=s=>new Promise(a=>setTimeout(a,s));function n(s){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return Math.round((s+Number.EPSILON)*10**a)/10**a}function g(s,a){if(s===a)return!0;if(s==null||a==null||s.length!==a.length)return!1;for(let r=0;r<s.length;r++)if(s[r]!==a[r])return!1;return!0}const f=(s,a,r,A,b)=>(s-a)*(b-A)/(r-a)+A,i=(s,a)=>{const r=s+a;return r>360?r-360:r},E=()=>Math.random()>.5,T=[0,0,1],P=[[1,1,0],[1,0,1],[0,1,1],[1,0,0],[0,1,0],T],D=s=>!g(P[s],T)&&E(),S=s=>typeof s=="undefined",y=s=>{console.error(s)};function Q(s,a,r,A,b,V,z){const $=Number.isSafeInteger;return!S(s)&&$(s)&&s<0?(y("particleCount must be a positive integer"),!1):!S(a)&&$(a)&&a<0?(y("duration must be a positive integer"),!1):!S(r)&&!Array.isArray(r)?(y("colors must be an array of strings"),!1):!S(A)&&$(A)&&A<0?(y("particleSize must be a positive integer"),!1):!S(b)&&$(b)&&(b<0||b>1)?(y("force must be a positive integer and should be within 0 and 1"),!1):!S(V)&&typeof V=="number"&&$(V)&&V<0?(y("floorHeight must be a positive integer"),!1):!S(z)&&typeof z=="number"&&$(z)&&z<0?(y("floorWidth must be a positive integer"),!1):!0}function F(s,a){let{degree:r}=a;const A=f(Math.abs(i(r,90)-180),0,180,-e.stageWidth/2,e.stageWidth/2),b=Math.random()*(He-G)+G,V=Math.round(Math.random()*(P.length-1)),z=e.duration-Math.round(Math.random()*1e3),$=Math.random()<je,L=D(V),U=$?n(Math.random()*We,2):0,de=U*-1,ce=U,ue=n(Math.abs(f(Math.abs(i(r,90)-180),0,180,-1,1)),4),he=n(Math.random()*Y,4),fe=n(Math.random()*e.force*(E()?1:-1),4),pe=Y,ge=n(Math.max(f(Math.abs(r-180),0,180,e.force,-e.force),0),4),p=(me,ve)=>s==null?void 0:s.style.setProperty(me,ve+"");p("--x-landing-point",`${A}px`),p("--duration-chaos",`${z}ms`),p("--x1",`${U}`),p("--x2",`${de}`),p("--x3",`${ce}`),p("--x4",`${ue}`),p("--y1",`${he}`),p("--y2",`${fe}`),p("--y3",`${pe}`),p("--y4",`${ge}`),p("--width",`${L?e.particleSize:Math.round(Math.random()*4)+e.particleSize/2}px`),p("--height",(L?e.particleSize:Math.round(Math.random()*2)+e.particleSize)+"px"),p("--rotation",`${P[V].join()}`),p("--rotation-duration",`${b}ms`),p("--border-radius",`${L?"50%":"0"}`)}return{isVisible:t,isValid:l,stageHeight:e.stageHeight,particles:o,setItemRef:h}}};function tt(e,t,h,o,l,I){return o.isVisible&&o.isValid?(m(),M("div",{key:0,class:"confetti-container",style:Z(`--floor-height: ${o.stageHeight}px;`)},[(m(!0),M(Te,null,$e(o.particles,d=>{let{color:n,degree:g}=d;return m(),M("div",{key:g,class:"particle",ref:f=>o.setItemRef(f,g)},[v("div",{style:Z(`--bgcolor: ${n};`)},null,4)],512)}),128))],4)):q("",!0)}function st(e,t){t===void 0&&(t={});var h=t.insertAt;if(!(!e||typeof document=="undefined")){var o=document.head||document.getElementsByTagName("head")[0],l=document.createElement("style");l.type="text/css",h==="top"&&o.firstChild?o.insertBefore(l,o.firstChild):o.appendChild(l),l.styleSheet?l.styleSheet.cssText=e:l.appendChild(document.createTextNode(e))}}var ot=`
@keyframes y-axis-4ff796ae {
to {
    transform: translate3d(0, var(--floor-height), 0);
}
}
@keyframes x-axis-4ff796ae {
to {
    transform: translate3d(var(--x-landing-point), 0, 0);
}
}
@keyframes rotation-4ff796ae {
to {
    transform: rotate3d(var(--rotation), 360deg);
}
}
.confetti-container[data-v-4ff796ae] {
  width: 0;
  height: 0;
  overflow: visible;
  position: relative;
  transform: translate3d(var(--x, 0), var(--y, 0), 0);
  z-index: 1200;
}
.confetti-container > .particle[data-v-4ff796ae] {
  animation: x-axis-4ff796ae var(--duration-chaos) forwards cubic-bezier(var(--x1), var(--x2), var(--x3), var(--x4));
}
.confetti-container > .particle div[data-v-4ff796ae] {
  position: absolute;
  top: 0;
  left: 0;
  animation: y-axis-4ff796ae var(--duration-chaos) forwards cubic-bezier(var(--y1), var(--y2), var(--y3), var(--y4));
  width: var(--width);
  height: var(--height);
}
.confetti-container > .particle div[data-v-4ff796ae]:before {
  display: block;
  height: 100%;
  width: 100%;
  content: "";
  background-color: var(--bgcolor);
  animation: rotation-4ff796ae var(--rotation-duration) infinite linear;
  border-radius: var(--border-radius);
}
`;st(ot);H.render=tt;H.__scopeId="data-v-4ff796ae";var nt=(()=>{const e=H;return e.install=t=>{t.component("ConfettiExplosion",e)},e})();const it=oe({name:"ComponentTemplate",components:{ConfettiExplosion:nt},setup(){return{store:J(),started:k(!1),group:k(""),step:k(1),words:k([]),options:k([]),answers:k([]),targetIdx:k(0),showWordChoices:k(!1),confettiOn:k(!1)}},mounted(){console.log("StepperComponent mounted"),console.log("StepperComponent showing Start Page"),x(".assignment").classed("hidden",!0),x(".coverslide").classed("hidden",!1);let e;this.store.userSnapshot?e=this.store.userSnapshot.preferences.pageFontSize+"pt":e="14pt",x("#slideTextDiv").style("font-size",e)},methods:{speakCB(){console.log("speakCB",c("#slideTextDiv").html()),this.store.speakText(c("#slideTextDiv").html())},resetButtons(){x(".stepB").classed("readyBorder",!1),x(".stepB").classed("notreadyBorder",!1),x(".stepB").classed("bg-negative",!1),x(".stepB").classed("bg-positive",!1)},update(e){console.log("targetIdx: ",this.targetIdx,"val: ",e),this.answers[this.targetIdx]=e;const t="#pop_"+this.targetIdx;c(t).html(e),console.log(this.answers),this.showWordChoices=!1,this.group=""},step1(){console.log("step1"),this.step=1,this.resetButtons(),c("#step1B").classed("bg-positive",!0),c("#step1B").classed("readyBorder",!0),this.store.loadPage(this.store.pgIdx),x("#slideTextDiv").html(this.store.currentPage.pageText),console.log("step1 done")},step2(){for(console.log("step2"),this.step=2,this.resetButtons(),c("#step2B").classed("bg-positive",!0),c("#step2B").classed("readyBorder",!0);this.words.length>0;)this.words.pop();for(;this.answers.length>0;)this.answers.pop();for(;this.options.length>0;)this.options.pop();const e=this.store.currentPage.pageText.replaceAll("  "," ").split(" ");console.log("rtext: ",e);let t="";for(const o in e)if(Math.random()*100<=this.store.currentPage.pctReplace){if(e[o]===" "){t+=e[o]+" ";continue}if(e[o]==="")continue;t+=' <b class="choose" id="pop_'+this.words.length+'">[choose]</b> ',this.words.push(e[o]),this.answers.push("")}else t+=e[o]+" ";console.log(t),c("#slideTextDiv").html(t);const h=5;for(const o in this.words){const l="#pop_"+o;c(l).on("click",I=>{for(;this.options.length>0;)this.options.pop();const d=[];this.targetIdx=o,console.log("onclick: targetIdx = ",this.targetIdx,this.targetIdx.value,o,this.words.length);for(let n=0;n<Math.min(h,this.words.length-1);n++){const g=parseInt(Math.random()*this.words.length);this.words[g]!==this.words[o]&&(d.indexOf(this.words[g])>-1||(this.options.push({label:this.words[g],value:this.words[g]}),d.push(this.words[g])))}if(this.store.role==="teacher")this.options.push({label:this.words[o],value:this.words[o]}),d.push(this.words[o]);else{const n=parseInt(Math.random()*(this.options.length+1));this.options.splice(n,0,{label:this.words[o],value:this.words[o]}),d.splice(n,0,this.words[o])}console.log(d),this.showWordChoices=!0})}},step3(){console.log("step3"),this.step=3,this.resetButtons();let e=!0;for(const t in this.words)this.words[t]!==this.answers[t]&&(e=!1);e?(c("#step3B").classed("bg-positive",!0),c("#step3B").classed("readyBorder",!0),this.store.courses[this.store.ck].assignments[this.store.aid].points+=this.words.length,this.explode()):(c("#step3B").classed("bg-negative",!0),c("#step3B").classed("notreadyBorder",!0))},step4(){if(this.step=4,console.log("step4"),this.resetButtons(),c("#step4B").classed("bg-positive",!0),c("#step4B").classed("readyBorder",!0),this.store.pgIdx<this.store.currentAssignment.pages.length-1)this.store.pgIdx+=1,this.store.imgIdx=this.store.currentAssignment.pages[this.store.pgIdx].imgIdx,this.step1();else{this.store.currentAssignment.scores||(this.store.currentAssignment.scores={},this.store.courses[this.store.ck].assignments[this.store.aid].scores={}),this.store.courses[this.store.ck].assignments[this.store.aid].scores[this.store.emailKey]||(this.store.courses[this.store.ck].assignments[this.store.aid].scores[this.store.emailKey]=0),this.store.courses[this.store.ck].assignments[this.store.aid].scores[this.store.emailKey]+=this.words.length,this.store.userSnapshot.profile.points+=this.store.currentAssignment.points,this.store.updateSnapshot("save-profile",null);const e=`courses/${this.store.ck}/assignments/${this.store.aid}/scores`;console.log(e);const t=this.store.currentAssignment.scores;console.log(t),Ne(Re(De,e),t),this.store.notify({msg:"Points updated, your balance is "+this.store.userSnapshot.profile.points}),x("#slideTextDiv").html("<h3> Congratulations! </h3>"),this.explode()}},startAssignment(){this.store.pgIdx=0,this.store.imgIdx=this.store.currentAssignment.pages[this.store.pgIdx].imgIdx,this.started=!0,this.store.currentAssignment.points=0,this.store.currentPage.pageType<4&&(console.log("Calling step1 b/c pageType < 4"),this.step1()),this.step1(),x(".assignment").classed("hidden",!1),x(".coverslide").classed("hidden",!0)},async explode(){c(".confetti").classed("hidden",!1).classed("z-max",!0),this.confettiOn=!0,window.setTimeout(()=>{this.confettiOn=!1,c(".confetti").classed("hidden",!0)},5e3)}}}),at=v("div",{class:"text-h6"},"Choose correct word:",-1),rt={class:"q-pa-lg"},lt={id:"slideCaptionDiv",class:"caption absolute-top q-pt-xl no-margins text-center assignment"},dt={key:0},ct={key:0,class:"flex flex-center"},ut={id:"coverSlideDiv",class:"flex flex-center cover-panel absolute-center coverslide hidden",contentEditable:"false"},ht={class:"q-ma-md"},ft=v("br",null,null,-1),pt=v("br",null,null,-1),gt={class:"confetti hidden fixed-center"},mt={class:"fixed-center text-panel text-center assignment",contenteditable:"false"},vt={id:"slideTextDiv"},yt={key:0},bt={key:0,class:"on-right",style:{width:"100px"}},xt={key:1},kt={class:"text-center fixed-bottom q-my-sm assignment"};function _t(e,t,h,o,l,I){const d=ie("ConfettiExplosion");return m(),N(X,{id:"stepper",class:"flex flex-center",style:{overflow:"hidden",width:"100%"}},{default:B(()=>[u(ke,{modelValue:this.showWordChoices,"onUpdate:modelValue":t[1]||(t[1]=n=>this.showWordChoices=n)},{default:B(()=>[u(Pe,null,{default:B(()=>[u(j,null,{default:B(()=>[at]),_:1}),u(j,{class:"q-pt-none"},{default:B(()=>[v("div",rt,[u(Ue,{modelValue:e.group,"onUpdate:modelValue":[t[0]||(t[0]=n=>e.group=n),this.update],options:this.options,color:"primary"},null,8,["modelValue","options","onUpdate:modelValue"])])]),_:1}),u(xe,{align:"right"},{default:B(()=>[Me(u(w,{flat:"",label:"OK",color:"primary"},null,512),[[_e]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),u(Oe,{class:"fixed-center",fit:this.store.imgFit?"cover":"scale-down",src:this.started?this.store.currentPage.imgs[this.store.imgIdx].url:this.store.currentAssignment.coverUrl,height:"100%"},null,8,["fit","src"]),v("div",lt,[this.started&&this.store.currentImage?(m(),M("span",dt,O(this.store.currentImage.cap),1)):q("",!0)]),this.store.currentAssignment&&this.store.currentAssignment.pages?(m(),M("span",ct,[v("div",ut,[v("div",ht,[u(w,{style:{width:"200px",height:"200px","font-size":"12pt"},class:"dash-button hidden"},{default:B(()=>[R(O(this.store.currentAssignment.title)+" ",1),ft,R(" "+O(this.store.currentAssignment.pages.length)+" Pages ",1),pt,R(" "+O(this.store.currentAssignment.goal)+" Points ",1)]),_:1}),u(w,{style:{width:"200px",height:"200px","font-size":"24pt"},stack:"",size:"xl","icon-right":"play_circle_outline","text-color":"white",class:"dash-button",onClick:t[2]||(t[2]=n=>this.startAssignment())},{default:B(()=>[R("Start")]),_:1})])])])):q("",!0),v("span",gt,[e.confettiOn?(m(),N(d,{key:0,stageHeight:800,style:{position:"relative",top:"-200px",left:"40px"}})):q("",!0)]),v("div",mt,[v("div",vt,[this.store.pgIdx!==-1?(m(),M("span",yt,O(this.store.currentPage.pageText),1)):q("",!0)]),this.step===1?(m(),M("span",bt,[u(w,{dense:"",round:"",class:"speak-button float-right",onClick:t[3]||(t[3]=n=>this.speakCB())},{default:B(()=>[u(te,{name:"volume_up",size:"md"})]),_:1})])):q("",!0)]),this.store.pgIdx!==-1?(m(),M("span",xt,[this.store.showText?(m(),N(w,{key:0,round:"",class:"assignment absolute-top-right bg-grey text-primary z-top",icon:"visibility",onClick:t[4]||(t[4]=n=>this.store.toggleText())})):(m(),N(w,{key:1,round:"",class:"assignment absolute-top-right bg-grey text-dark z-top",icon:"visibility_off",onClick:t[5]||(t[5]=n=>this.store.toggleText())}))])):q("",!0),v("div",kt,[u(w,{id:"step1B",class:"stepB clearBorder readyBorder",round:"",stack:"","no-caps":"",unelevated:"",color:"secondary",icon:"local_library",label:"Step 1",onClick:t[6]||(t[6]=n=>this.step1())}),u(w,{id:"step2B",class:"stepB clearBorder",round:"",stack:"","no-caps":"",unelevated:"",color:"secondary",icon:"handyman",label:"Step 2",onClick:t[7]||(t[7]=n=>this.step2())}),u(w,{id:"step3B",class:"stepB clearBorder",round:"",stack:"","no-caps":"",unelevated:"",color:"secondary",icon:"spellcheck",label:"Step 3",onClick:t[8]||(t[8]=n=>this.step3())}),u(w,{id:"step4B",class:"stepB clearBorder",round:"",stack:"","no-caps":"",unelevated:"",color:"secondary",icon:"local_library",label:"\xA0Next\xA0",onClick:t[9]||(t[9]=n=>this.step4())})])]),_:1})}var Ct=ne(it,[["render",_t]]);const wt=oe({name:"ViewerPage",components:{StepperComponent:Ct},setup(){return{store:J()}},mounted(){}}),Bt={class:"flex flex-center"};function It(e,t,h,o,l,I){const d=ie("StepperComponent");return m(),N(X,{style:{overflow:"hidden"}},{default:B(()=>[v("span",Bt,[u(d)])]),_:1})}var Ht=ne(wt,[["render",It]]);export{Ht as default};
