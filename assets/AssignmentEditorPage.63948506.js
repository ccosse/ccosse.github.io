import{Q as y}from"./QPage.7d47aa6a.js";import{u as P,s as c}from"./re-store.dee276a0.js";import{Q as A}from"./QBanner.3d72183c.js";import{Q as m}from"./QTooltip.59ddce99.js";import{e as B,r as $,u as N,_ as Q,o as a,f as k,w as t,k as o,g as i,j as n,an as u,ap as h,aq as f,Q as S,ar as V,as as w,i as J,at as C,l as b}from"./index.89842271.js";import{Q as q}from"./QBtnGroup.235877a2.js";import{a as T,Q as v}from"./QCardSection.7a8e8198.js";import{Q as _}from"./QCard.42ec64f3.js";import{Q as U}from"./QExpansionItem.e30fa5be.js";import"./transform.aea72fbe.js";import"./firebase.79bf92f9.js";import"./index.2cf0d985.js";import"./use-dark.1ee1890c.js";import"./uid.4f7d2bc7.js";const D=B({name:"AssignmentEditor",setup(){return{reStore:P(),assignment:$(null)}},mounted(){console.log("AE mounted"),N(this.reStore.courses,async(e,s)=>{if(console.log("AE watcher ",e,s),this.assignment&&e.aid&&e.ck&&this.assignment.pages.length!=e[e.ck].assignments[e.aid].pages.length&&(this.assignment=JSON.parse(JSON.stringify(this.reStore.courses[e.ck].assignments[e.aid])),console.log("AE reloading assignment b/c pages.length changed")),!this.assignment||this.assignment.id!==e.aid){const l=this.reStore.courses.ck,p=this.reStore.courses.aid;this.assignment=JSON.parse(JSON.stringify(this.reStore.courses[l].assignments[p]))}});try{if(!this.assignment||this.assignment.id!==newObj.aid){const e=this.reStore.courses.ck,s=this.reStore.courses.aid;this.assignment=JSON.parse(JSON.stringify(this.reStore.courses[e].assignments[s]))}}catch(e){console.log(e)}},methods:{deletePageCB(e){console.log("AE deletePageCB",e);const s=this.reStore.ck,l=this.reStore.aid;this.assignment.pages.splice(e,1),this.reStore.courses[s].assignments[l].pages.splice(e,1),this.reStore.courses.trigger+=1},newPageCB(){console.log("AE newPageCB"),this.reStore.newPage()},async loadPageCB(e){console.log("Pager loadPageCB ",e),this.reStore.page=JSON.parse(JSON.stringify(this.assignment.pages[e])),this.reStore.courses.pgIdx=e,this.reStore.page.imgIdx=this.assignment.pages[e].imgIdx,this.reStore.courses.imgIdx=this.assignment.pages[e].imgIdx,c(".assignment").classed("hidden",!1),c(".coverslide").classed("hidden",!0),this.reStore.courses.trigger+=1},async editPageCB(e){this.reStore.page=JSON.parse(JSON.stringify(this.assignment.pages[e])),this.reStore.courses.pgIdx=e,this.reStore.page.imgIdx=this.assignment.pages[e].imgIdx,this.reStore.courses.imgIdx=this.assignment.pages[e].imgIdx,c(".assignment").classed("hidden",!1),c(".coverslide").classed("hidden",!0),this.reStore.courses.trigger+=1,this.reStore.page.isCustom||(console.log("calling restore.reloadPage"),await this.reStore.reloadPage(),this.reStore.courses.trigger+=1),this.reStore.mode==="editor"?this.reStore.router.push("/teacher/editor"):this.reStore.router.push("/teacher/assignment")},dummy(){console.log("dummy")}}}),O={class:"q-pa-md"},z={class:"text-weight-bolder text-center text-h4 q-pa-md"},F={key:0},G={key:0},I={class:"q-ma-sm"},L={key:0,class:"flex flex-row justify-center"},M=o("div",{class:"absolute-top text-center",style:{"background-color":"#2228",height:"100%"}},[o("div",{class:"atit"},"p00. Cover")],-1),R={class:"absolute-top text-center",style:{"background-color":"#2228",height:"100%"}},H={class:"atit"},K={style:{"font-size":"22pt",width:"100%"},class:"text-center absolute-bottom"};function W(e,s,l,p,E,x){return a(),k(y,{class:"q-gutter-md bg-primary",style:{width:"100%"}},{default:t(()=>[o("div",O,[i(U,{class:"bg-positive",modelValue:e.defaultExpanded,"onUpdate:modelValue":s[2]||(s[2]=r=>e.defaultExpanded=r)},{header:t(()=>[i(A,{class:"bg-positive text-white",style:{width:"100%"}},{default:t(()=>[o("div",z,[n(" Assignment: "),this.reStore.courses.ck?(a(),u("span",F,h(this.reStore.courses[this.reStore.courses.ck].assignments[this.reStore.courses.aid].title),1)):f("",!0)])]),_:1})]),default:t(()=>[i(_,{flat:""},{default:t(()=>[i(T,{class:"text-center",style:{fontSize:"12pt"}},{default:t(()=>[n(" Title: "),this.reStore.aid?(a(),u("span",G,h(this.reStore.courses[this.reStore.ck].assignments[this.reStore.aid].title),1)):f("",!0),o("div",I,[i(q,null,{default:t(()=>[i(S,{icon:"delete",onClick:s[0]||(s[0]=r=>this.deleteAssignmentCB(this.reStore.courses.ck))},{default:t(()=>[i(m,null,{default:t(()=>[n("Delete Assignment")]),_:1})]),_:1}),i(S,{icon:"post_add",onClick:s[1]||(s[1]=r=>this.newPageCB(this.reStore.courses.ck))},{default:t(()=>[i(m,null,{default:t(()=>[n("New Page")]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),this.assignment?(a(),u("div",L,[i(_,{class:"acard bg-primary q-ma-sm",flat:"",bordered:"",modelValue:this.assignment.pages,"onUpdate:modelValue":s[4]||(s[4]=r=>this.assignment.pages=r)},{default:t(()=>[i(v,{class:"aimg",src:this.assignment.coverUrl,onClick:s[3]||(s[3]=r=>this.reStore.loadCover())},{default:t(()=>[M]),_:1},8,["src"])]),_:1},8,["modelValue"]),(a(!0),u(V,null,w(this.assignment.pages,(r,d)=>(a(),k(_,{class:"acard bg-primary q-ma-sm",flat:"",bordered:"",modelValue:this.assignment.pages,"onUpdate:modelValue":s[7]||(s[7]=g=>this.assignment.pages=g),key:d},{default:t(()=>[i(v,{class:"aimg",src:r.imgs[r.imgIdx].url,onClick:g=>this.loadPageCB(d)},{default:t(()=>[o("div",R,[o("div",H,"p"+h(d+1)+". "+h(r.pageTitle.slice(0,10)),1)]),o("div",K,[o("div",null,[i(J,{class:"ptr",name:"delete",onClick:[s[5]||(s[5]=C(()=>{},["stop","prevent"])),g=>this.deletePageCB(d)]},{default:t(()=>[i(m,null,{default:t(()=>[n("Delete Page")]),_:1})]),_:2},1032,["onClick"]),i(S,{icon:"edit",onClick:[s[6]||(s[6]=C(()=>{},["stop","prevent"])),g=>this.editPageCB(d)]},{default:t(()=>[i(m,null,{default:t(()=>[n("Edit Page")]),_:1})]),_:2},1032,["onClick"])])])]),_:2},1032,["src","onClick"])]),_:2},1032,["modelValue"]))),128))])):f("",!0)]),_:1})}var X=Q(D,[["render",W]]);const Y=B({name:"AssignmentEditorPage",components:{AssignmentEditor:X},setup(e){const s=P();return{props:e,reStore:s}}});function Z(e,s,l,p,E,x){const r=b("AssignmentEditor");return a(),k(y,{id:"QPage",class:"row justify-center"},{default:t(()=>[i(r)]),_:1})}var ue=Q(Y,[["render",Z]]);export{ue as default};
