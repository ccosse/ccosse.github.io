import{Q as P}from"./QPage.5792ec7b.js";import{u as Q,s as g}from"./re-store.cd501dae.js";import{Q as A}from"./QBanner.54f4fd09.js";import{e as B,r as N,u as V,_ as x,o as a,f as _,w as t,k as o,g as i,an as p,ap as m,aq as k,j as l,i as y,Q as f,ar as w,as as J,at as v,l as b}from"./index.c828c6c3.js";import{Q as c}from"./QTooltip.18034685.js";import{Q as q}from"./QBtnGroup.888e80a3.js";import{Q as T}from"./QCardSection.f9d46400.js";import{Q as S}from"./QCard.5d6afa29.js";import{Q as I}from"./QExpansionItem.dea6ae11.js";import{Q as C}from"./QImg.3e1e341c.js";import"./transform.aea72fbe.js";import"./firebase.79bf92f9.js";import"./index.2cf0d985.js";import"./use-dark.98cfec29.js";import"./scroll.91926555.js";import"./uid.42677368.js";const U=B({name:"AssignmentEditor",setup(){return{reStore:Q(),assignment:N(null)}},mounted(){console.log("AE mounted"),V(this.reStore.courses,async(e,s)=>{if(console.log("AE watcher ",e,s),this.assignment&&e.aid&&e.ck&&this.assignment.pages.length!=e[e.ck].assignments[e.aid].pages.length&&(this.assignment=JSON.parse(JSON.stringify(this.reStore.courses[e.ck].assignments[e.aid])),console.log("AE reloading assignment b/c pages.length changed")),!this.assignment||this.assignment.id!==e.aid){const u=this.reStore.courses.ck,h=this.reStore.courses.aid;this.assignment=JSON.parse(JSON.stringify(this.reStore.courses[u].assignments[h]))}});try{if(!this.assignment||this.assignment.id!==newObj.aid){const e=this.reStore.courses.ck,s=this.reStore.courses.aid;this.assignment=JSON.parse(JSON.stringify(this.reStore.courses[e].assignments[s]))}}catch(e){console.log(e)}},methods:{deletePageCB(e){},newPageCB(){console.log("AE newPageCB"),this.reStore.newPage()},async loadPageCB(e){console.log("Pager loadPageCB ",e),this.reStore.page=JSON.parse(JSON.stringify(this.assignment.pages[e])),this.reStore.courses.pgIdx=e,this.reStore.page.imgIdx=this.assignment.pages[e].imgIdx,this.reStore.courses.imgIdx=this.assignment.pages[e].imgIdx,g(".assignment").classed("hidden",!1),g(".coverslide").classed("hidden",!0),this.reStore.courses.trigger+=1},async editPageCB(e){this.reStore.page=JSON.parse(JSON.stringify(this.assignment.pages[e])),this.reStore.courses.pgIdx=e,this.reStore.page.imgIdx=this.assignment.pages[e].imgIdx,this.reStore.courses.imgIdx=this.assignment.pages[e].imgIdx,g(".assignment").classed("hidden",!1),g(".coverslide").classed("hidden",!0),this.reStore.courses.trigger+=1,this.reStore.page.isCustom||(console.log("calling restore.reloadPage"),await this.reStore.reloadPage(),this.reStore.courses.trigger+=1),this.reStore.mode==="editor"?this.reStore.router.push("/teacher/editor"):this.reStore.router.push("/teacher/assignment")},dummy(){console.log("dummy")}}}),D={class:"q-pa-md"},O={key:0,class:"text-weight-bolder text-center text-h4 q-pa-md"},z={class:"q-ma-sm"},F={key:0,class:"flex flex-row justify-center"},G=o("div",{class:"absolute-top text-center",style:{"background-color":"#2228",height:"100%"}},[o("div",{class:"atit"},"p00. Cover")],-1),K={class:"absolute-top text-center",style:{"background-color":"#2228",height:"100%"}},L={class:"atit"},M={style:{"font-size":"22pt",width:"100%"},class:"text-center absolute-bottom"};function R(e,s,u,h,E,$){return a(),_(P,{class:"q-gutter-md bg-primary",style:{width:"100%"}},{default:t(()=>[o("div",D,[i(I,{class:"bg-positive",modelValue:e.defaultExpanded,"onUpdate:modelValue":s[3]||(s[3]=r=>e.defaultExpanded=r)},{header:t(()=>[i(A,{class:"bg-positive text-white",style:{width:"100%"}},{default:t(()=>[this.reStore.courses.ck?(a(),p("div",O," Assignment: "+m(this.reStore.courses[this.reStore.courses.ck].assignments[this.reStore.courses.aid].title),1)):k("",!0)]),_:1})]),default:t(()=>[i(S,{flat:""},{default:t(()=>[i(T,{class:"text-center",style:{fontSize:"12pt"}},{default:t(()=>[l(" Title: "+m(this.reStore.courses[this.reStore.courses.ck].assignments[this.reStore.courses.aid].title)+" \xA0",1),i(y,{class:"ptr",name:"edit",onClick:s[0]||(s[0]=r=>{e.prompt=!0,this.courseTitle=this.reStore.courses[this.reStore.courses.ck].title,this.courseKey=e.ck})}),o("div",z,[i(q,null,{default:t(()=>[i(f,{icon:"delete",onClick:s[1]||(s[1]=r=>this.deleteAssignmentCB(this.reStore.courses.ck))},{default:t(()=>[i(c,null,{default:t(()=>[l("Delete Assignment")]),_:1})]),_:1}),i(f,{icon:"post_add",onClick:s[2]||(s[2]=r=>this.newPageCB(this.reStore.courses.ck))},{default:t(()=>[i(c,null,{default:t(()=>[l("New Page")]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),this.assignment?(a(),p("div",F,[i(S,{class:"acard bg-primary q-ma-sm",flat:"",bordered:"",modelValue:this.assignment.pages,"onUpdate:modelValue":s[4]||(s[4]=r=>this.assignment.pages=r)},{default:t(()=>[i(C,{class:"aimg",src:this.assignment.coverUrl},{default:t(()=>[G]),_:1},8,["src"])]),_:1},8,["modelValue"]),(a(!0),p(w,null,J(this.assignment.pages,(r,n)=>(a(),_(S,{class:"acard bg-primary q-ma-sm",flat:"",bordered:"",modelValue:this.assignment.pages,"onUpdate:modelValue":s[7]||(s[7]=d=>this.assignment.pages=d),key:n},{default:t(()=>[i(C,{class:"aimg",src:r.imgs[r.imgIdx].url,onClick:d=>this.loadPageCB(n)},{default:t(()=>[o("div",K,[o("div",L,"p"+m(n+1)+". "+m(r.pageTitle.slice(0,10)),1)]),o("div",M,[o("div",null,[i(y,{class:"ptr",name:"delete",onClick:[s[5]||(s[5]=v(()=>{},["stop","prevent"])),d=>this.deletePageCB(n)]},{default:t(()=>[i(c,null,{default:t(()=>[l("Delete Page")]),_:1})]),_:2},1032,["onClick"]),i(f,{icon:"edit",onClick:[s[6]||(s[6]=v(()=>{},["stop","prevent"])),d=>this.editPageCB(n)]},{default:t(()=>[i(c,null,{default:t(()=>[l("Edit Page")]),_:1})]),_:2},1032,["onClick"])])])]),_:2},1032,["src","onClick"])]),_:2},1032,["modelValue"]))),128))])):k("",!0)]),_:1})}var H=x(U,[["render",R]]);const W=B({name:"AssignmentEditorPage",components:{AssignmentEditor:H},setup(e){const s=Q();return{props:e,reStore:s}}});function X(e,s,u,h,E,$){const r=b("AssignmentEditor");return a(),_(P,{id:"QPage",class:"row justify-center"},{default:t(()=>[i(r)]),_:1})}var ue=x(W,[["render",X]]);export{ue as default};
