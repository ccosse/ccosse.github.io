import{Q as k}from"./QPage.b2d64fba.js";import{u as _,s as u}from"./re-store.93599b2f.js";import{Q as y}from"./QImg.a8f49500.js";import{e as I,r as m,u as b,_ as C,o as p,aq as S,g as t,w as i,k as a,ar as g,j as s,Q as o,aG as E,at as T,f as $,l as w}from"./index.8cba108b.js";import{Q as l}from"./QTooltip.0a15b80a.js";import{Q as f}from"./QBtnGroup.a3fc8c06.js";import{Q as x}from"./QPageSticky.c4e31e6b.js";import{s as F}from"./transform.aea72fbe.js";import"./firebase.79bf92f9.js";import"./index.2cf0d985.js";import"./scroll.c24c3931.js";const Q=I({name:"EditorComponent",props:{},setup(r){const e=_();return{props:r,reStore:e,imgCap:m(""),imgSrc:m(""),imgFit:m(""),pageText:m("")}},mounted(){console.log("EditorComponent.mounted"),b(this.reStore.courses,async(e,h)=>{console.log("Editor.watch"),e.ck,e.aid,e.pgIdx,e.imgIdx>this.reStore.page.imgs.length-1&&(e.imgIdx=0);const n=e.imgIdx;try{this.imgFit=this.reStore.page.imgFit,this.pageText=this.reStore.page.pageText,this.reStore.page.imgs.length>0?(console.log("try set editor img ",n,this.reStore.page.imgs),this.imgSrc=this.reStore.page.imgs[n].url,this.imgCap=this.reStore.page.imgs[n].cap):console.log("page doesnt have images YET")}catch(c){console.log("ERROR Editor watch ",c,n,this.reStore.page.imgs),this.imgSrc=this.reStore.page.imgs[0].url,this.imgCap=this.reStore.page.imgs[0].cap}},{immediate:!0,deep:!0}),this.reStore.courses.ck,this.reStore.courses.aid,this.reStore.courses.pgIdx;const r=this.reStore.courses.imgIdx;try{this.imgFit=this.reStore.page.imgFit,this.pageText=this.reStore.page.pageText,this.imgSrc=this.reStore.page.imgs[r].url,this.imgCap=this.reStore.page.imgs[r].cap}catch(e){console.log("ERROR Editor mounted",e)}},methods:{async reloadPage(){console.log("Editor calling reloadPage"),await this.reStore.reloadPage(),console.log("Editor page.imgs ",this.reStore.page.imgs),this.imgFit=this.reStore.page.imgFit,this.pageText=this.reStore.page.pageText,this.imgSrc=this.reStore.page.imgs[0].url,this.imgCap=this.reStore.page.imgs[0].cap},saveImageCB(){const r=this.reStore.courses.imgIdx;this.reStore.saveImage(null,this.reStore.page.imgs[r]),this.notify("Image saved to MyImages")},prevImg(){this.reStore.page.imgIdx=this.reStore.page.imgIdx-1<0?this.reStore.page.imgs.length-1:this.reStore.page.imgIdx-1,this.reStore.courses.imgIdx=this.reStore.page.imgIdx,this.reStore.setStatus("imgIdx",this.imgIdx),this.imgSrc=this.reStore.page.imgs[this.reStore.courses.imgIdx].url,this.imgCap=this.reStore.page.imgs[this.reStore.courses.imgIdx].cap},nextImg(){this.reStore.page.imgIdx=this.reStore.page.imgIdx+1>this.reStore.page.imgs.length-1?0:this.reStore.page.imgIdx+1,this.reStore.courses.imgIdx=this.reStore.page.imgIdx,this.reStore.setStatus("imgIdx",this.reStore.courses.imgIdx),this.imgSrc=this.reStore.page.imgs[this.reStore.courses.imgIdx].url,this.imgCap=this.reStore.page.imgs[this.reStore.courses.imgIdx].cap},toggleText(){F("#slideTextDiv").classed("hidden")?u("#slideTextDiv").classed("hidden",!1):u("#slideTextDiv").classed("hidden",!0)},cycleFitMode(){const r=["scale-down","cover"];let e=r.indexOf(this.imgFit);e+=1,e>r.length-1&&(e=0),this.reStore.page.imgFit=r[e],this.reStore.courses.trigger+=1},setCover(){this.reStore.courses.ck,this.reStore.courses.aid,this.reStore.courses.pgIdx;const r=this.reStore.courses.imgIdx,e=this.reStore.page.imgs[r].url;this.reStore.setCover(this.reStore.page.imgs[r]),console.log("coverUrl ",e)}}}),P={id:"slideCaptionDiv",class:"absolute-top text-subtitle1 text-center q-my-xl assignment",contentEditable:"true"},B={id:"slideTextDiv",class:"text-panel text-center absolute-center assignment",contentEditable:"true"},R={key:0},D={id:"coverSlideDiv",class:"flex flex-center cover-panel absolute-center coverslide hidden",contentEditable:"false"},N={class:"q-ma-md"},V=a("br",null,null,-1),q=a("br",null,null,-1),z={class:"q-ma-md"},M=a("br",null,null,-1),A=a("br",null,null,-1),G=a("br",null,null,-1),U=a("br",null,null,-1);function W(r,e,h,n,c,v){return p(),S(T,null,[t(y,{class:"fixed-center",src:this.imgSrc,fit:this.imgFit,height:"100%"},{default:i(()=>[a("div",P,g(this.imgCap),1)]),_:1},8,["src","fit"]),a("div",B,g(this.pageText),1),this.reStore.courses.aid?(p(),S("span",R,[a("div",D,[a("div",N,[t(o,{style:{width:"200px",height:"200px","font-size":"12pt"},color:"primary"},{default:i(()=>[s(g(this.reStore.courses[this.reStore.courses.ck].assignments[this.reStore.courses.aid].title)+" ",1),V,s(" "+g(this.reStore.courses[this.reStore.courses.ck].assignments[this.reStore.courses.aid].pages.length)+" Pages ",1),q,s(" "+g(this.reStore.courses[this.reStore.courses.ck].assignments[this.reStore.courses.aid].goal)+" Points ",1)]),_:1})]),a("div",z,[t(o,{style:{width:"200px",height:"200px","font-size":"24pt"},stack:"",size:"xl","icon-right":"play_circle","text-color":"white",color:"primary",onClick:e[0]||(e[0]=d=>this.reStore.startAssignment())},{default:i(()=>[s("Start")]),_:1})])])])):E("",!0),t(x,{position:"bottom",offset:[0,10],class:"assignment"},{default:i(()=>[t(f,null,{default:i(()=>[t(o,{fab:"","label-position":"left",color:"primary",icon:"arrow_left",onClick:this.prevImg,padding:"sm"},{default:i(()=>[t(l,null,{default:i(()=>[s(" Previous image (same Wikipedia page) ")]),_:1})]),_:1},8,["onClick"]),t(o,{color:"primary"},{default:i(()=>[s(g(this.reStore.courses.imgIdx+1)+"/"+g(this.reStore.page.imgs.length),1)]),_:1}),t(o,{fab:"","label-position":"right",color:"primary",icon:"arrow_right",onClick:this.nextImg,padding:"sm"},null,8,["onClick"]),t(l,null,{default:i(()=>[s(" Next image (same Wikipedia page) ")]),_:1})]),_:1})]),_:1}),t(x,{position:"bottom",offset:[0,60],class:"assignment"},{default:i(()=>[t(f,null,{default:i(()=>[t(o,{fab:"","label-position":"right",color:"primary",icon:"add_photo_alternate",onClick:e[1]||(e[1]=d=>this.saveImageCB()),padding:"sm"},{default:i(()=>[t(l,null,{default:i(()=>[s("Bookmark this image")]),_:1})]),_:1}),t(o,{fab:"","label-position":"right",color:"primary",icon:"bookmark_add",onClick:e[2]||(e[2]=d=>this.reStore.saveBookmark()),padding:"sm"},{default:i(()=>[t(l,null,{default:i(()=>[s("Bookmark this page")]),_:1})]),_:1}),t(o,{fab:"","label-position":"right",color:"primary",icon:"fit_screen",onClick:this.cycleFitMode,padding:"sm"},{default:i(()=>[t(l,null,{default:i(()=>[s("Cycle through image-fit modes")]),_:1})]),_:1},8,["onClick"]),t(o,{fab:"","label-position":"right",color:"primary",icon:"article",onClick:this.toggleText,padding:"sm"},{default:i(()=>[t(l,null,{default:i(()=>[s("Show/Hide paragraph text in order to get"),M,s("better view of image.")]),_:1})]),_:1},8,["onClick"]),t(o,{fab:"","label-position":"right",color:"primary",icon:"title",onClick:this.setCover,padding:"sm"},{default:i(()=>[t(l,null,{default:i(()=>[s("Set current image as Cover Image for current assignment,"),A,s("if there is an assignment currently loaded.")]),_:1})]),_:1},8,["onClick"]),t(o,{fab:"","label-position":"right",color:"primary",icon:"volume_up",onClick:e[3]||(e[3]=d=>this.reStore.speak()),padding:"sm"},{default:i(()=>[t(l,null,{default:i(()=>[s("Speak current text")]),_:1})]),_:1}),t(o,{fab:"","label-position":"right",color:"primary",icon:"arrow_right",onClick:this.reloadPage,padding:"xs"},{default:i(()=>[t(l,null,{default:i(()=>[s(" Reload page content. If Custom then no changes."),G,s(" If pageid, then only saved imgIdx applies."),U,s(" Else, reloads random with guid-words, if any. ")]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1})],64)}var H=C(Q,[["render",W]]);const Y=I({name:"EditorPage",components:{EditorComponent:H},setup(r){const e=_();return{props:r,reStore:e}}});function J(r,e,h,n,c,v){const d=w("EditorComponent");return p(),$(k,{id:"QPage",class:"row justify-center"},{default:i(()=>[t(d)]),_:1})}var oe=C(Y,[["render",J]]);export{oe as default};
