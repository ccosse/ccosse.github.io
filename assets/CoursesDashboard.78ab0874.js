import{_ as $,d as z,v as k,o as r,E as d,a as t,w as s,I as C,aI as B,U as V,Q as u,G as a,F as e,ai as h,T as _,H as x,c as v,V as g,R as w}from"./index.75ce3f9e.js";import{Q as U}from"./QCardSection.862a8d6a.js";import{Q as K,a as j,C as q}from"./ClosePopup.11a1f1ad.js";import{Q as c}from"./QCard.3be6014c.js";import{Q as y}from"./QInput.c864b00d.js";import{Q as b,a as A,b as D,c as Q}from"./QCarousel.006a47b3.js";import{Q as S}from"./QBar.5424d63d.js";import{Q as m}from"./QTooltip.7a24e53e.js";import{Q as T}from"./QPage.7ce681d8.js";import{u as O}from"./store.eabfb0c8.js";import{c as I}from"./copy-to-clipboard.abd28350.js";import"./use-prevent-scroll.2fa1ab15.js";import"./scroll.42015229.js";import"./use-model-toggle.bb69684b.js";import"./focusout.755806d2.js";import"./use-dark.f6f8b257.js";import"./uid.42677368.js";import"./use-form.a034d4ea.js";import"./QMenu.417ec07b.js";import"./position-engine.dd15efb9.js";import"./touch.b059422d.js";import"./firebase.f7873474.js";import"./axios.84ae42e4.js";const E=z({name:"CoursesDashboard",setup(){return{store:O(),slide:k(null),confirm:k(!1)}},mounted(){console.log("CoursesDashboard mounted"),this.store.ck&&!this.store.aid&&(this.store.aid=-1),this.slide=this.store.aid},methods:{deleteSelectedObject(){this.store.aid!==null&&this.store.aid>-1?this.store.deleteAssignment(this.store.ck,this.store.aid):this.store.ck!==null&&this.store.deleteCourse(this.store.ck)},editCB(){this.store.aid!==null&&(this.store.pgIdx=-1),this.store.router.push("/assignments")},slideChanged(i){console.log("CourseDashboard.slideChanged aid = ",i),this.store.aid=i},viewerCB(){if(console.log("CourseDash viewerCB setting pgIdx 0 before /viewer"),this.store.currentAssignment.pages.length===0){this.store.notify("The requested assignment has no pages!");return}this.store.pgIdx=0,this.store.router.replace("/viewer")},copyCourseKeyCB(){I(this.store.ck).then(()=>{console.log("ck copied to clipboard",this.store.ck);const i=`The course-key ${this.store.ck} was copied to clipboard`;this.store.notify(i)}).catch(i=>{console.log(i)})}}}),G={key:0,class:"q-ml-sm"},P={key:1,class:"q-ml-sm"},N={key:0},F=e("br",null,null,-1),R={key:1,class:"justify-center absolute-top"},W={class:"text-panel justify-center q-mx-md q-mb-xs q-mt-md"},H={class:"cursor-pointer"},L={class:"q-px-md row content-center"},M={class:"embed-panel col-12 col-md-5 assignment",style:{"z-index":"5","max-height":"30vh",height:"30vh"}},J={class:"q-px-lg row content-start"},X={class:"meta-table"},Y=e("th",{class:"key"},"Title",-1),Z={class:"val"},ee={class:"cursor-pointer"},te=e("td",{class:"key"},"Cover Url",-1),se={class:"cursor-pointer val"},oe=e("td",{class:"key"},"Assignments",-1),le={class:"val"},ae=e("td",{class:"key"},"Enrollment",-1),re={class:"val"},ne=e("td",{class:"key"},"Updated",-1),ie={class:"val"},de={class:"embed-panel col-12 col-md-5 assignment",style:{"z-index":"5","max-height":"30vh",height:"30vh"}},ue={class:"q-px-lg row content-start"},ce={class:"meta-table"},he=e("th",{class:"key"},"Title",-1),me={class:"val"},pe={class:"cursor-pointer"},fe=e("th",{class:"key"},"Cover Url",-1),_e={class:"val"},ge={class:"cursor-pointer"},ye=e("th",{class:"key"},"Pages",-1),be={class:"val"},ve={key:0},Ce={key:1},ke=e("th",{class:"key"},"Goal",-1),Ve={class:"val"},xe={key:0},we=e("th",{class:"key"},"Scores",-1),Ue={class:"val"},qe={key:0},Qe=e("br",null,null,-1),Se=e("th",{class:"key"},"Updated",-1),$e={class:"val"},ze={class:"control-panel q-pa-sm row justify-center no-wrap flex flex-center assignment",style:{overflow:"auto"}},Be=e("br",null,null,-1),Ke=e("br",null,null,-1),je=e("br",null,null,-1),Ae=e("br",null,null,-1),De=e("br",null,null,-1);function Te(i,l,Oe,Ie,Ee,Ge){return r(),d(C,null,[t(K,{modelValue:i.confirm,"onUpdate:modelValue":l[1]||(l[1]=o=>i.confirm=o),persistent:"",class:"z-max"},{default:s(()=>[t(c,null,{default:s(()=>[t(U,{class:"row items-center"},{default:s(()=>[t(B,{icon:"delete",color:"primary","text-color":"white"}),this.store.aid!==-1&&this.store.aid!==null?(r(),d("span",G,"Confirm delete assignment?")):(r(),d("span",P,"Confirm delete entire course?"))]),_:1}),t(j,{align:"right",class:"text-white"},{default:s(()=>[V(t(u,{flat:"",label:"Cancel"},null,512),[[q]]),V(t(u,{flat:"",label:"Delete",onClick:l[0]||(l[0]=o=>this.deleteSelectedObject())},null,512),[[q]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(T,{class:"flex flex-center"},{default:s(()=>[this.store.ck?(r(),d("div",R,[e("div",W,[a(" Course: "),e("span",H,[a(h(this.store.currentCourse.title)+" ",1),t(b,{modelValue:this.store.currentCourse.title,"onUpdate:modelValue":l[2]||(l[2]=o=>this.store.currentCourse.title=o),"auto-save":"",style:{maxWidth:"320px"}},{default:s(o=>[t(y,{modelValue:o.value,"onUpdate:modelValue":p=>o.value=p,clearable:"",dense:"",autofocus:"",counter:"",onKeyup:_(o.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:1},8,["modelValue"])])]),e("div",L,[t(A,{class:"q-ma-md full-width",animated:"",swipeable:"",thumbnails:"",autoplay:this.store.autoplay,"navigation-position":"top",modelValue:this.store.aid,"onUpdate:modelValue":[l[14]||(l[14]=o=>this.store.aid=o),this.slideChanged],infinite:"","control-type":"arrows",ref:"carousel",height:"85vh"},{control:s(()=>[t(D,{position:"bottom",offset:[0,0]},{default:s(()=>[e("div",ze,[t(u,{push:"",round:"",class:"dash-button","text-color":"white",icon:"arrow_left",style:x({height:"33.5px",width:"33.5px"}),onClick:l[5]||(l[5]=o=>i.$refs.carousel.previous())},{default:s(()=>[t(m,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:s(()=>[t(c,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:s(()=>[a(" Go to next previous of this assignment ")]),_:1})]),_:1})]),_:1},8,["style"]),this.store.ck!==null&&(this.store.aid===null||this.store.aid===-1)?(r(),v(u,{key:0,"no-caps":"",class:"dash-button on-right",onClick:l[6]||(l[6]=o=>this.copyCourseKeyCB()),icon:"content_copy"},{default:s(()=>[t(m,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:s(()=>[t(c,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:s(()=>[a(" Copy the course-key to clipboard, then"),Be,a(" share the course-key with whoever you"),Ke,a(" want to enroll. ")]),_:1})]),_:1})]),_:1})):g("",!0),this.store.aid!==null&&this.store.aid>-1&&this.store.currentAssignment.pages.length>0?(r(),v(u,{key:1,"no-caps":"",class:"dash-button on-right",onClick:l[7]||(l[7]=o=>this.viewerCB()),icon:"smart_display"},{default:s(()=>[t(m,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:s(()=>[t(c,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:s(()=>[a(" See assignment in Viewer ")]),_:1})]),_:1})]),_:1})):g("",!0),t(u,{"no-caps":"",class:"on-right dash-button",onClick:l[8]||(l[8]=o=>this.store.currentCourse.coverUrl=this.store.currentAssignment.coverUrl),icon:"wallpaper"},{default:s(()=>[t(m,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:s(()=>[t(c,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:s(()=>[a(" Make the image currently showing to be"),je,a("the cover image for this course ")]),_:1})]),_:1})]),_:1}),t(u,{"no-caps":"",class:"on-right dash-button",icon:"table_chart"},{default:s(()=>[t(m,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:s(()=>[t(c,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:s(()=>[a(" View course gradebook ")]),_:1})]),_:1})]),_:1}),t(u,{"no-caps":"",icon:"add",class:"on-right dash-button",onClick:l[9]||(l[9]=o=>this.store.newAssignment())},{default:s(()=>[t(m,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:s(()=>[t(c,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:s(()=>[a(" Create a new assignment under this course ")]),_:1})]),_:1})]),_:1}),this.store.aid!==null&&this.store.aid>-1?(r(),v(u,{key:2,"no-caps":"",icon:"edit",class:"on-right dash-button",onClick:l[10]||(l[10]=o=>this.editCB())},{default:s(()=>[t(m,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:s(()=>[t(c,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:s(()=>[a(" Go to the assignment editor"),Ae,a(" where you can add and edit pages"),De,a(" (text and images) for reading. ")]),_:1})]),_:1})]),_:1})):g("",!0),t(u,{"no-caps":"",icon:"save",class:"on-right dash-button",onClick:l[11]||(l[11]=o=>this.store.commitCourse(this.store.ck))},{default:s(()=>[t(m,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:s(()=>[t(c,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:s(()=>[a(" Save current course to cloud ")]),_:1})]),_:1})]),_:1}),t(u,{"no-caps":"",icon:"delete",class:"on-right dash-button",onClick:l[12]||(l[12]=o=>i.confirm=!0)},{default:s(()=>[t(m,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:s(()=>[t(c,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:s(()=>[a(" Delete the selected object (Course or Assignment) ")]),_:1})]),_:1})]),_:1}),t(u,{push:"",round:"",class:"on-right dash-button","text-color":"white",icon:"arrow_right",style:x({height:"33.5px",width:"33.5px"}),onClick:l[13]||(l[13]=o=>i.$refs.carousel.next())},{default:s(()=>[t(m,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:s(()=>[t(c,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:s(()=>[a(" Go to next page of this assignment ")]),_:1})]),_:1})]),_:1},8,["style"])])]),_:1})]),default:s(()=>[t(Q,{class:"text-panel row content-center justify-center",name:-1,"img-src":this.store.currentCourse.coverUrl},{default:s(()=>[e("table",M,[t(S,null,{default:s(()=>[a("Course")]),_:1}),e("tr",null,[e("td",J,[e("table",X,[e("tr",null,[Y,e("td",Z,[e("div",ee,[a(h(this.store.currentCourse.title)+" ",1),t(b,{modelValue:this.store.courses[this.store.ck].title,"onUpdate:modelValue":l[3]||(l[3]=o=>this.store.courses[this.store.ck].title=o),"auto-save":""},{default:s(o=>[t(y,{modelValue:o.value,"onUpdate:modelValue":p=>o.value=p,clearable:"",dense:"",autofocus:"",counter:"",onKeyup:_(o.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:1},8,["modelValue"])])])]),e("tr",null,[te,e("td",null,[e("div",se,[a(" Change "),t(b,{modelValue:this.store.courses[this.store.ck].coverUrl,"onUpdate:modelValue":l[4]||(l[4]=o=>this.store.courses[this.store.ck].coverUrl=o),"auto-save":""},{default:s(o=>[t(y,{modelValue:o.value,"onUpdate:modelValue":p=>o.value=p,clearable:"",dense:"",autofocus:"",counter:"",onKeyup:_(o.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:1},8,["modelValue"])])])]),e("tr",null,[oe,e("td",le,h(Object.keys(this.store.currentCourse.assignments).length),1)]),e("tr",null,[ae,e("td",re,h(Object.keys(this.store.currentCourse.enrollment).length),1)]),e("tr",null,[ne,e("td",ie,h(this.store.currentCourse.updated.split("-")[0]),1)])])])])])]),_:1},8,["img-src"]),(r(!0),d(C,null,w(this.store.currentCourse.assignments,(o,p)=>(r(),v(Q,{class:"text-panel items-center row justify-center",key:p,name:p,"img-src":o.coverUrl},{default:s(()=>[e("table",de,[t(S,null,{default:s(()=>[a("Assignment")]),_:1}),e("tr",null,[e("td",ue,[e("table",ce,[e("tr",null,[he,e("td",me,[e("div",pe,[a(h(o.title)+" ",1),t(b,{modelValue:o.title,"onUpdate:modelValue":n=>o.title=n,"auto-save":""},{default:s(n=>[t(y,{modelValue:n.value,"onUpdate:modelValue":f=>n.value=f,clearable:"",dense:"",autofocus:"",counter:"",onKeyup:_(n.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1032,["modelValue","onUpdate:modelValue"])])])]),e("tr",null,[fe,e("td",_e,[e("div",ge,[a(" Change "),t(b,{modelValue:o.coverUrl,"onUpdate:modelValue":n=>o.coverUrl=n,"auto-save":""},{default:s(n=>[t(y,{modelValue:n.value,"onUpdate:modelValue":f=>n.value=f,clearable:"",dense:"",autofocus:"",counter:"",onKeyup:_(n.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1032,["modelValue","onUpdate:modelValue"])])])]),e("tr",null,[ye,e("td",be,[o.pages?(r(),d("span",ve,h(o.pages.length),1)):(r(),d("span",Ce,"0"))])]),e("tr",null,[ke,e("td",Ve,h(o.goal),1)]),this.store.role==="teacher"?(r(),d("tr",xe,[we,e("td",Ue,[Object.keys(o).indexOf("scores")>-1?(r(),d("span",qe,[(r(!0),d(C,null,w(Object.entries(o.scores),(n,f)=>(r(),d("span",{key:f},[a(h(n[0].split("_")[0])+" "+h(n[1]),1),Qe]))),128))])):g("",!0)])])):g("",!0),e("tr",null,[Se,e("td",$e,h(o.updated.split("-")[0]),1)])])])])])]),_:2},1032,["name","img-src"]))),128))]),_:1},8,["autoplay","modelValue","onUpdate:modelValue"])])])):(r(),d("div",N,[t(c,{flat:"",bordered:"",class:"text-panel"},{default:s(()=>[t(U,{class:"text-center"},{default:s(()=>[a(" Welcome to Reading Edge! "),F,a(" Please select or create a course ")]),_:1})]),_:1})]))]),_:1})],64)}var ct=$(E,[["render",Te]]);export{ct as default};
