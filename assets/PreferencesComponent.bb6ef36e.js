import{Q as x,d as U,C as b,c as F}from"./ClosePopup.43851fc6.js";import{Q as T,a as B}from"./QMenu.3a3662a4.js";import{j as Q,_ as D,k as n,m as _,n as l,ae as r,s as t,F as a,af as d,q as s,av as A,ad as P,r as f,p as N,G as u,aa as w,Q as g,H as q,ac as L,P as V,aj as S}from"./index.27556a2f.js";import{Q as p}from"./QCard.1c1fc691.js";import{Q as y}from"./QToggle.936b2005.js";import{Q as C}from"./QTooltip.fbbd9838.js";import{u as z,s as $}from"./store.f28623c6.js";import{Q as j}from"./QImg.1f0ad6e0.js";import{Q as E,a as K}from"./QSelect.97613fe2.js";import{Q as O}from"./QExpansionItem.416d5213.js";import{Q as M}from"./QList.92d48196.js";const R=Q({name:"TileComponent",props:["tileName","tileData","tileType","imgUrl","targetUrl","ck","aid","pgIdx","imgIdx"],setup(){return{store:z()}},methods:{removeImage(o){console.log("removeImage ",o),this.store.currentPage.imgs.splice(o,1)},clickCB(o,e,c,I,h,k,i,m){if(console.log("clickCB",o,e,c,I,h,k,i,m),this.store.ck=o,this.store.aid=e,this.store.pgIdx=c,i==="course")console.log("setting aid -1"),this.store.aid=null,this.store.ck=o;else if(i==="assignment"){this.store.pgIdx=null,this.store.aid=e,console.log("aid",e),this.store.router.push("/courses/assignments");return}else if(i==="page"){this.store.pgIdx=c,this.store.router.push("/courses/assignments/pages");return}try{this.store.imgIdx=this.imgIdx,this.store.currentPage.imgIdx=this.imgIdx}catch(v){console.log(v)}h!==null?(console.log("pushing targetUrl",h),this.store.router.push(h)):k!==null&&i==="image"&&(this.store.imgIdx=this.imgIdx)}}}),G={class:"text-h6 absolute-center full-width text-center"},H={key:0},W={key:1},J={key:2},X={key:3},Y={key:4},Z={key:5},ee={key:6},te={key:1},se={class:"hidden"},oe=t("tr",null,[t("th",{align:"left"},"prop"),t("th",{align:"center"},[t("b",null,"val")])],-1),le={key:0},ie=t("td",null,"ck",-1),ne={key:1},ae=t("td",null,"aid",-1),re={key:2},de=t("td",null,"pgIdx",-1),ue={key:3},me=t("td",null,"imgIdx",-1),ge={key:4},pe=t("td",null,"imgUrl",-1),he={key:5},ce=t("td",null,"targetUrl",-1);function fe(o,e,c,I,h,k){return n(),_(p,{flat:"",bordered:"",class:"q-ma-md q-pa-xs cursor-pointer tile-component",onClick:e[2]||(e[2]=i=>this.clickCB(this.ck,this.aid,this.pgIdx,this.imgIdx,this.targetUrl,this.imgUrl,this.tileType,this.tileName))},{default:l(()=>[this.imgUrl?(n(),_(j,{key:0,class:"absolute-center tile-component",src:this.imgUrl,style:{opacity:"1"}},null,8,["src"])):r("",!0),t("div",G,[this.tileData.pageTitle!==null?(n(),a("div",H,d(this.tileData.pageTitle),1)):r("",!0),this.tileType=="section"?(n(),a("div",W,d(this.tileName),1)):r("",!0),this.tileType=="course"?(n(),a("div",J,[t("div",null,d(this.tileData.title),1),t("div",null,d(Object.keys(this.tileData.assignments).length)+" assignments ",1),t("div",null,d(Object.keys(this.tileData.enrollment).length)+" students",1)])):r("",!0),this.tileType=="assignment"?(n(),a("div",X,[t("div",null,d(this.tileData.title),1),t("div",null,d(this.tileData.pages.length)+" pgs",1)])):r("",!0),this.tileType==="page"?(n(),a("div",Y,"Page "+d(this.pgIdx+1),1)):r("",!0),this.store.currentPage&&this.tileType=="page"?(n(),a("div",Z,d(this.store.currentAssignment.pages[this.pgIdx].imgs.length)+" imgs ",1)):r("",!0),this.tileType=="image"?(n(),a("div",ee,"Image "+d(this.imgIdx+1),1)):r("",!0)]),this.tileType=="image"&&this.store.role=="teacher"?(n(),a("div",te,[s(P,{size:"md",name:"delete",class:"absolute-top-right",onClick:[e[0]||(e[0]=A(()=>{},["stop","prevent"])),e[1]||(e[1]=i=>o.removeImage(this.imgIdx))]})])):r("",!0),t("table",se,[oe,this.ck?(n(),a("tr",le,[ie,t("td",null,d(this.ck),1)])):r("",!0),this.aid?(n(),a("tr",ne,[ae,t("td",null,d(this.aid),1)])):r("",!0),this.pgIdx!==null?(n(),a("tr",re,[de,t("td",null,d(this.pgIdx),1)])):r("",!0),this.imgIdx!==null?(n(),a("tr",ue,[me,t("td",null,d(this.imgIdx),1)])):r("",!0),this.imgUrl?(n(),a("tr",ge,[pe,t("td",null,"..."+d(this.imgUrl.slice(-20)),1)])):r("",!0),this.targetUrl?(n(),a("tr",he,[ce,t("td",null,"..."+d(this.targetUrl.slice(-20)),1)])):r("",!0)])]),_:1})}var _e=D(R,[["render",fe]]);const ke=Q({name:"ImagePager",components:{TileComponent:_e},props:[],setup(){return{store:z(),showAddImage:f(!1),newImageUrl:f(null)}},methods:{addImageCB(){const o={url:this.newImageUrl,cap:"Caption"};this.store.courses[this.store.ck].assignments[this.store.aid].pages[this.store.pgIdx].imgs.push(o);const e=this.store.courses[this.store.ck].assignments[this.store.aid].pages[this.store.pgIdx].imgs.length;this.store.courses[this.store.ck].assignments[this.store.aid].pages[this.store.pgIdx].imgIdx=e-1}}}),xe={class:"text-panel q-ma-md text-center text-h6"},ye={key:0},Ce={key:0};function Ie(o,e,c,I,h,k){const i=N("TileComponent");return n(),a(q,null,[s(U,{modelValue:o.showAddImage,"onUpdate:modelValue":e[1]||(e[1]=m=>o.showAddImage=m)},{default:l(()=>[t("div",null,[s(p,{class:"q-pa-md outlined q-ma-lg text-white text-center",style:{width:"400px",height:"200px"}},{default:l(()=>[s(x,null,{default:l(()=>[u("Enter image url")]),_:1}),s(T,{modelValue:this.newImageUrl,"onUpdate:modelValue":e[0]||(e[0]=m=>this.newImageUrl=m),type:"input",clearable:"",dense:"",autofocus:"",counter:""},null,8,["modelValue"]),w((n(),_(g,null,{default:l(()=>[u("Close")]),_:1})),[[b]]),w((n(),_(g,{onClick:o.addImageCB},{default:l(()=>[u("Add")]),_:1},8,["onClick"])),[[b]])]),_:1})])]),_:1},8,["modelValue"]),t("div",xe,[u("Images: "),this.store.currentPage?(n(),a("span",ye,d(this.store.currentPage.imgs.length),1)):r("",!0)]),s(B,{class:"hidden"},{default:l(()=>[s(y,{label:"Image Fit",modelValue:this.store.imgFit,"onUpdate:modelValue":e[2]||(e[2]=m=>this.store.imgFit=m)},null,8,["modelValue"])]),_:1}),this.store.currentPage?(n(),a("span",Ce,[(n(!0),a(q,null,L(this.store.currentPage.imgs,(m,v)=>(n(),a("span",{key:v},[s(i,{tileData:m,imgUrl:m.url,targetUrl:null,ck:this.store.ck,aid:this.store.aid,pgIdx:this.store.pgIdx,imgIdx:v,tileType:"image"},null,8,["tileData","imgUrl","ck","aid","pgIdx","imgIdx"])]))),128))])):r("",!0),s(p,{flat:"",bordered:"",class:"q-ma-md q-pa-md cursor-pointer tile-component flex flex-center",onClick:e[3]||(e[3]=m=>this.showAddImage=!0)},{default:l(()=>[s(P,{name:"add",class:"text-h1"}),s(C,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:l(()=>[s(p,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:l(()=>[u(" Add new image ")]),_:1})]),_:1})]),_:1})],64)}var Je=D(ke,[["render",Ie]]);const ve=Q({name:"PreferencesComponent",setup(){return{store:z(),dark:f(V.isActive),promptFontSize:f(!1),promptLanguage:f(!1),showText:f(!0)}},mounted(){},methods:{goAdmin(){console.log("goAdmin"),this.store.router.push("/admin")},langChangeCB(o){console.log(o);const e=this.flagName;$("#sfi").classed(e,!1),console.log(this.store.langVoices),this.flagName=this.store.langVoices[o].flagName,console.log("langChangeCB",o,this.flagName),$("#sfi").classed(this.flagName,!0)},populateDemo(){console.log("populateDemo"),Object.keys(this.store.currentCourse.assignments).forEach(o=>{console.log(o),Object.keys(this.store.currentCourse.enrollment).forEach(e=>{this.store.currentCourse.assignments[o].scores||(this.store.currentCourse.assignments[o].scores={}),this.store.currentCourse.assignments[o].scores[e]=parseInt(Math.random()*100)})})},toggleDark(){V.toggle(),console.log(V.isActive,this.dark),V.isActive},fontSizeCB(o){$("#sampleFontSwatch").style("font-size",o+"pt"),$("#slideTextDiv").style("font-size",o+"pt"),this.store.userSnapshot.preferences.pageFontSize=o},fsCB(){S.isActive?S.exit().then(()=>{}).catch(o=>{console.log(o)}):S.request().then(()=>{}).catch(o=>{console.log(o)})}}}),Ve=t("div",{class:"text-h6"},"Reconstruct Paragraph Font Size",-1),$e=t("td",{style:{width:"60%"}},[t("div",{id:"sampleFontSwatch"},"Reading Edge!")],-1),be=t("div",{class:"text-h6"},"Set Language For WP",-1),we=t("span",{class:"on-right",id:"sfi"},null,-1),Se={width:"100%",class:"z-max"},Ue={class:"q-pa-md",style:{"max-width":"350px"}},qe={class:"text-center q-mt-md",style:{width:"100%"}},Qe=t("br",null,null,-1),De={class:"text-center",style:{width:"100%"}},ze={class:"text-center hidden",style:{width:"100%"}},Fe={class:"text-center hidden",style:{width:"100%"}},Pe={class:"text-center",style:{width:"100%"}},Te={class:"text-center q-mb-md",style:{width:"100%"}},Be=t("br",null,null,-1);function Ae(o,e,c,I,h,k){return n(),a(q,null,[s(U,{modelValue:o.promptFontSize,"onUpdate:modelValue":e[1]||(e[1]=i=>o.promptFontSize=i),persistent:""},{default:l(()=>[s(p,{style:{"min-width":"350px"}},{default:l(()=>[s(x,{align:"center"},{default:l(()=>[Ve]),_:1}),s(x,{class:"q-pt-none",align:"center"},{default:l(()=>[t("table",null,[t("tr",null,[t("td",null,[s(E,{"show-value":"",size:"140px",thickness:.5,color:"positive","track-color":"green-3","center-color":"grey-8",class:"text-white col q-ma-md",modelValue:this.store.userSnapshot.preferences.pageFontSize,"onUpdate:modelValue":e[0]||(e[0]=i=>this.store.userSnapshot.preferences.pageFontSize=i),min:"0",max:"50",onDragValue:this.fontSizeCB},null,8,["thickness","modelValue","onDragValue"])]),$e])])]),_:1}),s(F,{align:"center",class:"text-white"},{default:l(()=>[w(s(g,{outline:"",flat:"",label:"Done"},null,512),[[b]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(U,{modelValue:o.promptLanguage,"onUpdate:modelValue":e[3]||(e[3]=i=>o.promptLanguage=i),persistent:""},{default:l(()=>[s(p,{style:{"min-width":"350px"}},{default:l(()=>[s(x,null,{default:l(()=>[be,u(),we]),_:1}),s(x,{class:"q-pt-none"},{default:l(()=>[t("table",Se,[t("tr",null,[t("td",null,[s(K,{class:"z-max",outlined:"",modelValue:this.store.userSnapshot.preferences.langVoiceKey,"onUpdate:modelValue":[e[2]||(e[2]=i=>this.store.userSnapshot.preferences.langVoiceKey=i),this.langChangeCB],options:this.store.userSnapshot.preferences.langVoices},null,8,["modelValue","options","onUpdate:modelValue"])])])])]),_:1}),s(F,{align:"right",class:"text-white"},{default:l(()=>[w(s(g,{outline:"",flat:"",label:"Done"},null,512),[[b]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t("div",Ue,[s(M,{bordered:"",class:"rounded-borders"},{default:l(()=>[s(O,{label:"Preferences"},{default:l(()=>[t("div",qe,[u(" Current Role: "+d(this.store.role),1),Qe]),t("div",De,[s(y,{modelValue:o.dark,"onUpdate:modelValue":e[4]||(e[4]=i=>o.dark=i),"keep-color":"",color:"primary","unchecked-icon":"light_mode","checked-icon":"dark_mode",onClick:e[5]||(e[5]=i=>this.toggleDark()),label:"Dark Mode"},null,8,["modelValue"])]),t("div",ze,[s(y,{modelValue:this.store.tts,"onUpdate:modelValue":e[6]||(e[6]=i=>this.store.tts=i),"keep-color":"",color:"primary",label:"TTS"},null,8,["modelValue"])]),t("div",Fe,[s(y,{label:"Auto-Play",modelValue:this.store.autoplay,"onUpdate:modelValue":e[7]||(e[7]=i=>this.store.autoplay=i),"keep-color":"",color:"primary"},null,8,["modelValue"])]),t("div",Pe,[s(y,{label:"Image Fit ",modelValue:this.store.imgFit,"onUpdate:modelValue":e[8]||(e[8]=i=>this.store.imgFit=i),"keep-color":"",color:"primary"},null,8,["modelValue"])]),t("div",Te,[s(g,{"no-padding":""},{default:l(()=>[t("span",{id:"sfi",onClick:e[9]||(e[9]=i=>o.promptLanguage=!0)}),s(C,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:l(()=>[s(p,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:l(()=>[u(" Set preferred language ")]),_:1})]),_:1})]),_:1}),s(g,{icon:"fullscreen",onClick:e[10]||(e[10]=i=>this.fsCB())},{default:l(()=>[s(C,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:l(()=>[s(p,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:l(()=>[u(" Fullscreen ")]),_:1})]),_:1})]),_:1}),s(g,{"no-caps":"",icon:"format_size",onClick:e[11]||(e[11]=i=>this.promptFontSize=!0)},{default:l(()=>[s(C,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:l(()=>[s(p,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:l(()=>[u(" Set preferred default font size"),Be,u("Can be overridden per-page, also ")]),_:1})]),_:1})]),_:1}),this.store.emailKey==="charlie_at_readingedge_dot_org"?(n(),_(g,{key:0,icon:"manage_accounts",onClick:e[12]||(e[12]=i=>this.populateDemo())})):r("",!0),this.store.emailKey==="charlie_at_readingedge_dot_org"?(n(),_(g,{key:1,icon:"settings",onClick:e[13]||(e[13]=i=>this.goAdmin())})):r("",!0),s(g,{icon:"save",onClick:e[14]||(e[14]=i=>this.store.updateSnapshot("save-preferences",null))},{default:l(()=>[s(C,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:l(()=>[s(p,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:l(()=>[u(" Save preferences ")]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})])],64)}var Xe=D(ve,[["render",Ae]]);export{Je as I,Xe as P,_e as T};
