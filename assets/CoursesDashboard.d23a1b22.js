import{_ as $,d as z,v as C,o as a,E as d,a as e,w as t,H as _,aM as B,Z as V,Q as u,G as l,F as s,as as h,a2 as v,a0 as b,aN as q,c as k,U as y}from"./index.fb8c9c73.js";import{Q as G,a as U,b as j,C as Q}from"./ClosePopup.3e8b7d30.js";import{Q as c}from"./QCard.8c09a937.js";import{Q as x}from"./QMenu.0eae9f81.js";import{c as K,Q as w,a as A,b as D,d as T}from"./copy-to-clipboard.106ade84.js";import{Q as p,f as S}from"./QBar.d2c6d207.js";import{Q as E}from"./QPage.29ecdd27.js";import{u as I}from"./store.0939f58b.js";import"./use-prevent-scroll.94b8e8c1.js";import"./scroll.dff248f3.js";import"./use-dark.644ac635.js";import"./touch.6b3a5d84.js";import"./firebase.84a31673.js";import"./axios.84ae42e4.js";const N=z({name:"CoursesDashboard",setup(){return{store:I(),slide:C(null),confirm:C(!1),showGradebook:C(!1)}},mounted(){console.log("CoursesDashboard mounted"),this.store.aid=null,this.slide=-1},methods:{toggleGradebook(){console.log("toggleGradebook"),this.showGradebook?this.showGradebook=!1:this.showGradebook=!0},deleteSelectedObject(){this.store.aid!==null&&this.store.aid>-1?this.store.deleteAssignment(this.store.ck,this.store.aid):this.store.ck!==null&&this.store.deleteCourse(this.store.ck)},editCB(){if(this.store.aid!==null)this.store.pgIdx=-1;else{const i=Object.keys(this.store.currentCourse.assignments);i.length>0&&(this.store.aid=i[0],this.store.pgIdx=0)}this.store.router.push("/courses/assignments")},slideChanged(i){console.log("CourseDashboard.slideChanged ck = ",i),this.store.ck=i},viewerCB(){if(console.log("CourseDash viewerCB setting pgIdx 0 before /viewer"),this.store.currentAssignment.pages.length===0){this.store.notify("The requested assignment has no pages!");return}this.store.pgIdx=0,this.store.router.replace("/viewer")},copyCourseKeyCB(){K(this.store.ck).then(()=>{console.log("ck copied to clipboard",this.store.ck);const i=`The course-key ${this.store.ck} was copied to clipboard`;this.store.notify(i)}).catch(i=>{console.log(i)})}}}),O={key:0,class:"q-ml-sm"},P={key:1,class:"q-ml-sm"},F={key:0},M=s("br",null,null,-1),W={key:1,class:"justify-center absolute-top"},H={class:"text-panel justify-center q-mx-md q-mb-xs q-mt-md"},L={key:0,class:"cursor-pointer"},R={class:"q-px-md row content-center"},Z={key:0,class:"embed-panel col-12 col-md-11 assignment",style:{"z-index":"5","max-height":"30vh",height:"30vh"}},J={class:"q-px-lg row content-start"},X={width:"100%",class:"meta-table"},Y=s("tr",null,[s("th",{colSpan:"100"},[s("div",{class:"text-center val"},"Assignments")])],-1),ee=s("th",{class:"val"},"Student",-1),te={class:"hidden"},se={class:"key"},oe={class:"hidden"},le={key:0},ae={key:1},re={class:"hidden"},ne={key:1,class:"embed-panel col-12 col-md-5 assignment",style:{"z-index":"5","max-height":"30vh",height:"30vh"}},ie={class:"q-px-lg row content-start"},de={class:"meta-table"},ue=s("th",{class:"key"},"Title",-1),ce={class:"val"},he={class:"cursor-pointer"},me=s("td",{class:"key"},"Cover Url",-1),pe={class:"cursor-pointer val"},fe=s("td",{class:"key"},"Assignments",-1),_e={class:"val"},ge=s("td",{class:"key"},"Enrollment",-1),be={class:"val"},ke=s("td",{class:"key"},"Updated",-1),ye={class:"val"},Ce={class:"control-panel q-pa-sm row justify-center no-wrap flex flex-center assignment",style:{overflow:"auto"}},ve=s("br",null,null,-1),xe=s("br",null,null,-1),we=s("br",null,null,-1),Ve=s("br",null,null,-1),qe=s("br",null,null,-1);function Ue(i,o,Qe,Se,$e,ze){return a(),d(_,null,[e(G,{modelValue:i.confirm,"onUpdate:modelValue":o[1]||(o[1]=f=>i.confirm=f),persistent:"",class:"z-max confirm-delete-obj"},{default:t(()=>[e(c,null,{default:t(()=>[e(U,{class:"row items-center"},{default:t(()=>[e(B,{icon:"delete",color:"primary","text-color":"white"}),this.store.aid!==null&&this.store.aid>-1?(a(),d("span",O,"Confirm delete assignment?")):(a(),d("span",P,"Confirm delete entire course?"))]),_:1}),e(j,{align:"right",class:"text-white"},{default:t(()=>[V(e(u,{flat:"",label:"Cancel"},null,512),[[Q]]),V(e(u,{flat:"",label:"Delete",onClick:o[0]||(o[0]=f=>this.deleteSelectedObject())},null,512),[[Q]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(E,{class:"flex flex-center"},{default:t(()=>{var f;return[this.store?(a(),d("div",W,[s("div",H,[l(" Course: "),this.store.currentCourse?(a(),d("span",L,[l(h((f=this.store.currentCourse)==null?void 0:f.title)+" ",1),e(w,{modelValue:this.store.currentCourse.title,"onUpdate:modelValue":o[2]||(o[2]=r=>this.store.currentCourse.title=r),"auto-save":"",style:{maxWidth:"320px"}},{default:t(r=>[e(x,{modelValue:r.value,"onUpdate:modelValue":g=>r.value=g,clearable:"",dense:"",autofocus:"",counter:"",onKeyup:v(r.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:1},8,["modelValue"])])):b("",!0)]),s("div",R,[e(A,{class:"q-ma-md full-width",animated:"",swipeable:"",thumbnails:"",autoplay:this.store.autoplay,"navigation-position":"top",modelValue:this.store.ck,"onUpdate:modelValue":[o[13]||(o[13]=r=>this.store.ck=r),this.slideChanged],infinite:"","control-type":"arrows",ref:"carousel",height:"85vh"},{control:t(()=>[e(D,{position:"bottom",offset:[0,0]},{default:t(()=>[s("div",Ce,[e(u,{push:"",round:"",class:"dash-button","text-color":"white",icon:"arrow_left",style:q({height:"33.5px",width:"33.5px"}),onClick:o[3]||(o[3]=r=>i.$refs.carousel.previous())},{default:t(()=>[e(p,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:t(()=>[e(c,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:t(()=>[l(" Go to previous page of this assignment ")]),_:1})]),_:1})]),_:1},8,["style"]),this.store.ck!==null&&(this.store.aid===null||this.store.aid===-1)?(a(),k(u,{key:0,"no-caps":"",class:"dash-button on-right",onClick:o[4]||(o[4]=r=>this.copyCourseKeyCB()),icon:"content_copy"},{default:t(()=>[e(p,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:t(()=>[e(c,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:t(()=>[l(" Copy the course-key to clipboard, then"),ve,l(" share the course-key with whoever you"),xe,l(" want to enroll. ")]),_:1})]),_:1})]),_:1})):b("",!0),this.store.aid!==null&&this.store.aid>-1&&this.store.currentAssignment.pages.length>0?(a(),k(u,{key:1,"no-caps":"",class:"dash-button on-right",onClick:o[5]||(o[5]=r=>this.viewerCB()),icon:"smart_display"},{default:t(()=>[e(p,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:t(()=>[e(c,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:t(()=>[l(" See assignment in Viewer ")]),_:1})]),_:1})]),_:1})):b("",!0),e(u,{"no-caps":"",class:"on-right dash-button",onClick:o[6]||(o[6]=r=>this.store.currentCourse.coverUrl=this.store.currentAssignment.coverUrl),icon:"wallpaper"},{default:t(()=>[e(p,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:t(()=>[e(c,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:t(()=>[l(" Make the image currently showing to be"),we,l("the cover image for this course ")]),_:1})]),_:1})]),_:1}),e(u,{"no-caps":"",class:"on-right dash-button",icon:"table_chart",onClick:o[7]||(o[7]=r=>this.toggleGradebook())},{default:t(()=>[e(p,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:t(()=>[e(c,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:t(()=>[l(" View course gradebook ")]),_:1})]),_:1})]),_:1}),e(u,{"no-caps":"",icon:"add",class:"on-right dash-button",onClick:o[8]||(o[8]=r=>this.store.newAssignment())},{default:t(()=>[e(p,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:t(()=>[e(c,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:t(()=>[l(" Create a new assignment under this course ")]),_:1})]),_:1})]),_:1}),this.store.ck!==null?(a(),k(u,{key:2,"no-caps":"",icon:"edit",class:"on-right dash-button",onClick:o[9]||(o[9]=r=>this.editCB())},{default:t(()=>[e(p,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:t(()=>[e(c,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:t(()=>[l(" Go to the assignment editor"),Ve,l(" where you can add and edit pages"),qe,l(" (text and images) for reading. ")]),_:1})]),_:1})]),_:1})):b("",!0),e(u,{"no-caps":"",icon:"save",class:"on-right dash-button",onClick:o[10]||(o[10]=r=>this.store.commitCourse(this.store.ck))},{default:t(()=>[e(p,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:t(()=>[e(c,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:t(()=>[l(" Save current course to cloud ")]),_:1})]),_:1})]),_:1}),e(u,{"no-caps":"",icon:"delete",class:"on-right dash-button",onClick:o[11]||(o[11]=r=>i.confirm=!0)},{default:t(()=>[e(p,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:t(()=>[e(c,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:t(()=>[l(" Delete the selected object (Course or Assignment) ")]),_:1})]),_:1})]),_:1}),e(u,{push:"",round:"",class:"on-right dash-button","text-color":"white",icon:"arrow_right",style:q({height:"33.5px",width:"33.5px"}),onClick:o[12]||(o[12]=r=>i.$refs.carousel.next())},{default:t(()=>[e(p,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:t(()=>[e(c,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:t(()=>[l(" Go to next page of this assignment ")]),_:1})]),_:1})]),_:1},8,["style"])])]),_:1})]),default:t(()=>[(a(!0),d(_,null,y(this.store.courses,(r,g)=>(a(),k(T,{class:"text-panel row content-center justify-center",key:g,name:g,"img-src":r.coverUrl},{default:t(()=>[this.showGradebook?(a(),d("table",Z,[e(S,null,{default:t(()=>[l("Course Gradebook")]),_:1}),s("tr",null,[s("td",J,[s("table",X,[Y,s("tr",null,[ee,(a(!0),d(_,null,y(this.store.courses[this.store.ck].assignments,(n,m)=>(a(),d("th",{key:n,class:"key"},[l(h(n.title)+" ",1),s("span",te,h(m),1)]))),128))]),(a(!0),d(_,null,y(this.store.courses[this.store.ck].enrollment,n=>(a(),d("tr",{key:n.name},[s("td",se,[l(h(n.name)+" ",1),s("span",oe,h(i.sidx),1)]),(a(!0),d(_,null,y(this.store.courses[this.store.ck].assignments,m=>(a(),d("td",{class:"val",key:m},[m.scores&&m.scores[n.emailKey]?(a(),d("span",le,h(m.scores[n.emailKey]),1)):(a(),d("span",ae,"-")),l(),s("span",re,h(i.aidx),1)]))),128))]))),128))])])])])):(a(),d("table",ne,[e(S,null,{default:t(()=>[l("Course")]),_:1}),s("tr",null,[s("td",ie,[s("table",de,[s("tr",null,[ue,s("td",ce,[s("div",he,[l(h(this.store.currentCourse.title)+" ",1),e(w,{modelValue:this.store.courses[this.store.ck].title,"onUpdate:modelValue":n=>this.store.courses[this.store.ck].title=n,"auto-save":""},{default:t(n=>[e(x,{modelValue:n.value,"onUpdate:modelValue":m=>n.value=m,clearable:"",dense:"",autofocus:"",counter:"",onKeyup:v(n.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1032,["modelValue","onUpdate:modelValue"])])])]),s("tr",null,[me,s("td",null,[s("div",pe,[l(" Change "),e(w,{modelValue:this.store.courses[this.store.ck].coverUrl,"onUpdate:modelValue":n=>this.store.courses[this.store.ck].coverUrl=n,"auto-save":""},{default:t(n=>[e(x,{modelValue:n.value,"onUpdate:modelValue":m=>n.value=m,clearable:"",dense:"",autofocus:"",counter:"",onKeyup:v(n.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1032,["modelValue","onUpdate:modelValue"])])])]),s("tr",null,[fe,s("td",_e,h(Object.keys(this.store.currentCourse.assignments).length),1)]),s("tr",null,[ge,s("td",be,h(Object.keys(this.store.currentCourse.enrollment).length),1)]),s("tr",null,[ke,s("td",ye,h(this.store.currentCourse.updated.split("-")[0]),1)])])])])]))]),_:2},1032,["name","img-src"]))),128))]),_:1},8,["autoplay","modelValue","onUpdate:modelValue"])])])):(a(),d("div",F,[e(c,{flat:"",bordered:"",class:"text-panel"},{default:t(()=>[e(U,{class:"text-center"},{default:t(()=>[l(" Welcome to Reading Edge! "),M,l(" Please select or create a course ")]),_:1})]),_:1})]))]}),_:1})],64)}var We=$(N,[["render",Ue]]);export{We as default};
