import{_ as $,d as z,v as x,o as r,E as n,a as s,w as o,I as _,aI as K,U as w,Q as h,G as a,F as e,ai as i,T as g,H as U,c as C,V as y,R as k}from"./index.a75cd14a.js";import{Q as q}from"./QCardSection.ec128f6d.js";import{Q as G,a as B,C as Q}from"./ClosePopup.2ad056f1.js";import{Q as m}from"./QCard.1958fbd9.js";import{Q as b}from"./QInput.528bd173.js";import{Q as v,a as j,b as A,c as S}from"./QCarousel.3b2068f3.js";import{Q as V}from"./QBar.65eb28d8.js";import{Q as p}from"./QTooltip.09e64520.js";import{Q as D}from"./QPage.71c951c0.js";import{u as T}from"./store.cfec8d35.js";import{c as O}from"./copy-to-clipboard.8135b7c2.js";import"./use-prevent-scroll.bc690f37.js";import"./scroll.ab0372d2.js";import"./use-model-toggle.a1d88a19.js";import"./focusout.10e086b2.js";import"./use-dark.66025dda.js";import"./uid.42677368.js";import"./use-form.9c806992.js";import"./QMenu.e8aaec7b.js";import"./position-engine.61bb1987.js";import"./touch.d2ed2c9a.js";import"./firebase.f7873474.js";import"./axios.84ae42e4.js";const I=z({name:"CoursesDashboard",setup(){return{store:T(),slide:x(null),confirm:x(!1),showGradebook:x(!1)}},mounted(){console.log("CoursesDashboard mounted"),this.store.ck&&!this.store.aid&&(this.store.aid=-1),this.slide=this.store.aid},methods:{toggleGradebook(){console.log("toggleGradebook"),this.showGradebook?this.showGradebook=!1:this.showGradebook=!0},deleteSelectedObject(){this.store.aid!==null&&this.store.aid>-1?this.store.deleteAssignment(this.store.ck,this.store.aid):this.store.ck!==null&&this.store.deleteCourse(this.store.ck)},editCB(){this.store.aid!==null&&(this.store.pgIdx=-1),this.store.router.push("/assignments")},slideChanged(u){console.log("CourseDashboard.slideChanged aid = ",u),this.store.aid=u},viewerCB(){if(console.log("CourseDash viewerCB setting pgIdx 0 before /viewer"),this.store.currentAssignment.pages.length===0){this.store.notify("The requested assignment has no pages!");return}this.store.pgIdx=0,this.store.router.replace("/viewer")},copyCourseKeyCB(){O(this.store.ck).then(()=>{console.log("ck copied to clipboard",this.store.ck);const u=`The course-key ${this.store.ck} was copied to clipboard`;this.store.notify(u)}).catch(u=>{console.log(u)})}}}),E={key:0,class:"q-ml-sm"},P={key:1,class:"q-ml-sm"},N={key:0},F=e("br",null,null,-1),R={key:1,class:"justify-center absolute-top"},W={class:"text-panel justify-center q-mx-md q-mb-xs q-mt-md"},H={class:"cursor-pointer"},L={class:"q-px-md row content-center"},M={key:0,class:"embed-panel col-12 col-md-11 assignment",style:{"z-index":"5","max-height":"30vh",height:"30vh"}},J={class:"q-px-lg row content-start"},X={width:"100%",class:"meta-table"},Y=e("tr",null,[e("th",{colSpan:"100"},[e("div",{class:"text-center val"},"Assignments")])],-1),Z=e("th",{class:"val"},"Student",-1),ee={class:"hidden"},te={class:"key"},se={class:"hidden"},oe={key:0},le={key:1},ae={class:"hidden"},re={key:1,class:"embed-panel col-12 col-md-5 assignment",style:{"z-index":"5","max-height":"30vh",height:"30vh"}},ne={class:"q-px-lg row content-start"},ie={class:"meta-table"},de=e("th",{class:"key"},"Title",-1),ue={class:"val"},ce={class:"cursor-pointer"},he=e("td",{class:"key"},"Cover Url",-1),me={class:"cursor-pointer val"},pe=e("td",{class:"key"},"Assignments",-1),_e={class:"val"},fe=e("td",{class:"key"},"Enrollment",-1),ge={class:"val"},ye=e("td",{class:"key"},"Updated",-1),ke={class:"val"},be={class:"embed-panel col-12 col-md-5 assignment",style:{"z-index":"5","max-height":"30vh",height:"30vh"}},ve={class:"q-px-lg row content-start"},Ce={class:"meta-table"},xe=e("th",{class:"key"},"Title",-1),Ve={class:"val"},we={class:"cursor-pointer"},Ue=e("th",{class:"key"},"Cover Url",-1),qe={class:"val"},Qe={class:"cursor-pointer"},Se=e("th",{class:"key"},"Pages",-1),$e={class:"val"},ze={key:0},Ke={key:1},Ge=e("th",{class:"key"},"Goal",-1),Be={class:"val"},je={key:0},Ae=e("th",{class:"key"},"Scores",-1),De={class:"val"},Te={key:0},Oe=e("br",null,null,-1),Ie=e("th",{class:"key"},"Updated",-1),Ee={class:"val"},Pe={class:"control-panel q-pa-sm row justify-center no-wrap flex flex-center assignment",style:{overflow:"auto"}},Ne=e("br",null,null,-1),Fe=e("br",null,null,-1),Re=e("br",null,null,-1),We=e("br",null,null,-1),He=e("br",null,null,-1);function Le(u,l,Me,Je,Xe,Ye){return r(),n(_,null,[s(G,{modelValue:u.confirm,"onUpdate:modelValue":l[1]||(l[1]=t=>u.confirm=t),persistent:"",class:"z-max"},{default:o(()=>[s(m,null,{default:o(()=>[s(q,{class:"row items-center"},{default:o(()=>[s(K,{icon:"delete",color:"primary","text-color":"white"}),this.store.aid!==null&&this.store.aid>-1?(r(),n("span",E,"Confirm delete assignment?")):(r(),n("span",P,"Confirm delete entire course?"))]),_:1}),s(B,{align:"right",class:"text-white"},{default:o(()=>[w(s(h,{flat:"",label:"Cancel"},null,512),[[Q]]),w(s(h,{flat:"",label:"Delete",onClick:l[0]||(l[0]=t=>this.deleteSelectedObject())},null,512),[[Q]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(D,{class:"flex flex-center"},{default:o(()=>[this.store.ck?(r(),n("div",R,[e("div",W,[a(" Course: "),e("span",H,[a(i(this.store.currentCourse.title)+" ",1),s(v,{modelValue:this.store.currentCourse.title,"onUpdate:modelValue":l[2]||(l[2]=t=>this.store.currentCourse.title=t),"auto-save":"",style:{maxWidth:"320px"}},{default:o(t=>[s(b,{modelValue:t.value,"onUpdate:modelValue":d=>t.value=d,clearable:"",dense:"",autofocus:"",counter:"",onKeyup:g(t.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:1},8,["modelValue"])])]),e("div",L,[s(j,{class:"q-ma-md full-width",animated:"",swipeable:"",thumbnails:"",autoplay:this.store.autoplay,"navigation-position":"top",modelValue:this.store.aid,"onUpdate:modelValue":[l[15]||(l[15]=t=>this.store.aid=t),this.slideChanged],infinite:"","control-type":"arrows",ref:"carousel",height:"85vh"},{control:o(()=>[s(A,{position:"bottom",offset:[0,0]},{default:o(()=>[e("div",Pe,[s(h,{push:"",round:"",class:"dash-button","text-color":"white",icon:"arrow_left",style:U({height:"33.5px",width:"33.5px"}),onClick:l[5]||(l[5]=t=>u.$refs.carousel.previous())},{default:o(()=>[s(p,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:o(()=>[s(m,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:o(()=>[a(" Go to next previous of this assignment ")]),_:1})]),_:1})]),_:1},8,["style"]),this.store.ck!==null&&(this.store.aid===null||this.store.aid===-1)?(r(),C(h,{key:0,"no-caps":"",class:"dash-button on-right",onClick:l[6]||(l[6]=t=>this.copyCourseKeyCB()),icon:"content_copy"},{default:o(()=>[s(p,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:o(()=>[s(m,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:o(()=>[a(" Copy the course-key to clipboard, then"),Ne,a(" share the course-key with whoever you"),Fe,a(" want to enroll. ")]),_:1})]),_:1})]),_:1})):y("",!0),this.store.aid!==null&&this.store.aid>-1&&this.store.currentAssignment.pages.length>0?(r(),C(h,{key:1,"no-caps":"",class:"dash-button on-right",onClick:l[7]||(l[7]=t=>this.viewerCB()),icon:"smart_display"},{default:o(()=>[s(p,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:o(()=>[s(m,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:o(()=>[a(" See assignment in Viewer ")]),_:1})]),_:1})]),_:1})):y("",!0),s(h,{"no-caps":"",class:"on-right dash-button",onClick:l[8]||(l[8]=t=>this.store.currentCourse.coverUrl=this.store.currentAssignment.coverUrl),icon:"wallpaper"},{default:o(()=>[s(p,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:o(()=>[s(m,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:o(()=>[a(" Make the image currently showing to be"),Re,a("the cover image for this course ")]),_:1})]),_:1})]),_:1}),s(h,{"no-caps":"",class:"on-right dash-button",icon:"table_chart",onClick:l[9]||(l[9]=t=>this.toggleGradebook())},{default:o(()=>[s(p,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:o(()=>[s(m,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:o(()=>[a(" View course gradebook ")]),_:1})]),_:1})]),_:1}),s(h,{"no-caps":"",icon:"add",class:"on-right dash-button",onClick:l[10]||(l[10]=t=>this.store.newAssignment())},{default:o(()=>[s(p,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:o(()=>[s(m,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:o(()=>[a(" Create a new assignment under this course ")]),_:1})]),_:1})]),_:1}),this.store.aid!==null&&this.store.aid>-1?(r(),C(h,{key:2,"no-caps":"",icon:"edit",class:"on-right dash-button",onClick:l[11]||(l[11]=t=>this.editCB())},{default:o(()=>[s(p,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:o(()=>[s(m,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:o(()=>[a(" Go to the assignment editor"),We,a(" where you can add and edit pages"),He,a(" (text and images) for reading. ")]),_:1})]),_:1})]),_:1})):y("",!0),s(h,{"no-caps":"",icon:"save",class:"on-right dash-button",onClick:l[12]||(l[12]=t=>this.store.commitCourse(this.store.ck))},{default:o(()=>[s(p,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:o(()=>[s(m,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:o(()=>[a(" Save current course to cloud ")]),_:1})]),_:1})]),_:1}),s(h,{"no-caps":"",icon:"delete",class:"on-right dash-button",onClick:l[13]||(l[13]=t=>u.confirm=!0)},{default:o(()=>[s(p,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:o(()=>[s(m,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:o(()=>[a(" Delete the selected object (Course or Assignment) ")]),_:1})]),_:1})]),_:1}),s(h,{push:"",round:"",class:"on-right dash-button","text-color":"white",icon:"arrow_right",style:U({height:"33.5px",width:"33.5px"}),onClick:l[14]||(l[14]=t=>u.$refs.carousel.next())},{default:o(()=>[s(p,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:o(()=>[s(m,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:o(()=>[a(" Go to next page of this assignment ")]),_:1})]),_:1})]),_:1},8,["style"])])]),_:1})]),default:o(()=>[s(S,{class:"text-panel row content-center justify-center",name:-1,"img-src":this.store.currentCourse.coverUrl},{default:o(()=>[this.showGradebook?(r(),n("table",M,[s(V,null,{default:o(()=>[a("Course Gradebook")]),_:1}),e("tr",null,[e("td",J,[e("table",X,[Y,e("tr",null,[Z,(r(!0),n(_,null,k(this.store.courses[this.store.ck].assignments,(t,d)=>(r(),n("th",{key:t,class:"key"},[a(i(t.title)+" ",1),e("span",ee,i(d),1)]))),128))]),(r(!0),n(_,null,k(this.store.courses[this.store.ck].enrollment,t=>(r(),n("tr",{key:t.name},[e("td",te,[a(i(t.name)+" ",1),e("span",se,i(u.sidx),1)]),(r(!0),n(_,null,k(this.store.courses[this.store.ck].assignments,d=>(r(),n("td",{class:"val",key:d},[d.scores&&d.scores[t.emailKey]?(r(),n("span",oe,i(d.scores[t.emailKey]),1)):(r(),n("span",le,"-")),a(),e("span",ae,i(u.aidx),1)]))),128))]))),128))])])])])):(r(),n("table",re,[s(V,null,{default:o(()=>[a("Course")]),_:1}),e("tr",null,[e("td",ne,[e("table",ie,[e("tr",null,[de,e("td",ue,[e("div",ce,[a(i(this.store.currentCourse.title)+" ",1),s(v,{modelValue:this.store.courses[this.store.ck].title,"onUpdate:modelValue":l[3]||(l[3]=t=>this.store.courses[this.store.ck].title=t),"auto-save":""},{default:o(t=>[s(b,{modelValue:t.value,"onUpdate:modelValue":d=>t.value=d,clearable:"",dense:"",autofocus:"",counter:"",onKeyup:g(t.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:1},8,["modelValue"])])])]),e("tr",null,[he,e("td",null,[e("div",me,[a(" Change "),s(v,{modelValue:this.store.courses[this.store.ck].coverUrl,"onUpdate:modelValue":l[4]||(l[4]=t=>this.store.courses[this.store.ck].coverUrl=t),"auto-save":""},{default:o(t=>[s(b,{modelValue:t.value,"onUpdate:modelValue":d=>t.value=d,clearable:"",dense:"",autofocus:"",counter:"",onKeyup:g(t.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:1},8,["modelValue"])])])]),e("tr",null,[pe,e("td",_e,i(Object.keys(this.store.currentCourse.assignments).length),1)]),e("tr",null,[fe,e("td",ge,i(Object.keys(this.store.currentCourse.enrollment).length),1)]),e("tr",null,[ye,e("td",ke,i(this.store.currentCourse.updated.split("-")[0]),1)])])])])]))]),_:1},8,["img-src"]),(r(!0),n(_,null,k(this.store.currentCourse.assignments,(t,d)=>(r(),C(S,{class:"text-panel items-center row justify-center",key:d,name:d,"img-src":t.coverUrl},{default:o(()=>[e("table",be,[s(V,null,{default:o(()=>[a("Assignment")]),_:1}),e("tr",null,[e("td",ve,[e("table",Ce,[e("tr",null,[xe,e("td",Ve,[e("div",we,[a(i(t.title)+" ",1),s(v,{modelValue:t.title,"onUpdate:modelValue":c=>t.title=c,"auto-save":""},{default:o(c=>[s(b,{modelValue:c.value,"onUpdate:modelValue":f=>c.value=f,clearable:"",dense:"",autofocus:"",counter:"",onKeyup:g(c.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1032,["modelValue","onUpdate:modelValue"])])])]),e("tr",null,[Ue,e("td",qe,[e("div",Qe,[a(" Change "),s(v,{modelValue:t.coverUrl,"onUpdate:modelValue":c=>t.coverUrl=c,"auto-save":""},{default:o(c=>[s(b,{modelValue:c.value,"onUpdate:modelValue":f=>c.value=f,clearable:"",dense:"",autofocus:"",counter:"",onKeyup:g(c.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1032,["modelValue","onUpdate:modelValue"])])])]),e("tr",null,[Se,e("td",$e,[t.pages?(r(),n("span",ze,i(t.pages.length),1)):(r(),n("span",Ke,"0"))])]),e("tr",null,[Ge,e("td",Be,i(t.goal),1)]),this.store.role==="teacher"?(r(),n("tr",je,[Ae,e("td",De,[Object.keys(t).indexOf("scores")>-1?(r(),n("span",Te,[(r(!0),n(_,null,k(Object.entries(t.scores),(c,f)=>(r(),n("span",{key:f},[a(i(c[0].split("_")[0])+" "+i(c[1]),1),Oe]))),128))])):y("",!0)])])):y("",!0),e("tr",null,[Ie,e("td",Ee,i(t.updated.split("-")[0]),1)])])])])])]),_:2},1032,["name","img-src"]))),128))]),_:1},8,["autoplay","modelValue","onUpdate:modelValue"])])])):(r(),n("div",N,[s(m,{flat:"",bordered:"",class:"text-panel"},{default:o(()=>[s(q,{class:"text-center"},{default:o(()=>[a(" Welcome to Reading Edge! "),F,a(" Please select or create a course ")]),_:1})]),_:1})]))]),_:1})],64)}var Ct=$(I,[["render",Le]]);export{Ct as default};
