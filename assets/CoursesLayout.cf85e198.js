import{u as useFormProps,a as useFormAttrs,b as useFormInject,Q as QCardSection,c as QCardActions,d as QDialog,C as ClosePopup}from"./ClosePopup.0dad2a74.js";import{Q as QInput,a as QBar}from"./QMenu.2c7912a2.js";import{c as createComponent,r as ref,a as computed,a8 as debounce,w as watch,a5 as onDeactivated,a9 as onActivated,o as onBeforeUnmount,d as h,h as hMergeSlot,aa as withDirectives,g as getCurrentInstance,ab as between,e as emptyRenderFn,f as inject,y as hSlot,l as layoutKey,j as defineComponent,_ as _export_sfc,p as resolveComponent,k as openBlock,F as createElementBlock,H as Fragment,ac as renderList,q as createVNode,n as withCtx,ad as QIcon,G as createTextVNode,s as createBaseVNode,ae as toDisplayString,af as createCommentVNode,m as createBlock,J as pad,X as Transition,ag as isObject$1,v as nextTick,Q as QBtn,ah as Plugin,ai as withKeys,P as Plugin$1,aj as Plugin$2}from"./index.e0ed5d15.js";import{Q as QCard}from"./QCard.2ef7ad1b.js";import{Q as QSpace,a as QHeader,b as QToolbar,c as QDrawer}from"./QDrawer.cf01886d.js";import{Q as QTooltip}from"./QTooltip.e7c5d8f4.js";import{u as useDarkProps,a as useDark}from"./use-dark.93889d4b.js";import{Q as QResizeObserver,c as QScrollObserver,a as QLayout,b as QPageContainer}from"./QLayout.34f2b775.js";import{T as TouchPan}from"./TouchPan.1d805f86.js";import{s as setVerticalScrollPosition,d as setHorizontalScrollPosition}from"./scroll.0dd20117.js";import{u as useStore,t as toJalaali,a as toGregorian,f as formatDate,g as getDateDiff,j as jalaaliMonthLength,_ as __splitDate,d as date}from"./store.23bb025d.js";import{T as TileComponent,P as PreferencesComponent,I as ImagePager}from"./PreferencesComponent.48bc3c6a.js";import{u as useCache}from"./use-cache.b0833c75.js";import{Q as QKnob,a as QSelect}from"./QSelect.7d9691f6.js";import{Q as QExpansionItem}from"./QExpansionItem.00946f6b.js";import{Q as QBadge}from"./QBadge.0dbba036.js";import{Q as QList}from"./QList.d254e59c.js";import"./transform.9aa67f3e.js";import{s as selectAll}from"./selectAll.be636dd1.js";import{s as select}from"./select.9628a1e9.js";import{Q as QMarkupTable}from"./QMarkupTable.ad1ab29f.js";import{o as openDB,l as __extends,m as __rest$2,w as wh,f as sh,n as uf,p as cf,q as rh,J as Jl,_ as _l,E as El,e as dl,t as tf,v as getApp$1}from"./firebase.dc843dde.js";import{Q as QImg}from"./QImg.99a58e64.js";import"./use-prevent-scroll.d6087bc7.js";import"./use-timeout.46f6aa6f.js";import"./use-tick.e7102873.js";import"./use-model-toggle.830ede05.js";import"./QItemLabel.93e90401.js";import"./selection.8f674345.js";import"./touch.70a9dd44.js";import"./axios.84ae42e4.js";import"./QToggle.4930c4c1.js";import"./use-checkbox.c2137da8.js";var commonjsGlobal=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};const axisList=["vertical","horizontal"],dirProps={vertical:{offset:"offsetY",scroll:"scrollTop",dir:"down",dist:"y"},horizontal:{offset:"offsetX",scroll:"scrollLeft",dir:"right",dist:"x"}},panOpts={prevent:!0,mouse:!0,mouseAllDir:!0},getMinThumbSize=t=>t>=250?50:Math.ceil(t/5);var QScrollArea=createComponent({name:"QScrollArea",props:{...useDarkProps,thumbStyle:Object,verticalThumbStyle:Object,horizontalThumbStyle:Object,barStyle:[Array,String,Object],verticalBarStyle:[Array,String,Object],horizontalBarStyle:[Array,String,Object],contentStyle:[Array,String,Object],contentActiveStyle:[Array,String,Object],delay:{type:[String,Number],default:1e3},visible:{type:Boolean,default:null},tabindex:[String,Number],onScroll:Function},setup(t,{slots:e,emit:r}){const n=ref(!1),o=ref(!1),a=ref(!1),s={vertical:ref(0),horizontal:ref(0)},i={vertical:{ref:ref(null),position:ref(0),size:ref(0)},horizontal:{ref:ref(null),position:ref(0),size:ref(0)}},{proxy:d}=getCurrentInstance(),g=useDark(t,d.$q);let l=null,c;const p=ref(null),v=computed(()=>"q-scrollarea"+(g.value===!0?" q-scrollarea--dark":""));i.vertical.percentage=computed(()=>{const w=i.vertical.size.value-s.vertical.value;if(w<=0)return 0;const C=between(i.vertical.position.value/w,0,1);return Math.round(C*1e4)/1e4}),i.vertical.thumbHidden=computed(()=>(t.visible===null?a.value:t.visible)!==!0&&n.value===!1&&o.value===!1||i.vertical.size.value<=s.vertical.value+1),i.vertical.thumbStart=computed(()=>i.vertical.percentage.value*(s.vertical.value-i.vertical.thumbSize.value)),i.vertical.thumbSize=computed(()=>Math.round(between(s.vertical.value*s.vertical.value/i.vertical.size.value,getMinThumbSize(s.vertical.value),s.vertical.value))),i.vertical.style=computed(()=>({...t.thumbStyle,...t.verticalThumbStyle,top:`${i.vertical.thumbStart.value}px`,height:`${i.vertical.thumbSize.value}px`})),i.vertical.thumbClass=computed(()=>"q-scrollarea__thumb q-scrollarea__thumb--v absolute-right"+(i.vertical.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),i.vertical.barClass=computed(()=>"q-scrollarea__bar q-scrollarea__bar--v absolute-right"+(i.vertical.thumbHidden.value===!0?" q-scrollarea__bar--invisible":"")),i.horizontal.percentage=computed(()=>{const w=i.horizontal.size.value-s.horizontal.value;if(w<=0)return 0;const C=between(Math.abs(i.horizontal.position.value)/w,0,1);return Math.round(C*1e4)/1e4}),i.horizontal.thumbHidden=computed(()=>(t.visible===null?a.value:t.visible)!==!0&&n.value===!1&&o.value===!1||i.horizontal.size.value<=s.horizontal.value+1),i.horizontal.thumbStart=computed(()=>i.horizontal.percentage.value*(s.horizontal.value-i.horizontal.thumbSize.value)),i.horizontal.thumbSize=computed(()=>Math.round(between(s.horizontal.value*s.horizontal.value/i.horizontal.size.value,getMinThumbSize(s.horizontal.value),s.horizontal.value))),i.horizontal.style=computed(()=>({...t.thumbStyle,...t.horizontalThumbStyle,[d.$q.lang.rtl===!0?"right":"left"]:`${i.horizontal.thumbStart.value}px`,width:`${i.horizontal.thumbSize.value}px`})),i.horizontal.thumbClass=computed(()=>"q-scrollarea__thumb q-scrollarea__thumb--h absolute-bottom"+(i.horizontal.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),i.horizontal.barClass=computed(()=>"q-scrollarea__bar q-scrollarea__bar--h absolute-bottom"+(i.horizontal.thumbHidden.value===!0?" q-scrollarea__bar--invisible":""));const P=computed(()=>i.vertical.thumbHidden.value===!0&&i.horizontal.thumbHidden.value===!0?t.contentStyle:t.contentActiveStyle),k=[[TouchPan,w=>{B(w,"vertical")},void 0,{vertical:!0,...panOpts}]],S=[[TouchPan,w=>{B(w,"horizontal")},void 0,{horizontal:!0,...panOpts}]];function M(){const w={};return axisList.forEach(C=>{const T=i[C];w[C+"Position"]=T.position.value,w[C+"Percentage"]=T.percentage.value,w[C+"Size"]=T.size.value,w[C+"ContainerSize"]=s[C].value}),w}const K=debounce(()=>{const w=M();w.ref=d,r("scroll",w)},0);function D(w,C,T){if(axisList.includes(w)===!1){console.error("[QScrollArea]: wrong first param of setScrollPosition (vertical/horizontal)");return}(w==="vertical"?setVerticalScrollPosition:setHorizontalScrollPosition)(p.value,C,T)}function E({height:w,width:C}){let T=!1;s.vertical.value!==w&&(s.vertical.value=w,T=!0),s.horizontal.value!==C&&(s.horizontal.value=C,T=!0),T===!0&&x()}function R({position:w}){let C=!1;i.vertical.position.value!==w.top&&(i.vertical.position.value=w.top,C=!0),i.horizontal.position.value!==w.left&&(i.horizontal.position.value=w.left,C=!0),C===!0&&x()}function H({height:w,width:C}){i.horizontal.size.value!==C&&(i.horizontal.size.value=C,x()),i.vertical.size.value!==w&&(i.vertical.size.value=w,x())}function B(w,C){const T=i[C];if(w.isFirst===!0){if(T.thumbHidden.value===!0)return;c=T.position.value,o.value=!0}else if(o.value!==!0)return;w.isFinal===!0&&(o.value=!1);const $=dirProps[C],G=s[C].value,Y=(T.size.value-G)/(G-T.thumbSize.value),ne=w.distance[$.dist],ie=c+(w.direction===$.dir?1:-1)*ne*Y;re(ie,C)}function Q(w,C){const T=i[C];if(T.thumbHidden.value!==!0){const $=w[dirProps[C].offset];if($<T.thumbStart.value||$>T.thumbStart.value+T.thumbSize.value){const G=$-T.thumbSize.value/2;re(G/s[C].value*T.size.value,C)}T.ref.value!==null&&T.ref.value.dispatchEvent(new MouseEvent(w.type,w))}}function U(w){Q(w,"vertical")}function z(w){Q(w,"horizontal")}function x(){n.value=!0,l!==null&&clearTimeout(l),l=setTimeout(()=>{l=null,n.value=!1},t.delay),t.onScroll!==void 0&&K()}function re(w,C){p.value[dirProps[C].scroll]=w}function F(){a.value=!0}function j(){a.value=!1}let q=null;return watch(()=>d.$q.lang.rtl,w=>{p.value!==null&&setHorizontalScrollPosition(p.value,Math.abs(i.horizontal.position.value)*(w===!0?-1:1))}),onDeactivated(()=>{q={top:i.vertical.position.value,left:i.horizontal.position.value}}),onActivated(()=>{if(q===null)return;const w=p.value;w!==null&&(setHorizontalScrollPosition(w,q.left),setVerticalScrollPosition(w,q.top))}),onBeforeUnmount(K.cancel),Object.assign(d,{getScrollTarget:()=>p.value,getScroll:M,getScrollPosition:()=>({top:i.vertical.position.value,left:i.horizontal.position.value}),getScrollPercentage:()=>({top:i.vertical.percentage.value,left:i.horizontal.percentage.value}),setScrollPosition:D,setScrollPercentage(w,C,T){D(w,C*(i[w].size.value-s[w].value)*(w==="horizontal"&&d.$q.lang.rtl===!0?-1:1),T)}}),()=>h("div",{class:v.value,onMouseenter:F,onMouseleave:j},[h("div",{ref:p,class:"q-scrollarea__container scroll relative-position fit hide-scrollbar",tabindex:t.tabindex!==void 0?t.tabindex:void 0},[h("div",{class:"q-scrollarea__content absolute",style:P.value},hMergeSlot(e.default,[h(QResizeObserver,{debounce:0,onResize:H})])),h(QScrollObserver,{axis:"both",onScroll:R})]),h(QResizeObserver,{debounce:0,onResize:E}),h("div",{class:i.vertical.barClass.value,style:[t.barStyle,t.verticalBarStyle],"aria-hidden":"true",onMousedown:U}),h("div",{class:i.horizontal.barClass.value,style:[t.barStyle,t.horizontalBarStyle],"aria-hidden":"true",onMousedown:z}),withDirectives(h("div",{ref:i.vertical.ref,class:i.vertical.thumbClass.value,style:i.vertical.style.value,"aria-hidden":"true"}),k),withDirectives(h("div",{ref:i.horizontal.ref,class:i.horizontal.thumbClass.value,style:i.horizontal.style.value,"aria-hidden":"true"}),S)])}});const usePageStickyProps={position:{type:String,default:"bottom-right",validator:t=>["top-right","top-left","bottom-right","bottom-left","top","right","bottom","left"].includes(t)},offset:{type:Array,validator:t=>t.length===2},expand:Boolean};function usePageSticky(){const{props:t,proxy:{$q:e}}=getCurrentInstance(),r=inject(layoutKey,emptyRenderFn);if(r===emptyRenderFn)return console.error("QPageSticky needs to be child of QLayout"),emptyRenderFn;const n=computed(()=>{const c=t.position;return{top:c.indexOf("top")>-1,right:c.indexOf("right")>-1,bottom:c.indexOf("bottom")>-1,left:c.indexOf("left")>-1,vertical:c==="top"||c==="bottom",horizontal:c==="left"||c==="right"}}),o=computed(()=>r.header.offset),a=computed(()=>r.right.offset),s=computed(()=>r.footer.offset),i=computed(()=>r.left.offset),d=computed(()=>{let c=0,p=0;const v=n.value,P=e.lang.rtl===!0?-1:1;v.top===!0&&o.value!==0?p=`${o.value}px`:v.bottom===!0&&s.value!==0&&(p=`${-s.value}px`),v.left===!0&&i.value!==0?c=`${P*i.value}px`:v.right===!0&&a.value!==0&&(c=`${-P*a.value}px`);const k={transform:`translate(${c}, ${p})`};return t.offset&&(k.margin=`${t.offset[1]}px ${t.offset[0]}px`),v.vertical===!0?(i.value!==0&&(k[e.lang.rtl===!0?"right":"left"]=`${i.value}px`),a.value!==0&&(k[e.lang.rtl===!0?"left":"right"]=`${a.value}px`)):v.horizontal===!0&&(o.value!==0&&(k.top=`${o.value}px`),s.value!==0&&(k.bottom=`${s.value}px`)),k}),g=computed(()=>`q-page-sticky row flex-center fixed-${t.position} q-page-sticky--${t.expand===!0?"expand":"shrink"}`);function l(c){const p=hSlot(c.default);return h("div",{class:g.value,style:d.value},t.expand===!0?p:[h("div",p)])}return{$layout:r,getStickyContent:l}}var QPageSticky=createComponent({name:"QPageSticky",props:usePageStickyProps,setup(t,{slots:e}){const{getStickyContent:r}=usePageSticky();return()=>r(e)}});const _sfc_main$7=defineComponent({name:"CoursePager",components:{TileComponent},props:[],setup(){return{store:useStore()}},methods:{}});function _sfc_render$7(t,e,r,n,o,a){const s=resolveComponent("TileComponent");return openBlock(),createElementBlock(Fragment,null,[(openBlock(!0),createElementBlock(Fragment,null,renderList(this.store.courses,(i,d)=>(openBlock(),createElementBlock("span",{key:d},[createVNode(s,{tileData:i,imgUrl:i.coverUrl,targetUrl:null,ck:d,aid:null,pgIdx:null,imgIdx:null,tileType:"course"},null,8,["tileData","imgUrl","ck"])]))),128)),createVNode(QCard,{flat:"",bordered:"",class:"q-ma-md q-pa-md cursor-pointer tile-component flex flex-center",onClick:e[0]||(e[0]=i=>this.store.newCourse())},{default:withCtx(()=>[createVNode(QIcon,{name:"add",class:"text-h1"}),createVNode(QTooltip,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:withCtx(()=>[createVNode(QCard,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:withCtx(()=>[createTextVNode(" Create a new course ")]),_:1})]),_:1})]),_:1})],64)}var CoursePager=_export_sfc(_sfc_main$7,[["render",_sfc_render$7]]);const _sfc_main$6=defineComponent({name:"AssignmentPager",components:{TileComponent},props:[],setup(){return{store:useStore()}},methods:{clickCB(t,e,r,n,o){console.log("clickCB",t,o),this.store.ck=t,this.store.aid=e,this.store.pgIdx=r,this.store.imgIdx=n}}}),_hoisted_1$6={class:"text-panel q-ma-md text-center text-h6"},_hoisted_2$6={key:0},_hoisted_3$4={key:0};function _sfc_render$6(t,e,r,n,o,a){const s=resolveComponent("TileComponent");return openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",_hoisted_1$6,[createTextVNode(" Assignments: "),this.store.currentCourse?(openBlock(),createElementBlock("span",_hoisted_2$6,toDisplayString(Object.keys(this.store.currentCourse.assignments).length),1)):createCommentVNode("",!0)]),this.store.currentCourse?(openBlock(),createElementBlock("span",_hoisted_3$4,[(openBlock(!0),createElementBlock(Fragment,null,renderList(this.store.currentCourse.assignments,(i,d)=>(openBlock(),createElementBlock("span",{key:d},[createVNode(s,{tileData:i,imgUrl:i.coverUrl,targetUrl:null,ck:this.store.ck,aid:d,pgIdx:null,imgIdx:null,tileType:"assignment"},null,8,["tileData","imgUrl","ck","aid"])]))),128))])):createCommentVNode("",!0),createVNode(QCard,{flat:"",bordered:"",class:"q-ma-md q-pa-md cursor-pointer tile-component flex flex-center",onClick:e[0]||(e[0]=i=>this.store.newAssignment())},{default:withCtx(()=>[createVNode(QIcon,{name:"add",class:"text-h1"}),createVNode(QTooltip,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:withCtx(()=>[createVNode(QCard,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:withCtx(()=>[createTextVNode(" Create a new assignment ")]),_:1})]),_:1})]),_:1})],64)}var AssignmentPager=_export_sfc(_sfc_main$6,[["render",_sfc_render$6]]);const _sfc_main$5=defineComponent({name:"PagePager",components:{TileComponent},props:[],setup(){const t=ref(null);return{store:useStore(),pagePagerScrollArea:t}},mounted(){watch(this.store.currentAssignment.pages,async(t,e)=>{console.log("newPage detected, scrolling to 1.0"),this.pagePagerScrollArea.setScrollPercentage("vertical",1)})},methods:{newPageCB(){this.store.newPage(),this.pagePagerScrollArea.setScrollPercentage("vertical",1)}}}),_hoisted_1$5={class:"text-panel q-ma-md text-center text-h6"},_hoisted_2$5={key:0};function _sfc_render$5(t,e,r,n,o,a){const s=resolveComponent("TileComponent");return openBlock(),createBlock(QScrollArea,{style:{height:"95vh"},ref:"pagePagerScrollArea"},{default:withCtx(()=>[createBaseVNode("div",_hoisted_1$5,"Pages: "+toDisplayString(this.store.currentAssignment.pages.length),1),this.store.currentCourse?(openBlock(),createElementBlock("span",_hoisted_2$5,[(openBlock(!0),createElementBlock(Fragment,null,renderList(this.store.currentAssignment.pages,(i,d)=>(openBlock(),createElementBlock("span",{key:d},[createVNode(s,{tileData:i,imgUrl:i.imgs&&i.imgs.length>0?i.imgs[i.imgIdx].url:"",targetUrl:null,ck:this.store.ck,aid:this.store.aid,pgIdx:d,imgIdx:i.imgIdx,tileType:"page"},null,8,["tileData","imgUrl","ck","aid","pgIdx","imgIdx"])]))),128))])):createCommentVNode("",!0),createVNode(QCard,{flat:"",bordered:"",class:"q-ma-md q-pa-md cursor-pointer tile-component flex flex-center",onClick:e[0]||(e[0]=i=>this.newPageCB())},{default:withCtx(()=>[createVNode(QIcon,{name:"add",class:"text-h1"}),createVNode(QTooltip,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:withCtx(()=>[createVNode(QCard,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:withCtx(()=>[createTextVNode(" Create a new page ")]),_:1})]),_:1})]),_:1})]),_:1},512)}var PagePager=_export_sfc(_sfc_main$5,[["render",_sfc_render$5]]);const calendars=["gregorian","persian"],useDatetimeProps={modelValue:{required:!0},mask:{type:String},locale:Object,calendar:{type:String,validator:t=>calendars.includes(t),default:"gregorian"},landscape:Boolean,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,readonly:Boolean,disable:Boolean},useDatetimeEmits=["update:modelValue"];function getDayHash(t){return t.year+"/"+pad(t.month)+"/"+pad(t.day)}function useDatetime(t,e){const r=computed(()=>t.disable!==!0&&t.readonly!==!0),n=computed(()=>r.value===!0?0:-1),o=computed(()=>{const i=[];return t.color!==void 0&&i.push(`bg-${t.color}`),t.textColor!==void 0&&i.push(`text-${t.textColor}`),i.join(" ")});function a(){return t.locale!==void 0?{...e.lang.date,...t.locale}:e.lang.date}function s(i){const d=new Date,g=i===!0?null:0;if(t.calendar==="persian"){const l=toJalaali(d);return{year:l.jy,month:l.jm,day:l.jd}}return{year:d.getFullYear(),month:d.getMonth()+1,day:d.getDate(),hour:g,minute:g,second:g,millisecond:g}}return{editable:r,tabindex:n,headerClass:o,getLocale:a,getCurrentDate:s}}const yearsInterval=20,views=["Calendar","Years","Months"],viewIsValid=t=>views.includes(t),yearMonthValidator=t=>/^-?[\d]+\/[0-1]\d$/.test(t),lineStr=" \u2014 ";function getMonthHash(t){return t.year+"/"+pad(t.month)}var QDate=createComponent({name:"QDate",props:{...useDatetimeProps,...useFormProps,...useDarkProps,multiple:Boolean,range:Boolean,title:String,subtitle:String,mask:{default:"YYYY/MM/DD"},defaultYearMonth:{type:String,validator:yearMonthValidator},yearsInMonthView:Boolean,events:[Array,Function],eventColor:[String,Function],emitImmediately:Boolean,options:[Array,Function],navigationMinYearMonth:{type:String,validator:yearMonthValidator},navigationMaxYearMonth:{type:String,validator:yearMonthValidator},noUnset:Boolean,firstDayOfWeek:[String,Number],todayBtn:Boolean,minimal:Boolean,defaultView:{type:String,default:"Calendar",validator:viewIsValid}},emits:[...useDatetimeEmits,"rangeStart","rangeEnd","navigation"],setup(t,{slots:e,emit:r}){const{proxy:n}=getCurrentInstance(),{$q:o}=n,a=useDark(t,o),{getCache:s}=useCache(),{tabindex:i,headerClass:d,getLocale:g,getCurrentDate:l}=useDatetime(t,o);let c;const p=useFormAttrs(t),v=useFormInject(p),P=ref(null),k=ref(we()),S=ref(g()),M=computed(()=>we()),K=computed(()=>g()),D=computed(()=>l()),E=ref(be(k.value,S.value)),R=ref(t.defaultView),H=o.lang.rtl===!0?"right":"left",B=ref(H.value),Q=ref(H.value),U=E.value.year,z=ref(U-U%yearsInterval-(U<0?yearsInterval:0)),x=ref(null),re=computed(()=>{const u=t.landscape===!0?"landscape":"portrait";return`q-date q-date--${u} q-date--${u}-${t.minimal===!0?"minimal":"standard"}`+(a.value===!0?" q-date--dark q-dark":"")+(t.bordered===!0?" q-date--bordered":"")+(t.square===!0?" q-date--square no-border-radius":"")+(t.flat===!0?" q-date--flat no-shadow":"")+(t.disable===!0?" disabled":t.readonly===!0?" q-date--readonly":"")}),F=computed(()=>t.color||"primary"),j=computed(()=>t.textColor||"white"),q=computed(()=>t.emitImmediately===!0&&t.multiple!==!0&&t.range!==!0),w=computed(()=>Array.isArray(t.modelValue)===!0?t.modelValue:t.modelValue!==null&&t.modelValue!==void 0?[t.modelValue]:[]),C=computed(()=>w.value.filter(u=>typeof u=="string").map(u=>ue(u,k.value,S.value)).filter(u=>u.dateHash!==null&&u.day!==null&&u.month!==null&&u.year!==null)),T=computed(()=>{const u=f=>ue(f,k.value,S.value);return w.value.filter(f=>isObject$1(f)===!0&&f.from!==void 0&&f.to!==void 0).map(f=>({from:u(f.from),to:u(f.to)})).filter(f=>f.from.dateHash!==null&&f.to.dateHash!==null&&f.from.dateHash<f.to.dateHash)}),$=computed(()=>t.calendar!=="persian"?u=>new Date(u.year,u.month-1,u.day):u=>{const f=toGregorian(u.year,u.month,u.day);return new Date(f.gy,f.gm-1,f.gd)}),G=computed(()=>t.calendar==="persian"?getDayHash:(u,f,m)=>formatDate(new Date(u.year,u.month-1,u.day,u.hour,u.minute,u.second,u.millisecond),f===void 0?k.value:f,m===void 0?S.value:m,u.year,u.timezoneOffset)),Y=computed(()=>C.value.length+T.value.reduce((u,f)=>u+1+getDateDiff($.value(f.to),$.value(f.from)),0)),ne=computed(()=>{if(t.title!==void 0&&t.title!==null&&t.title.length>0)return t.title;if(x.value!==null){const m=x.value.init,y=$.value(m);return S.value.daysShort[y.getDay()]+", "+S.value.monthsShort[m.month-1]+" "+m.day+lineStr+"?"}if(Y.value===0)return lineStr;if(Y.value>1)return`${Y.value} ${S.value.pluralDay}`;const u=C.value[0],f=$.value(u);return isNaN(f.valueOf())===!0?lineStr:S.value.headerTitle!==void 0?S.value.headerTitle(f,u):S.value.daysShort[f.getDay()]+", "+S.value.monthsShort[u.month-1]+" "+u.day}),ie=computed(()=>C.value.concat(T.value.map(f=>f.from)).sort((f,m)=>f.year-m.year||f.month-m.month)[0]),Te=computed(()=>C.value.concat(T.value.map(f=>f.to)).sort((f,m)=>m.year-f.year||m.month-f.month)[0]),pe=computed(()=>{if(t.subtitle!==void 0&&t.subtitle!==null&&t.subtitle.length>0)return t.subtitle;if(Y.value===0)return lineStr;if(Y.value>1){const u=ie.value,f=Te.value,m=S.value.monthsShort;return m[u.month-1]+(u.year!==f.year?" "+u.year+lineStr+m[f.month-1]+" ":u.month!==f.month?lineStr+m[f.month-1]:"")+" "+f.year}return C.value[0].year}),oe=computed(()=>{const u=[o.iconSet.datetime.arrowLeft,o.iconSet.datetime.arrowRight];return o.lang.rtl===!0?u.reverse():u}),me=computed(()=>t.firstDayOfWeek!==void 0?Number(t.firstDayOfWeek):S.value.firstDayOfWeek),Ne=computed(()=>{const u=S.value.daysShort,f=me.value;return f>0?u.slice(f,7).concat(u.slice(0,f)):u}),W=computed(()=>{const u=E.value;return t.calendar!=="persian"?new Date(u.year,u.month,0).getDate():jalaaliMonthLength(u.year,u.month)}),ke=computed(()=>typeof t.eventColor=="function"?t.eventColor:()=>t.eventColor),V=computed(()=>{if(t.navigationMinYearMonth===void 0)return null;const u=t.navigationMinYearMonth.split("/");return{year:parseInt(u[0],10),month:parseInt(u[1],10)}}),O=computed(()=>{if(t.navigationMaxYearMonth===void 0)return null;const u=t.navigationMaxYearMonth.split("/");return{year:parseInt(u[0],10),month:parseInt(u[1],10)}}),le=computed(()=>{const u={month:{prev:!0,next:!0},year:{prev:!0,next:!0}};return V.value!==null&&V.value.year>=E.value.year&&(u.year.prev=!1,V.value.year===E.value.year&&V.value.month>=E.value.month&&(u.month.prev=!1)),O.value!==null&&O.value.year<=E.value.year&&(u.year.next=!1,O.value.year===E.value.year&&O.value.month<=E.value.month&&(u.month.next=!1)),u}),ae=computed(()=>{const u={};return C.value.forEach(f=>{const m=getMonthHash(f);u[m]===void 0&&(u[m]=[]),u[m].push(f.day)}),u}),ve=computed(()=>{const u={};return T.value.forEach(f=>{const m=getMonthHash(f.from),y=getMonthHash(f.to);if(u[m]===void 0&&(u[m]=[]),u[m].push({from:f.from.day,to:m===y?f.to.day:void 0,range:f}),m<y){let _;const{year:N,month:b}=f.from,I=b<12?{year:N,month:b+1}:{year:N+1,month:1};for(;(_=getMonthHash(I))<=y;)u[_]===void 0&&(u[_]=[]),u[_].push({from:void 0,to:_===y?f.to.day:void 0,range:f}),I.month++,I.month>12&&(I.year++,I.month=1)}}),u}),ee=computed(()=>{if(x.value===null)return;const{init:u,initHash:f,final:m,finalHash:y}=x.value,[_,N]=f<=y?[u,m]:[m,u],b=getMonthHash(_),I=getMonthHash(N);if(b!==L.value&&I!==L.value)return;const A={};return b===L.value?(A.from=_.day,A.includeFrom=!0):A.from=1,I===L.value?(A.to=N.day,A.includeTo=!0):A.to=W.value,A}),L=computed(()=>getMonthHash(E.value)),Ae=computed(()=>{const u={};if(t.options===void 0){for(let m=1;m<=W.value;m++)u[m]=!0;return u}const f=typeof t.options=="function"?t.options:m=>t.options.includes(m);for(let m=1;m<=W.value;m++){const y=L.value+"/"+pad(m);u[m]=f(y)}return u}),xe=computed(()=>{const u={};if(t.events===void 0)for(let f=1;f<=W.value;f++)u[f]=!1;else{const f=typeof t.events=="function"?t.events:m=>t.events.includes(m);for(let m=1;m<=W.value;m++){const y=L.value+"/"+pad(m);u[m]=f(y)===!0&&ke.value(y)}}return u}),Re=computed(()=>{let u,f;const{year:m,month:y}=E.value;if(t.calendar!=="persian")u=new Date(m,y-1,1),f=new Date(m,y-1,0).getDate();else{const _=toGregorian(m,y,1);u=new Date(_.gy,_.gm-1,_.gd);let N=y-1,b=m;N===0&&(N=12,b--),f=jalaaliMonthLength(b,N)}return{days:u.getDay()-me.value-1,endDay:f}}),_e=computed(()=>{const u=[],{days:f,endDay:m}=Re.value,y=f<0?f+7:f;if(y<6)for(let b=m-y;b<=m;b++)u.push({i:b,fill:!0});const _=u.length;for(let b=1;b<=W.value;b++){const I={i:b,event:xe.value[b],classes:[]};Ae.value[b]===!0&&(I.in=!0,I.flat=!0),u.push(I)}if(ae.value[L.value]!==void 0&&ae.value[L.value].forEach(b=>{const I=_+b-1;Object.assign(u[I],{selected:!0,unelevated:!0,flat:!1,color:F.value,textColor:j.value})}),ve.value[L.value]!==void 0&&ve.value[L.value].forEach(b=>{if(b.from!==void 0){const I=_+b.from-1,A=_+(b.to||W.value)-1;for(let te=I;te<=A;te++)Object.assign(u[te],{range:b.range,unelevated:!0,color:F.value,textColor:j.value});Object.assign(u[I],{rangeFrom:!0,flat:!1}),b.to!==void 0&&Object.assign(u[A],{rangeTo:!0,flat:!1})}else if(b.to!==void 0){const I=_+b.to-1;for(let A=_;A<=I;A++)Object.assign(u[A],{range:b.range,unelevated:!0,color:F.value,textColor:j.value});Object.assign(u[I],{flat:!1,rangeTo:!0})}else{const I=_+W.value-1;for(let A=_;A<=I;A++)Object.assign(u[A],{range:b.range,unelevated:!0,color:F.value,textColor:j.value})}}),ee.value!==void 0){const b=_+ee.value.from-1,I=_+ee.value.to-1;for(let A=b;A<=I;A++)u[A].color=F.value,u[A].editRange=!0;ee.value.includeFrom===!0&&(u[b].editRangeFrom=!0),ee.value.includeTo===!0&&(u[I].editRangeTo=!0)}E.value.year===D.value.year&&E.value.month===D.value.month&&(u[_+D.value.day-1].today=!0);const N=u.length%7;if(N>0){const b=7-N;for(let I=1;I<=b;I++)u.push({i:I,fill:!0})}return u.forEach(b=>{let I="q-date__calendar-item ";b.fill===!0?I+="q-date__calendar-item--fill":(I+=`q-date__calendar-item--${b.in===!0?"in":"out"}`,b.range!==void 0&&(I+=` q-date__range${b.rangeTo===!0?"-to":b.rangeFrom===!0?"-from":""}`),b.editRange===!0&&(I+=` q-date__edit-range${b.editRangeFrom===!0?"-from":""}${b.editRangeTo===!0?"-to":""}`),(b.range!==void 0||b.editRange===!0)&&(I+=` text-${b.color}`)),b.classes=I}),u}),De=computed(()=>t.disable===!0?{"aria-disabled":"true"}:t.readonly===!0?{"aria-readonly":"true"}:{});watch(()=>t.modelValue,u=>{if(c===u)c=0;else{const f=be(k.value,S.value);X(f.year,f.month,f)}}),watch(R,()=>{P.value!==null&&n.$el.contains(document.activeElement)===!0&&P.value.focus()}),watch(()=>E.value.year+"|"+E.value.month,()=>{r("navigation",{year:E.value.year,month:E.value.month})}),watch(M,u=>{Ie(u,S.value,"mask"),k.value=u}),watch(K,u=>{Ie(k.value,u,"locale"),S.value=u});function ye(){const u=D.value,f=ae.value[getMonthHash(u)];(f===void 0||f.includes(u.day)===!1)&&he(u),ce(u.year,u.month)}function Ve(u){viewIsValid(u)===!0&&(R.value=u)}function Oe(u,f){["month","year"].includes(u)&&(u==="month"?Ee:de)(f===!0?-1:1)}function ce(u,f){R.value="Calendar",X(u,f)}function $e(u,f){if(t.range===!1||!u){x.value=null;return}const m=Object.assign({...E.value},u),y=f!==void 0?Object.assign({...E.value},f):m;x.value={init:m,initHash:getDayHash(m),final:y,finalHash:getDayHash(y)},ce(m.year,m.month)}function we(){return t.calendar==="persian"?"YYYY/MM/DD":t.mask}function ue(u,f,m){return __splitDate(u,f,m,t.calendar,{hour:0,minute:0,second:0,millisecond:0})}function be(u,f){const m=Array.isArray(t.modelValue)===!0?t.modelValue:t.modelValue?[t.modelValue]:[];if(m.length===0)return Se();const y=m[m.length-1],_=ue(y.from!==void 0?y.from:y,u,f);return _.dateHash===null?Se():_}function Se(){let u,f;if(t.defaultYearMonth!==void 0){const m=t.defaultYearMonth.split("/");u=parseInt(m[0],10),f=parseInt(m[1],10)}else{const m=D.value!==void 0?D.value:l();u=m.year,f=m.month}return{year:u,month:f,day:1,hour:0,minute:0,second:0,millisecond:0,dateHash:u+"/"+pad(f)+"/01"}}function Ee(u){let f=E.value.year,m=Number(E.value.month)+u;m===13?(m=1,f++):m===0&&(m=12,f--),X(f,m),q.value===!0&&se("month")}function de(u){const f=Number(E.value.year)+u;X(f,E.value.month),q.value===!0&&se("year")}function Le(u){X(u,E.value.month),R.value=t.defaultView==="Years"?"Months":"Calendar",q.value===!0&&se("year")}function Be(u){X(E.value.year,u),R.value="Calendar",q.value===!0&&se("month")}function Me(u,f){const m=ae.value[f];(m!==void 0&&m.includes(u.day)===!0?fe:he)(u)}function J(u){return{year:u.year,month:u.month,day:u.day}}function X(u,f,m){if(V.value!==null&&u<=V.value.year&&(u=V.value.year,f<V.value.month&&(f=V.value.month)),O.value!==null&&u>=O.value.year&&(u=O.value.year,f>O.value.month&&(f=O.value.month)),m!==void 0){const{hour:_,minute:N,second:b,millisecond:I,timezoneOffset:A,timeHash:te}=m;Object.assign(E.value,{hour:_,minute:N,second:b,millisecond:I,timezoneOffset:A,timeHash:te})}const y=u+"/"+pad(f)+"/01";y!==E.value.dateHash&&(B.value=E.value.dateHash<y==(o.lang.rtl!==!0)?"left":"right",u!==E.value.year&&(Q.value=B.value),nextTick(()=>{z.value=u-u%yearsInterval-(u<0?yearsInterval:0),Object.assign(E.value,{year:u,month:f,day:1,dateHash:y})}))}function Ce(u,f,m){const y=u!==null&&u.length===1&&t.multiple===!1?u[0]:u;c=y;const{reason:_,details:N}=Pe(f,m);r("update:modelValue",y,_,N)}function se(u){const f=C.value[0]!==void 0&&C.value[0].dateHash!==null?{...C.value[0]}:{...E.value};nextTick(()=>{f.year=E.value.year,f.month=E.value.month;const m=t.calendar!=="persian"?new Date(f.year,f.month,0).getDate():jalaaliMonthLength(f.year,f.month);f.day=Math.min(Math.max(1,f.day),m);const y=Z(f);c=y;const{details:_}=Pe("",f);r("update:modelValue",y,u,_)})}function Pe(u,f){return f.from!==void 0?{reason:`${u}-range`,details:{...J(f.target),from:J(f.from),to:J(f.to)}}:{reason:`${u}-day`,details:J(f)}}function Z(u,f,m){return u.from!==void 0?{from:G.value(u.from,f,m),to:G.value(u.to,f,m)}:G.value(u,f,m)}function he(u){let f;if(t.multiple===!0)if(u.from!==void 0){const m=getDayHash(u.from),y=getDayHash(u.to),_=C.value.filter(b=>b.dateHash<m||b.dateHash>y),N=T.value.filter(({from:b,to:I})=>I.dateHash<m||b.dateHash>y);f=_.concat(N).concat(u).map(b=>Z(b))}else{const m=w.value.slice();m.push(Z(u)),f=m}else f=Z(u);Ce(f,"add",u)}function fe(u){if(t.noUnset===!0)return;let f=null;if(t.multiple===!0&&Array.isArray(t.modelValue)===!0){const m=Z(u);u.from!==void 0?f=t.modelValue.filter(y=>y.from!==void 0?y.from!==m.from&&y.to!==m.to:!0):f=t.modelValue.filter(y=>y!==m),f.length===0&&(f=null)}Ce(f,"remove",u)}function Ie(u,f,m){const y=C.value.concat(T.value).map(_=>Z(_,u,f)).filter(_=>_.from!==void 0?_.from.dateHash!==null&&_.to.dateHash!==null:_.dateHash!==null);r("update:modelValue",(t.multiple===!0?y:y[0])||null,m)}function Ue(){if(t.minimal!==!0)return h("div",{class:"q-date__header "+d.value},[h("div",{class:"relative-position"},[h(Transition,{name:"q-transition--fade"},()=>h("div",{key:"h-yr-"+pe.value,class:"q-date__header-subtitle q-date__header-link "+(R.value==="Years"?"q-date__header-link--active":"cursor-pointer"),tabindex:i.value,...s("vY",{onClick(){R.value="Years"},onKeyup(u){u.keyCode===13&&(R.value="Years")}})},[pe.value]))]),h("div",{class:"q-date__header-title relative-position flex no-wrap"},[h("div",{class:"relative-position col"},[h(Transition,{name:"q-transition--fade"},()=>h("div",{key:"h-sub"+ne.value,class:"q-date__header-title-label q-date__header-link "+(R.value==="Calendar"?"q-date__header-link--active":"cursor-pointer"),tabindex:i.value,...s("vC",{onClick(){R.value="Calendar"},onKeyup(u){u.keyCode===13&&(R.value="Calendar")}})},[ne.value]))]),t.todayBtn===!0?h(QBtn,{class:"q-date__header-today self-start",icon:o.iconSet.datetime.today,flat:!0,size:"sm",round:!0,tabindex:i.value,onClick:ye}):null])])}function ge({label:u,type:f,key:m,dir:y,goTo:_,boundaries:N,cls:b}){return[h("div",{class:"row items-center q-date__arrow"},[h(QBtn,{round:!0,dense:!0,size:"sm",flat:!0,icon:oe.value[0],tabindex:i.value,disable:N.prev===!1,...s("go-#"+f,{onClick(){_(-1)}})})]),h("div",{class:"relative-position overflow-hidden flex flex-center"+b},[h(Transition,{name:"q-transition--jump-"+y},()=>h("div",{key:m},[h(QBtn,{flat:!0,dense:!0,noCaps:!0,label:u,tabindex:i.value,...s("view#"+f,{onClick:()=>{R.value=f}})})]))]),h("div",{class:"row items-center q-date__arrow"},[h(QBtn,{round:!0,dense:!0,size:"sm",flat:!0,icon:oe.value[1],tabindex:i.value,disable:N.next===!1,...s("go+#"+f,{onClick(){_(1)}})})])]}const Fe={Calendar:()=>[h("div",{key:"calendar-view",class:"q-date__view q-date__calendar"},[h("div",{class:"q-date__navigation row items-center no-wrap"},ge({label:S.value.months[E.value.month-1],type:"Months",key:E.value.month,dir:B.value,goTo:Ee,boundaries:le.value.month,cls:" col"}).concat(ge({label:E.value.year,type:"Years",key:E.value.year,dir:Q.value,goTo:de,boundaries:le.value.year,cls:""}))),h("div",{class:"q-date__calendar-weekdays row items-center no-wrap"},Ne.value.map(u=>h("div",{class:"q-date__calendar-item"},[h("div",u)]))),h("div",{class:"q-date__calendar-days-container relative-position overflow-hidden"},[h(Transition,{name:"q-transition--slide-"+B.value},()=>h("div",{key:L.value,class:"q-date__calendar-days fit"},_e.value.map(u=>h("div",{class:u.classes},[u.in===!0?h(QBtn,{class:u.today===!0?"q-date__today":"",dense:!0,flat:u.flat,unelevated:u.unelevated,color:u.color,textColor:u.textColor,label:u.i,tabindex:i.value,...s("day#"+u.i,{onClick:()=>{qe(u.i)},onMouseover:()=>{He(u.i)}})},u.event!==!1?()=>h("div",{class:"q-date__event bg-"+u.event}):null):h("div",""+u.i)]))))])])],Months(){const u=E.value.year===D.value.year,f=y=>V.value!==null&&E.value.year===V.value.year&&V.value.month>y||O.value!==null&&E.value.year===O.value.year&&O.value.month<y,m=S.value.monthsShort.map((y,_)=>{const N=E.value.month===_+1;return h("div",{class:"q-date__months-item flex flex-center"},[h(QBtn,{class:u===!0&&D.value.month===_+1?"q-date__today":null,flat:N!==!0,label:y,unelevated:N,color:N===!0?F.value:null,textColor:N===!0?j.value:null,tabindex:i.value,disable:f(_+1),...s("month#"+_,{onClick:()=>{Be(_+1)}})})])});return t.yearsInMonthView===!0&&m.unshift(h("div",{class:"row no-wrap full-width"},[ge({label:E.value.year,type:"Years",key:E.value.year,dir:Q.value,goTo:de,boundaries:le.value.year,cls:" col"})])),h("div",{key:"months-view",class:"q-date__view q-date__months flex flex-center"},m)},Years(){const u=z.value,f=u+yearsInterval,m=[],y=_=>V.value!==null&&V.value.year>_||O.value!==null&&O.value.year<_;for(let _=u;_<=f;_++){const N=E.value.year===_;m.push(h("div",{class:"q-date__years-item flex flex-center"},[h(QBtn,{key:"yr"+_,class:D.value.year===_?"q-date__today":null,flat:!N,label:_,dense:!0,unelevated:N,color:N===!0?F.value:null,textColor:N===!0?j.value:null,tabindex:i.value,disable:y(_),...s("yr#"+_,{onClick:()=>{Le(_)}})})]))}return h("div",{class:"q-date__view q-date__years flex flex-center"},[h("div",{class:"col-auto"},[h(QBtn,{round:!0,dense:!0,flat:!0,icon:oe.value[0],tabindex:i.value,disable:y(u),...s("y-",{onClick:()=>{z.value-=yearsInterval}})})]),h("div",{class:"q-date__years-content col self-stretch row items-center"},m),h("div",{class:"col-auto"},[h(QBtn,{round:!0,dense:!0,flat:!0,icon:oe.value[1],tabindex:i.value,disable:y(f),...s("y+",{onClick:()=>{z.value+=yearsInterval}})})])])}};function qe(u){const f={...E.value,day:u};if(t.range===!1){Me(f,L.value);return}if(x.value===null){const m=_e.value.find(_=>_.fill!==!0&&_.i===u);if(t.noUnset!==!0&&m.range!==void 0){fe({target:f,from:m.range.from,to:m.range.to});return}if(m.selected===!0){fe(f);return}const y=getDayHash(f);x.value={init:f,initHash:y,final:f,finalHash:y},r("rangeStart",J(f))}else{const m=x.value.initHash,y=getDayHash(f),_=m<=y?{from:x.value.init,to:f}:{from:f,to:x.value.init};x.value=null,he(m===y?f:{target:f,..._}),r("rangeEnd",{from:J(_.from),to:J(_.to)})}}function He(u){if(x.value!==null){const f={...E.value,day:u};Object.assign(x.value,{final:f,finalHash:getDayHash(f)})}}return Object.assign(n,{setToday:ye,setView:Ve,offsetCalendar:Oe,setCalendarTo:ce,setEditingRange:$e}),()=>{const u=[h("div",{class:"q-date__content col relative-position"},[h(Transition,{name:"q-transition--fade"},Fe[R.value])])],f=hSlot(e.default);return f!==void 0&&u.push(h("div",{class:"q-date__actions"},f)),t.name!==void 0&&t.disable!==!0&&v(u,"push"),h("div",{class:re.value,...De.value},[Ue(),h("div",{ref:P,class:"q-date__main col column",tabindex:-1},u)])}}}),dist={exports:{}},request={},browser$1={exports:{}};(function(t,e){var r=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof n!="undefined")return n;throw new Error("unable to locate global object")},n=r();t.exports=e=n.fetch,n.fetch&&(e.default=n.fetch.bind(n)),e.Headers=n.Headers,e.Request=n.Request,e.Response=n.Response})(browser$1,browser$1.exports);var errors={};Object.defineProperty(errors,"__esModule",{value:!0});errors.citationError=errors.pdfError=errors.fcError=errors.eventsError=errors.mediaError=errors.relatedError=errors.introError=errors.preloadError=errors.infoboxError=errors.coordinatesError=errors.geoSearchError=errors.linksError=errors.categoriesError=errors.contentError=errors.htmlError=errors.imageError=errors.summaryError=errors.pageError=errors.autocompletionsError=errors.searchError=errors.wikiError=void 0;class wikiError extends Error{constructor(e,r){super(e),this.name="wikiError",this.code=r}}errors.wikiError=wikiError;class searchError extends wikiError{constructor(e){super(e),this.name="searchError"}}errors.searchError=searchError;class autocompletionsError extends wikiError{constructor(e){super(e),this.name="autocompletionsError"}}errors.autocompletionsError=autocompletionsError;class pageError extends wikiError{constructor(e){super(e),this.name="pageError"}}errors.pageError=pageError;class summaryError extends wikiError{constructor(e){super(e),this.name="summaryError"}}errors.summaryError=summaryError;class imageError extends wikiError{constructor(e){super(e),this.name="imageError"}}errors.imageError=imageError;class htmlError extends wikiError{constructor(e){super(e),this.name="htmlError"}}errors.htmlError=htmlError;class contentError extends wikiError{constructor(e){super(e),this.name="contentError"}}errors.contentError=contentError;class categoriesError extends wikiError{constructor(e){super(e),this.name="categoriesError"}}errors.categoriesError=categoriesError;class linksError extends wikiError{constructor(e){super(e),this.name="linksError"}}errors.linksError=linksError;class geoSearchError extends wikiError{constructor(e){super(e),this.name="geoSearchError"}}errors.geoSearchError=geoSearchError;class coordinatesError extends wikiError{constructor(e){super(e),this.name="coordinatesError"}}errors.coordinatesError=coordinatesError;class infoboxError extends wikiError{constructor(e){super(e),this.name="infoboxError"}}errors.infoboxError=infoboxError;class preloadError extends wikiError{constructor(e){super(e),this.name="preloadError"}}errors.preloadError=preloadError;class introError extends wikiError{constructor(e){super(e),this.name="introError"}}errors.introError=introError;class relatedError extends wikiError{constructor(e){super(e),this.name="relatedError"}}errors.relatedError=relatedError;class mediaError extends wikiError{constructor(e){super(e),this.name="mediaError"}}errors.mediaError=mediaError;class eventsError extends wikiError{constructor(e){super(e),this.name="eventsError"}}errors.eventsError=eventsError;class fcError extends wikiError{constructor(e){super(e),this.name="featuredContentError"}}errors.fcError=fcError;class pdfError extends wikiError{constructor(e){super(e),this.name="pdfError"}}errors.pdfError=pdfError;class citationError extends wikiError{constructor(e){super(e),this.name="citationError"}}errors.citationError=citationError;Object.defineProperty(request,"__esModule",{value:!0});request.setAPIUrl=request.returnRestUrl=request.makeRestRequest=void 0;const node_fetch_1=browser$1.exports,errors_1$1=errors;let API_URL="https://en.wikipedia.org/w/api.php?",REST_API_URL="https://en.wikipedia.org/api/rest_v1/";const USER_AGENT="wikipedia (https://github.com/dopecodez/Wikipedia/)";async function makeRequest(t,e=!0){try{const r={...t};r.format="json",e&&(r.redirects=""),t.action||(r.action="query"),r.origin="*";const n={headers:{"Api-User-Agent":USER_AGENT}};let o="";return Object.keys(r).forEach(i=>{o+=`${i}=${r[i]}&`}),await(await(0,node_fetch_1.default)(encodeURI(API_URL+o),n)).json()}catch(r){throw new errors_1$1.wikiError(r)}}async function makeRestRequest(t,e=!0){try{e||(t+="?redirect=false");const r={headers:{"Api-User-Agent":USER_AGENT}};let o=await(await(0,node_fetch_1.default)(encodeURI(REST_API_URL+t),r)).text();try{o=JSON.parse(o)}finally{return o}}catch(r){throw new errors_1$1.wikiError(r)}}request.makeRestRequest=makeRestRequest;function returnRestUrl(t){return encodeURI(REST_API_URL+t)}request.returnRestUrl=returnRestUrl;function setAPIUrl(t){return API_URL="https://"+t.toLowerCase()+".wikipedia.org/w/api.php?",REST_API_URL="https://"+t.toLowerCase()+".wikipedia.org/api/rest_v1/",API_URL}request.setAPIUrl=setAPIUrl;request.default=makeRequest;var page={},utils={},messages={};Object.defineProperty(messages,"__esModule",{value:!0});messages.MSGS=void 0;messages.MSGS={PAGE_NOT_SUGGEST:"No page with given title suggested : ",PAGE_NOT_EXIST:"No page with given title exists : ",INFOBOX_NOT_EXIST:"Info cannot be parsed for given page"};Object.defineProperty(utils,"__esModule",{value:!0});utils.getCurrentDay=utils.getCurrentMonth=utils.getCurrentYear=utils.setPageId=utils.setPageIdOrTitleParam=utils.setTitleForPage=utils.isString=void 0;const _1=dist.exports,errors_1=errors,messages_1=messages;function isString(t){return isNaN(t)}utils.isString=isString;async function setTitleForPage(t){{const e=await _1.default.search(t,{limit:1,suggestion:!0});if(!e.suggestion&&e.results.length==0)throw new errors_1.pageError(`${messages_1.MSGS.PAGE_NOT_SUGGEST}${t}`);return t=e.suggestion||t,t}}utils.setTitleForPage=setTitleForPage;function setPageIdOrTitleParam(t,e){return isString(e)?t.titles=e:t.pageids=e,t}utils.setPageIdOrTitleParam=setPageIdOrTitleParam;function setPageId(t,e){let r;return t.pageIds?r=t.pageIds:r=Object.keys(e.query.pages)[0],r}utils.setPageId=setPageId;function getCurrentYear(){return new Date().getFullYear()}utils.getCurrentYear=getCurrentYear;function getCurrentMonth(){return new Date().getMonth()+1}utils.getCurrentMonth=getCurrentMonth;function getCurrentDay(){return new Date().getDate()}utils.getCurrentDay=getCurrentDay;function preserveCamelCase(t){let e=!1,r=!1,n=!1;for(let o=0;o<t.length;o++){const a=t[o];e&&/[a-zA-Z]/.test(a)&&a.toUpperCase()===a?(t=t.substr(0,o)+"-"+t.substr(o),e=!1,n=r,r=!0,o++):r&&n&&/[a-zA-Z]/.test(a)&&a.toLowerCase()===a?(t=t.substr(0,o-1)+"-"+t.substr(o-1),n=r,r=!1,e=!0):(e=a.toLowerCase()===a,n=r,r=a.toUpperCase()===a)}return t}var camelcase=function(t){return arguments.length>1?t=Array.from(arguments).map(r=>r.trim()).filter(r=>r.length).join("-"):t=t.trim(),t.length===0?"":t.length===1?t.toLowerCase():/^[a-z0-9]+$/.test(t)?t:(t!==t.toLowerCase()&&(t=preserveCamelCase(t)),t.replace(/^[_.\- ]+/,"").toLowerCase().replace(/[_.\- ]+(\w|$)/g,(r,n)=>n.toUpperCase()))};function _interopDefault(t){return t&&typeof t=="object"&&"default"in t?t.default:t}function trimWrappers(t){return t.replace(/\[\[/g,"").replace(/\]\]/g,"").replace(/\{\{/g,"").replace(/\}\}/g,"").trim()}function trimOr(t){var e=t.indexOf("|");return e!==-1?t.substring(0,e):t}function getValue(t,e){if(!t)return null;var r=t.trim().replace(/File:/,"").replace(/\{\{\d+\}\}/g,"").replace(extraPropertyPattern,"").replace(endingPattern,"");if(r==="y"||r==="yes")return!0;if(e=="birthPlace")return t.trim();var n=r.match(linksPattern);return n?n[0].split(linkSeparatorPattern).filter(function(o){return o}):trimOr(trimWrappers(r))}function dataType(t){var e=t.globalPattern,r=t.parsePattern,n=t.parse,o=t.variable,a=t.name;return function(s){var i=s.match(e);if(!i){var d;return d={},defineProperty(d,a,[]),defineProperty(d,"sourceAfter",s),d}var g=i.map(function(c){return n(c.match(r))}),l=i.reduce(function(c,p,v){return g[v]===DO_NOT_REPLACE?c:c.replace(p,"$"+o+"_"+v)},s);return{data:defineProperty({},a,g),sourceAfter:l}}}function byDataHandler(t,e){var r=t.source,n=t.context,o=e(r),a=o.data,s=o.sourceAfter;return{context:Object.assign({},n,a),source:s}}function extractData(t){return dataTypes$1.map(function(e){return e.handler}).reduce(byDataHandler,{context:{},source:t})}function findPropertyList(t){var e=t.match(keyValueGlobalPattern);return e?e.map(function(r){var n=keyValuePattern.exec(r);if(!n)return null;var o=slicedToArray(n,3),a=o[1],s=o[2],i=camelCase(a.trim());return{key:i,value:getValue(s,i)}}).filter(function(r){return r}):[]}function fillVariable(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=r.simplifyDataValues;if(typeof t!="string")return console.log("Warning: Something went wrong. Could not fill variables in: ("+(t===void 0?"undefined":_typeof(t))+") "+JSON.stringify(t)),{};var o=dataTypes$1.find(function(l){return t.match(l.pattern)});if(o){var a=o.pattern.exec(t),s=slicedToArray(a,2),i=s[0],d=s[1],g=e[o.name][parseInt(d,10)];return n||typeof g!="string"?g:t.replace(i,g)}return t}function fillVariables(t,e,r){if(t===void 0||t instanceof Date||typeof t=="number")return t;if(Array.isArray(t))return t.map(function(o){return fillVariables(o,e,r)});if((t===void 0?"undefined":_typeof(t))==="object")return Object.keys(t).reduce(function(o,a){return Object.assign(o,defineProperty({},a,fillVariables(t[a],e,r)))},{});var n=fillVariable(t,e,r);return n===t?t:fillVariables(n,e,r)}function handleSmallData(t,e,r){var n=r.simplifyDataValues;if(typeof t=="string"&&t.match(smallDataType.pattern)){var o=t.replace(smallDataType.pattern,"").replace(/,/,"").trim(),a=smallDataType.pattern.exec(t),s=slicedToArray(a,2),i=s[1],d=e[smallDataType.name][parseInt(i,10)],g={primary:getVariableValue(o,e,{simplifyDataValues:n}),secondary:getVariableValue(d,e,{simplifyDataValues:n})};return n?g.primary:g}return null}function getVariableValue(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=r.simplifyDataValues,o=handleSmallData(t,e,{simplifyDataValues:n});return o||fillVariables(t,e,{simplifyDataValues:n})}function reduceVariable(t,e,r,n){if(e===null)return null;if(typeof e=="boolean")return e;if(Array.isArray(e))return e.map(function(i){return getVariableValue(i,r,n)});if(t.match(/areaTotal/)||t.match(/population/)){var o=numberParse(e);if(o===!1&&(o=parseFloat(e,10)),!isNaN(o))return o}if(t.match(/date/i)){var a=+new Date(e);if(!isNaN(a))return new Date(e)}var s=getVariableValue(e,r,n);return Array.isArray(s)?s.map(function(i){return getVariableValue(i,r,n)}):s}function byVariableReduction(t,e){return function(r,n){var o=n.key,a=n.value,s=reduceVariable(o,a,t,e);return s===""||s===null?r:Object.assign({},r,defineProperty({},o,s))}}function extractProperties(t){var e=t.source,r=t.context,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=n.simplifyDataValues,a=o===void 0||o;return findPropertyList(e).reduce(byVariableReduction(r,{simplifyDataValues:a}),{})}function transformProperties(t){return Object.keys(t).reduce(function(e,r){var n=t[r],o=r.match(blankNamePattern);if(o){var a=o[1]||"",s=t["blank"+a+"NameSec2"],i=t["blank"+a+"InfoSec2"];return typeof s!="string"?e:Object.assign(e,defineProperty({},camelCase(s),i))}return r.match(blankInfoPattern)?e:Object.assign(e,defineProperty({},r,n))},{})}function findOuterIndex(t){for(var e=[],r=0;r<t.length-1;r++){var n=t.substr(r,2);if(n!=="{{"){if(n==="}}"){if(e.pop(),e.length===0)return r+2;r++}}else e.push(r),r++}}function parse(t){var e=t.match(infoBoxStartPattern);if(!e)return{data:t,sourceLeft:null};var r=e.index,n=t.substring(r),o=findOuterIndex(n);if(!o)return{data:t,sourceLeft:null};var a=n.substring(0,o),s=t.substring(o);return{data:a,sourceLeft:s.match(infoBoxStartPattern)?s:null}}function extractInfoboxes(t){for(var e=parse(t),r=[e.data];e.sourceLeft;)e=parse(e.sourceLeft),r.push(e.data);return r}function cleanSource(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.removeSmall,n=r!==void 0&&r,o=e.removeReferences;return(o===void 0||o)&&(t=t.replace(/<ref(\s\w+=[^>]+)?>.*<\/ref>/g,"").replace(/<ref(\s\w+=[^>]+)?\s?\/>/g,"")),n&&(t=t.replace(/<small>.*<\/small>/g,"")),t.replace(/'''?/g,"").replace(/\|display=inline/g,"").replace(/<br\s?\/?>/g,",").replace(/&minus;/g,"-").replace(/<sup>/g,"^").replace(/\{\{sfn\|([^\}\}]+)\}\}/g,"").replace(/\{\{efn\|([^\}\}]+)\}\}/g,"").replace(/âˆ’/g,"-").replace(/<\/sup>/g,"").replace(/\{\{\s*nowrap\s*\|([^\n\}]+)\}\}/gi,"$1").replace(/<!--([\s\S]*?)-->/g,"").replace(/&nbsp;/g," ").replace("|''See list''","")}function transformRowSpan(t){return t.map(transformCells).reduce(function(e,r,n){for(var o=n===0?0:1,a=0;a<r.length;a++)e[a+o]||(e[a+o]={}),r[a]&&(e[a+o][r[a]]=1);return e},[]).map(function(e){return Object.keys(e).join(",")}).join(" || ")}function clean(t){return t.substring(2,t.length-2).replace(linkPattern$1,function(e,r){return r.split("|")[0]}).replace(/'''?/g,"")}function parseRow(t){var e=t[0].match(/BS(\d)/),r=t[0].substring(2),n=1,o=[],a=1;for(e&&(n=e[1],r=t[0].substring(3));a<=n;a++)o.push(t[a]);return{type:r,margin:t[a++],text1:t[a++],text2:t[a++],comment:t[a++],icons:o}}function getMatches(t,e){for(var r=void 0,n=[];(r=e.exec(t))!==null;)n.push({value:r[1]&&r[1].trim(),start:r.index,end:r.index+r[0].length});return n}function parseTableData(t){var e=t.match(rowPattern$1);return e?e.map(function(r){var n=r.match(rowPatternSingle);return slicedToArray(n,2)[1].trim().split("|").slice(1)}):[]}function getTables(t){var e=getMatches(t,tableStartPattern$1),r=getMatches(t,tableEndPattern$1);return e.map(function(n,o){var a=r[o];if(!a)throw new Error("[Table Parsing] Failed to pair table");return{rows:parseTableData(t.substring(n.end,a.start).trim().replace(/'''/g,"")),start:n.start,end:a.end}})}function last(t){return t.length?t[t.length-1]:void 0}function parseInfobox(t,e){var r=extractInfoboxes(t).map(function(o){return transformProperties(extractProperties(extractData(cleanSource(o,e)),e))});if(!r.length)return{};var n={general:r.shift()};return r.forEach(function(o){var a=o.type;a?n[camelCase(a)]=o:Object.assign(n,{general:Object.assign({},n.general,o)})}),n.tables=parseTables(t),n.bsTables=parseBsTables(t),n.lists=parseLists(t),n}var camelCase=_interopDefault(camelcase),_typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},defineProperty=function(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t},slicedToArray=function(){function t(e,r){var n=[],o=!0,a=!1,s=void 0;try{for(var i,d=e[Symbol.iterator]();!(o=(i=d.next()).done)&&(n.push(i.value),!r||n.length!==r);o=!0);}catch(g){a=!0,s=g}finally{try{!o&&d.return&&d.return()}finally{if(a)throw s}}return n}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),toConsumableArray=function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)},smallGlobalPattern=/\{\{small\|([^\}\}]+)\}\}/g,smallPattern=/small\|([^\}\}]+)\}\}/,small={globalPattern:smallGlobalPattern,parsePattern:smallPattern,parse:function(t){return slicedToArray(t,2)[1]},variable:"SMALL",name:"smalls"},flagGlobalPattern=/\{\{flag\|([^\}\}]+)\}\}/g,flagPattern=/flag\|([^\}\}]+)\}\}/,flag={globalPattern:flagGlobalPattern,parsePattern:flagPattern,parse:function(t){return slicedToArray(t,2)[1]},variable:"FLAG",name:"flags"},coordsGlobalPattern=/\{\{coord\|([^\}\}]+)\}\}/g,coordsPattern=/coord\|([^\}\}]+)\}\}/,coords={globalPattern:coordsGlobalPattern,parsePattern:coordsPattern,parse:function(t){return slicedToArray(t,2)[1]},variable:"COORD",name:"coords"},globalPattern=/\[\[([^\]\|]+)\|?([^\]]+)?\]\]/g,pattern=/\[\[([^\]\|]+)\|?([^\]]+)?\]\]/,instances={globalPattern,parsePattern:pattern,parse:function(t){var e=slicedToArray(t,3),r=e[1],n=e[2];return r||n},variable:"INSTANCE",name:"instances"},extraPropertyPattern=/\n?\s?\|\s?\w+$/,endingPattern=/\n\}\}$/,linksPattern=/((\$\w+_\d+)\s*,?\s*){2,}/g,linkSeparatorPattern=/[,\s?]/g,listItemPrefixPattern=/^\|\s?/,unbulletedListGlobalPattern=/\{\{(?:unbulleted list|ubl|ubt|ublist|unbullet)\s?\|([^\}\}]+)\}\}/gi,unbulletedListItemPattern=/\|\s*([^|}]+)/g,unbulletedLists={globalPattern:unbulletedListGlobalPattern,parsePattern:unbulletedListItemPattern,parse:function(t){return t?t.map(function(e){return e.replace(listItemPrefixPattern,"").trim()}).filter(function(e){return e&&e.length}):[]},variable:"UNBULLETED_LIST",name:"unbulletedLists"},listItemPrefixPattern$1=/^\*\s*/,plainListGlobalPattern=/\n(\*\s*[^*|]+)+/g,plainListItemPattern=/\*\s*([^*|]+)/g,unmarkedLists={globalPattern:plainListGlobalPattern,parsePattern:plainListItemPattern,parse:function(t){return t?t.map(function(e){return e.replace(listItemPrefixPattern$1,"").trim()}).filter(function(e){return e&&e.length}):[]},variable:"UNMARKED_LIST",name:"unmarkedLists"},listItemPrefixPattern$2=/^\*\s?/,plainListGlobalPattern$1=/\{\{f?p?P?l?a?i?n?t?\s?list\s?\|([^\}\}]+)\}\}/g,plainListItemPattern$1=/\*\s*([^*}]+)/g,plainLists={globalPattern:plainListGlobalPattern$1,parsePattern:plainListItemPattern$1,parse:function(t){return t?t.map(function(e){return e.replace(listItemPrefixPattern$2,"").trim()}).filter(function(e){return e&&e.length}):[]},variable:"PLAIN_LIST",name:"plainLists"},marriageGlobalPattern=/\{\{Marriage\|([^\}\}]+)\}\}/gi,marriagePattern=/Marriage\|([^|]+)\|(.*)\}\}/i,marriages={globalPattern:marriageGlobalPattern,parsePattern:marriagePattern,parse:function(t){var e=slicedToArray(t,3);return{who:e[1],married:e[2]}},variable:"MARRIAGE",name:"marriages"},nbayGlobalPattern=/\{\{nbay\|([^\}\}]+)\}\}/gi,nbayPattern=/nbay\|([^|]+)\|(.*)\}\}/i,nbay={globalPattern:nbayGlobalPattern,parsePattern:nbayPattern,parse:function(t){var e=slicedToArray(t,3),r=e[1];return e[2],r},variable:"nbay",name:"nbay"},otherGlobalPattern=/\{\{([^|\n]+)\|([^|\n]+)\|?([^\}\n]+)?\}\}/g,otherPattern=/\{\{([^|\n]+)\|([^|\n]+)\|?([^\}\n]+)?\}\}/,other={globalPattern:otherGlobalPattern,parsePattern:otherPattern,parse:function(t){var e=slicedToArray(t,4),r=e[1];return e[2],e[3],r},variable:"OTHER",name:"others"},hlistGlobalPattern=/\{\{hlist\|([^\}\}]+)\}\}/gi,hlistPattern=/hlist\|(.*)\n?\}\}/i,hlist={globalPattern:hlistGlobalPattern,parsePattern:hlistPattern,parse:function(t){return slicedToArray(t,2)[1].split("|")},variable:"HLIST",name:"hlists"},birthDateGlobalPattern=/\{\{birth\sdate([^\}\}]+)\}\}/gi,birthDatePattern=/(\d+)\|(\d+)\|(\d+)/,millisInYear=31536e6,birthDates={globalPattern:birthDateGlobalPattern,parsePattern:birthDatePattern,parse:function(t){var e=slicedToArray(t,4),r=e[1],n=e[2],o=e[3],a=new Date(r,n-1,o);return{date:a,age:Math.floor((Date.now()-+a)/millisInYear)}},variable:"BIRTH_DATE",name:"birthDates"},DO_NOT_REPLACE=Symbol("DO NOT REPLACE"),labeledDateGlobalPattern=/\{\{([^\n\}\}]+)\}\}/g,labeledDatePattern=/(.*)/,labeledDates={globalPattern:labeledDateGlobalPattern,parsePattern:labeledDatePattern,parse:function(t){var e=t[0].indexOf("|");if(e>-1){var r=t[0].substring(e+1).slice(0,-2),n=new Date(r+" GMT");if(!isNaN(n.getTime()))return{date:n};if(n=new Date(r.split("|").join("-")+" GMT"),!isNaN(n.getTime()))return{date:n}}return DO_NOT_REPLACE},variable:"LABELED_DATE",name:"labeledDates"},deathDateGlobalPattern=/\{\{death\sdate\sand\sage([^\}\}]+)\}\}/gi,deathDatePattern=/(\d+)\|(\d+)\|(\d+)\|(\d+)\|?(\d+)?\|?(\d+)?/,millisInYear$1=31536e6,deathDates={globalPattern:deathDateGlobalPattern,parsePattern:deathDatePattern,parse:function(t){var e=slicedToArray(t,7),r=e[1],n=e[2],o=e[3],a=e[4],s=e[5],i=s===void 0?0:s,d=e[6],g=d===void 0?0:d,l=new Date(r,n-1,o),c=new Date(a,i-1,g);return{date:l,age:Math.floor((Number(l)-Number(c))/millisInYear$1)}},variable:"DEATH_DATE",name:"deathDates"},URLGlobalPattern=/\{\{URL\|([^\}\}]+)\}\}/g,URLPattern=/URL\|([^\}\}]+)\}\}/,url={globalPattern:URLGlobalPattern,parsePattern:URLPattern,parse:function(t){return slicedToArray(t,2)[1]},variable:"URL",name:"urls"},websiteGlobalPattern=/\[(https?):\/\/((?:www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6})\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)\s+([\w\s]+)\]/g,websitePattern=/\[(https?):\/\/((?:www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6})\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)\s+([\w\s]+)\]/,website={globalPattern:websiteGlobalPattern,parsePattern:websitePattern,parse:function(t){var e=slicedToArray(t,5),r=e[1],n=e[2],o=e[3];return{protocol:r,hostname:n,path:o,title:e[4],url:r+"://"+n+o}},variable:"WEBSITE",name:"websites"},globalPattern$1=/\{\{Extra[^}}]+\}\}/gi,parsePattern=/\|\s?(\w+)\s+=\s+(.+)/g,propPattern=/\|\s?(\w+)\s+=\s+(.+)/,extra={globalPattern:globalPattern$1,parsePattern,parse:function(t){return t.reduce(function(e,r){var n=r.match(propPattern),o=slicedToArray(n,3),a=o[1],s=o[2];return e[a]=s,e},{})},variable:"EXTRA",name:"extra"},convertGlobalPattern=/\{\{convert\|([\d\.]+)\|(\w+)/g,convertPattern=/\{\{convert\|([\d\.]+)\|(\w+)/,convert={globalPattern:convertGlobalPattern,parsePattern:convertPattern,parse:function(t){var e=slicedToArray(t,3);return e[1]+" "+e[2]},variable:"CONVERT",name:"converts"},filmDatesPattern=/\{\{film\sdate([^\}\}]+)\}\}/gi,filmDatePatternGlobal=/(\d+)\|?(\d+)\|?(\d+)\|?([^\|\}]*)\|?(ref\d+=([^\|\}]*))?/g,filmDatePattern=/(\d+)\|?(\d+)\|?(\d+)\|?([^\|\}]*)\|?(ref\d+=([^\|\}]*))?/,filmDates={globalPattern:filmDatesPattern,parsePattern:filmDatePatternGlobal,parse:function(t){return t.map(function(e){var r=e.match(filmDatePattern),n=slicedToArray(r,7),o=(n[0],n[1]),a=n[2],s=n[3],i=n[4],d=(n[5],n[6]);return{date:new Date(o,a&&a-1,s),location:i,ref:d}})},variable:"FILM_DATES",name:"filmDates"},otherGlobalPattern$1=/<ref(\s\w+=[^>]+)?>(.*)<\/ref>/g,otherPattern$1=/<ref(\s\w+=[^>]+)?>(.*)<\/ref>/,attributeGlobalPattern=/(\w+)=(["\w]+)/g,attributePattern=/(\w+)=(["\w]+)/,ref1={globalPattern:otherGlobalPattern$1,parsePattern:otherPattern$1,parse:function(t){var e=slicedToArray(t,3),r=(e[0],e[1]),n=e[2];return{attributes:((r||"").match(attributeGlobalPattern)||[]).reduce(function(o,a){if(a){var s=a.match(attributePattern),i=slicedToArray(s,3),d=(i[0],i[1]),g=i[2];o[d]=g.replace(/"/g,"")}return o},{}),contents:n}},variable:"REF",name:"refs"},otherGlobalPattern$2=/<ref(\s\w+=[^>]+)?\/>/g,otherPattern$2=/<ref(\s\w+=[^>]+)?\/>/,attributeGlobalPattern$1=/(\w+)=(["\w]+)/g,attributePattern$1=/(\w+)=(["\w]+)/,ref2={globalPattern:otherGlobalPattern$2,parsePattern:otherPattern$2,parse:function(t){return{attributes:t[1].match(attributeGlobalPattern$1).reduce(function(e,r){var n=r.match(attributePattern$1),o=slicedToArray(n,3),a=(o[0],o[1]),s=o[2];return e[a]=s.replace(/"/g,""),e},{})}},variable:"REF",name:"refs"},globalPattern$2=/\{\{formatnum:\d+\}\}/gi,parsePattern$1=/\{\{formatnum:(\d+)\}\}/,formatNum={globalPattern:globalPattern$2,parsePattern:parsePattern$1,parse:function(t){var e=slicedToArray(t,2),r=e[1];return parseFloat(r)},variable:"FORMAT_NUM",name:"formatNum"},dataTypes=[instances,ref1,ref2,small,formatNum,flag,coords,marriages,birthDates,labeledDates,deathDates,unbulletedLists,website,hlist,url,convert,nbay,filmDates,other,extra,plainLists,unmarkedLists],dataTypes$1=dataTypes.map(function(t){return{handler:dataType(t),name:t.name,pattern:new RegExp("\\$"+t.variable+"_(\\d+)")}}),keyValueGlobalPattern=/\|\s*([-'\u0400-\u04FF\w\s]+)\s*=\s*([^|]+)?/g,keyValuePattern=/\|\s*([-'\u0400-\u04FF\w\s]+)\s*=\s*([^|]+)?/,numberParse=function(t){return typeof t=="string"&&(t=t.trim().replace(/ /g,""),t.match(/,/)&&t.match(/\./)?t.indexOf(",")<t.indexOf(".")?parseEnglish(t):parseSpanish(t):t.match(/,/)&&!t.match(/\./)?t.match(/,/g).length>1||t.match(/,[0-9]{3}($|^[0-9])/)?parseEnglish(t):parseSpanish(t):!t.match(/,/)&&t.match(/\./)?t.match(/\./g).length>1||t.match(/\.[0-9]{3}($|^[0-9])/)?parseSpanish(t):parseEnglish(t):(+t).toString()===t&&+t)},parseEnglish=function(t){return+t.replace(/,/g,"")},parseSpanish=function(t){return+t.replace(/\./g,"").replace(/,/g,".")},smallDataType=dataTypes$1.find(function(t){return t.name==="smalls"}),blankNamePattern=/blank(\d+)?NameSec2/,blankInfoPattern=/blank(\d+)?InfoSec2/,infoBoxStartPattern=/{{\w*box/,tableStartPattern=/{\|(.*)\n?/,tableEndPattern=/\n\|}/,headersPattern=/!\s?(.*)/g,rowPattern=/\|-/,cellSeparatorPattern=/(?:\n\|)|(?:\|\|)/,linkPattern=/\[\[([^\]]+)\]\]/g,linkNamePattern=/^.*\|/,inlineHeaderPattern="!!",actionPattern=/{{anchor\|(.*)}}/g,rowSpanCountPattern=/rowspan="(\d+)"/,stripLinks=function(t){return t.replace(linkPattern,function(e,r){return r.replace(linkNamePattern,"").trim()||r})},removeActions=function(t){return t.replace(actionPattern,"")},transformCell=function(t){return stripLinks(removeActions(t||"")).replace(rowSpanCountPattern,"").replace(linkNamePattern,"").trim()},transformCells=function(t){return t.split(cellSeparatorPattern).map(transformCell)},findIndex=function(t,e){var r=t.match(e);return r?r.index:-1},findTableStart=function(t){var e=t.match(tableStartPattern);return e?e.index+e[0].length:-1},findTableEnd=function(t){return findIndex(t,tableEndPattern)},getHeaders=function(t){for(var e=[],r=void 0;r=headersPattern.exec(t);)e.push.apply(e,toConsumableArray(r[1].split(inlineHeaderPattern).map(transformCell)));return e},getRows=function(t){var e=t.split(rowPattern).map(function(v){return v.replace(/^.*\n+?\|/,"").trim()}).filter(function(v){return v}),r=[],n=0,o=0,a=[],s=!0,i=!1,d=void 0;try{for(var g,l=e[Symbol.iterator]();!(s=(g=l.next()).done);s=!0){var c=g.value,p=c.match(rowSpanCountPattern);p&&(n=0,o=parseInt(p[1]),a=[]),n<o?(a.push(c),++n===o&&r.push(transformRowSpan(a))):r.push(c)}}catch(v){i=!0,d=v}finally{try{!s&&l.return&&l.return()}finally{if(i)throw d}}return r},getNextTable=function(t,e,r){var n=t,o=findTableStart(n);if(o===-1)return null;n=n.substring(o);var a=findTableEnd(n);if(a===-1)return null;n=n.substring(0,a);var s=getRows(n);if(!s.length)return null;var i=getHeaders(s[0]);return i.length?{data:s.slice(1).map(transformCells).map(function(d){return i.reduce(function(g,l,c){return g[camelCase(fillVariable(l,e,r))]=fillVariables(d[c],e,r),g},{})}),end:o+a}:null},parseTables=function(t,e){for(var r=cleanSource(t,e),n=extractData(r),o=[],a=n.source,s=null;s=getNextTable(a,n.context,e);){if(!s)return o;o.push(s.data),a=a.substring(s.end)}return o},linkPattern$1=/\[\[([^\]]+)\]\]/g,kmPattern=/{{BSkm\|([\dx]+,[\dx]+)\|([\dx]+,[\dx]+)}}/g,parseBsTables=function(t){var e=t.replace(kmPattern,"$1/$2").match(/{{BS([^}}]+)}}/g);return e?e.map(function(r){return clean(r).split("|")}).map(parseRow).filter(function(r){return r.type[0]!=="-"}):null},headingPattern=/[^=]==\s?([\w\s]+)\s?==/g,subheadingPattern=/===([\w\s]+)===/g,tableStartPattern$1=/{{list.+start.*}}/gi,tableEndPattern$1=/{{list.+end.*}}/gi,rowPattern$1=/{{(.*)}}/g,rowPatternSingle=/{{(.*)}}/,parseLists=function(t){var e=getMatches(t,headingPattern),r=getMatches(t,subheadingPattern),n=getTables(t);return n.forEach(function(o){var a=e.filter(function(i){return i.end<o.start}).map(function(i){return i.value});o.heading=last(a);var s=r.filter(function(i){return i.end<o.start}).map(function(i){return i.value});o.subheading=last(s),delete o.start,delete o.end}),n},bundle_min=parseInfobox;(function(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.citation=exports.pdf=exports.mobileHtml=exports.media=exports.related=exports.summary=exports.rawInfo=exports.tables=exports.infobox=exports.langLinks=exports.coordinates=exports.references=exports.links=exports.categories=exports.content=exports.html=exports.intro=exports.images=exports.Page=void 0;const errors_1=errors,request_1=request,utils_1=utils,messages_1=messages,infoboxParser=bundle_min;class Page{constructor(t){this.intro=async e=>{try{if(!this._intro){const r=await(0,exports.intro)(this.pageid.toString(),e==null?void 0:e.redirect);this._intro=r}return this._intro}catch(r){throw new errors_1.introError(r)}},this.images=async e=>{try{if(!this._images){const r=await(0,exports.images)(this.pageid.toString(),e);this._images=r}return this._images}catch(r){throw new errors_1.imageError(r)}},this.summary=async e=>{try{if(!this._summary){const r=await(0,exports.summary)(this.title,e==null?void 0:e.redirect);this._summary=r}return this._summary}catch(r){throw new errors_1.summaryError(r)}},this.html=async e=>{try{if(!this._html){const r=await(0,exports.html)(this.pageid.toString(),e==null?void 0:e.redirect);this._html=r}return this._html}catch(r){throw new errors_1.htmlError(r)}},this.content=async e=>{try{if(!this._content){const r=await(0,exports.content)(this.pageid.toString(),e==null?void 0:e.redirect);this.parentid=r.ids.parentId,this.revid=r.ids.revId,this._content=r.result}return this._content}catch(r){throw new errors_1.contentError(r)}},this.categories=async e=>{try{if(!this._categories){const r=await(0,exports.categories)(this.pageid.toString(),e);this._categories=r}return this._categories}catch(r){throw new errors_1.categoriesError(r)}},this.links=async e=>{try{if(!this._links){const r=await(0,exports.links)(this.pageid.toString(),e);this._links=r}return this._links}catch(r){throw new errors_1.linksError(r)}},this.references=async e=>{try{if(!this._references){const r=await(0,exports.references)(this.pageid.toString(),e);this._references=r}return this._references}catch(r){throw new errors_1.linksError(r)}},this.coordinates=async e=>{try{if(!this._coordinates){const r=await(0,exports.coordinates)(this.pageid.toString(),e==null?void 0:e.redirect);this._coordinates=r}return this._coordinates}catch(r){throw new errors_1.coordinatesError(r)}},this.langLinks=async e=>{try{if(!this._langLinks){const r=await(0,exports.langLinks)(this.pageid.toString(),e);this._langLinks=r}return this._langLinks}catch(r){throw new errors_1.linksError(r)}},this.infobox=async e=>{try{if(!this._infobox){const r=await(0,exports.infobox)(this.pageid.toString(),e==null?void 0:e.redirect);this._infobox=r}return this._infobox}catch(r){throw new errors_1.infoboxError(r)}},this.tables=async e=>{try{if(!this._tables){const r=await(0,exports.tables)(this.pageid.toString(),e==null?void 0:e.redirect);this._tables=r}return this._tables}catch(r){throw new errors_1.infoboxError(r)}},this.related=async e=>{try{if(!this._related){const r=await(0,exports.related)(this.title,e==null?void 0:e.redirect);this._related=r}return this._related}catch(r){throw new errors_1.relatedError(r)}},this.media=async e=>{try{if(!this._media){const r=await(0,exports.media)(this.title,e==null?void 0:e.redirect);this._media=r}return this._media}catch(r){throw new errors_1.mediaError(r)}},this.mobileHtml=async e=>{try{if(!this._mobileHtml){const r=await(0,exports.mobileHtml)(this.title,e==null?void 0:e.redirect);this._mobileHtml=r}return this._mobileHtml}catch(r){throw new errors_1.htmlError(r)}},this.pdf=async e=>{try{return await(0,exports.pdf)(this.title,e)}catch(r){throw new errors_1.pdfError(r)}},this.pageid=t.pageid,this.ns=t.ns,this.title=t.title,this.contentmodel=t.contentmodel,this.pagelanguage=t.pagelanguage,this.pagelanguagedir=t.pagelanguagedir,this.touched=t.touched,this.lastrevid=t.lastrevid,this.length=t.length,this.fullurl=t.fullurl,this.editurl=t.editurl,this.canonicalurl=t.canonicalurl}async runMethod(functionName){try{const result=await eval(`this.${functionName}()`);return result}catch(t){throw new errors_1.preloadError(t)}}}exports.Page=Page;const images=async(t,e)=>{try{let r={generator:"images",gimlimit:(e==null?void 0:e.limit)||5,prop:"imageinfo",iiprop:"url"};r=(0,utils_1.setPageIdOrTitleParam)(r,t);const n=await(0,request_1.default)(r,e==null?void 0:e.redirect),o=[],a=Object.keys(n.query.pages);for(const s of a){const i=n.query.pages[s];i.url=i.imageinfo[0].url,o.push(i)}return o}catch(r){throw new errors_1.imageError(r)}};exports.images=images;const intro=async(t,e=!0)=>{var r;try{let n={prop:"extracts",explaintext:"",exintro:""};n=(0,utils_1.setPageIdOrTitleParam)(n,t);const o=await(0,request_1.default)(n,e),a=(0,utils_1.setPageId)(n,o);return(r=o==null?void 0:o.query)===null||r===void 0?void 0:r.pages[a].extract}catch(n){throw new errors_1.introError(n)}};exports.intro=intro;const html=async(t,e=!0)=>{try{let r={prop:"revisions",rvprop:"content",rvlimit:1,rvparse:""};r=(0,utils_1.setPageIdOrTitleParam)(r,t);const n=await(0,request_1.default)(r,e),o=(0,utils_1.setPageId)(r,n);return n.query.pages[o].revisions[0]["*"]}catch(r){throw new errors_1.htmlError(r)}};exports.html=html;const content=async(t,e=!0)=>{try{let r={prop:"extracts|revisions",explaintext:"",rvprop:"ids"};r=(0,utils_1.setPageIdOrTitleParam)(r,t);const n=await(0,request_1.default)(r,e),o=(0,utils_1.setPageId)(r,n),a=n.query.pages[o].extract,s={revisionId:n.query.pages[o].revisions[0].revid,parentId:n.query.pages[o].revisions[0].parentid};return{result:a,ids:s}}catch(r){throw new errors_1.contentError(r)}};exports.content=content;const categories=async(t,e)=>{try{let r={prop:"categories",pllimit:e==null?void 0:e.limit};r=(0,utils_1.setPageIdOrTitleParam)(r,t);const n=await(0,request_1.default)(r,e==null?void 0:e.redirect),o=(0,utils_1.setPageId)(r,n);return n.query.pages[o].categories.map(a=>a.title)}catch(r){throw new errors_1.categoriesError(r)}};exports.categories=categories;const links=async(t,e)=>{try{let r={prop:"links",plnamespace:0,pllimit:(e==null?void 0:e.limit)||"max"};r=(0,utils_1.setPageIdOrTitleParam)(r,t);const n=await(0,request_1.default)(r,e==null?void 0:e.redirect),o=(0,utils_1.setPageId)(r,n);return n.query.pages[o].links.map(s=>s.title)}catch(r){throw new errors_1.linksError(r)}};exports.links=links;const references=async(t,e)=>{try{let r={prop:"extlinks",ellimit:(e==null?void 0:e.limit)||"max"};r=(0,utils_1.setPageIdOrTitleParam)(r,t);const n=await(0,request_1.default)(r,e==null?void 0:e.redirect),o=(0,utils_1.setPageId)(r,n);return n.query.pages[o].extlinks.map(s=>s["*"])}catch(r){throw new errors_1.linksError(r)}};exports.references=references;const coordinates=async(t,e=!0)=>{try{let r={prop:"coordinates"};r=(0,utils_1.setPageIdOrTitleParam)(r,t);const n=await(0,request_1.default)(r,e),o=(0,utils_1.setPageId)(r,n),a=n.query.pages[o].coordinates;return a?a[0]:null}catch(r){throw new errors_1.coordinatesError(r)}};exports.coordinates=coordinates;const langLinks=async(t,e)=>{try{let r={prop:"langlinks",lllimit:(e==null?void 0:e.limit)||"max",llprop:"url"};r=(0,utils_1.setPageIdOrTitleParam)(r,t);const n=await(0,request_1.default)(r,e==null?void 0:e.redirect),o=(0,utils_1.setPageId)(r,n);return n.query.pages[o].langlinks.map(s=>({lang:s.lang,title:s["*"],url:s.url}))}catch(r){throw new errors_1.linksError(r)}};exports.langLinks=langLinks;const infobox=async(t,e=!0)=>{try{const r={prop:"revisions",rvprop:"content",rvsection:0},n=await(0,exports.rawInfo)(t,r,e);return infoboxParser(n).general}catch(r){throw new errors_1.infoboxError(r)}};exports.infobox=infobox;const tables=async(t,e=!0)=>{try{const r={prop:"revisions",rvprop:"content"},n=await(0,exports.rawInfo)(t,r,e);return infoboxParser(n).tables}catch(r){throw new errors_1.infoboxError(r)}};exports.tables=tables;const rawInfo=async(t,e,r=!0)=>{var n;try{e=(0,utils_1.setPageIdOrTitleParam)(e,t);const o=await(0,request_1.default)(e,r);if(!(!((n=o.query)===null||n===void 0)&&n.pages))throw new errors_1.wikiError(messages_1.MSGS.INFOBOX_NOT_EXIST);const a=(0,utils_1.setPageId)(e,o),s=o.query.pages[a].revisions[0];return s?s["*"]:""}catch(o){throw new errors_1.infoboxError(o)}};exports.rawInfo=rawInfo;const summary=async(t,e=!0)=>{try{const r="page/summary/"+t.replace(" ","_");return await(0,request_1.makeRestRequest)(r,e)}catch(r){throw new errors_1.summaryError(r)}};exports.summary=summary;const related=async(t,e=!0)=>{try{const r="page/related/"+t.replace(" ","_");return await(0,request_1.makeRestRequest)(r,e)}catch(r){throw new errors_1.relatedError(r)}};exports.related=related;const media=async(t,e=!0)=>{try{const r="page/media-list/"+t.replace(" ","_");return await(0,request_1.makeRestRequest)(r,e)}catch(r){throw new errors_1.mediaError(r)}};exports.media=media;const mobileHtml=async(t,e=!0)=>{try{const r=`page/mobile-html/${t}`;return await(0,request_1.makeRestRequest)(r,e)}catch(r){throw new errors_1.htmlError(r)}};exports.mobileHtml=mobileHtml;const pdf=async(t,e)=>{try{let r=`page/pdf/${t}`;return e!=null&&e.format&&(r+=`/${e.format}`),e!=null&&e.type&&(r+=`/${e.type}`),(0,request_1.returnRestUrl)(r)}catch(r){throw new errors_1.pdfError(r)}};exports.pdf=pdf;const citation=async(t,e,r)=>{try{let n="data/citation";return n+=e?`/${e}`:"/mediawiki",n+=`/${t}`,r&&(n+=`/${r}`),await(0,request_1.makeRestRequest)(n)}catch(n){throw new errors_1.citationError(n)}};exports.citation=citation,exports.default=Page})(page);var resultTypes={};Object.defineProperty(resultTypes,"__esModule",{value:!0});var optionTypes={};Object.defineProperty(optionTypes,"__esModule",{value:!0});(function(t,e){var r=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(l,c,p,v){v===void 0&&(v=p);var P=Object.getOwnPropertyDescriptor(c,p);(!P||("get"in P?!c.__esModule:P.writable||P.configurable))&&(P={enumerable:!0,get:function(){return c[p]}}),Object.defineProperty(l,v,P)}:function(l,c,p,v){v===void 0&&(v=p),l[v]=c[p]}),n=commonjsGlobal&&commonjsGlobal.__exportStar||function(l,c){for(var p in l)p!=="default"&&!Object.prototype.hasOwnProperty.call(c,p)&&r(c,l,p)};Object.defineProperty(e,"__esModule",{value:!0});const o=request,a=page,s=errors,i=messages,d=utils,g=async(l,c)=>g.page(l,c);g.search=async(l,c)=>{try{const p={list:"search",srprop:"",srlimit:(c==null?void 0:c.limit)||10,srsearch:l};c!=null&&c.suggestion&&(p.srinfo="suggestion");const v=await(0,o.default)(p);return{results:v.query.search,suggestion:v.query.searchinfo?v.query.searchinfo.suggestion:null}}catch(p){throw new s.searchError(p)}},g.page=async(l,c)=>{try{c!=null&&c.autoSuggest&&(l=await(0,d.setTitleForPage)(l));let p={prop:"info|pageprops",inprop:"url",ppprop:"disambiguation"};p=(0,d.setPageIdOrTitleParam)(p,l);const v=await(0,o.default)(p);let P=v.query.pages;const k=(0,d.setPageId)(p,v);if(P=P[k],P.missing=="")throw new s.pageError(`${i.MSGS.PAGE_NOT_EXIST}${l}`);const S=new a.default(P);if(c!=null&&c.preload){c!=null&&c.fields||(c.fields=["summary","images"]);for(const M of c.fields)await S.runMethod(M)}return S}catch(p){throw new s.pageError(p)}},g.intro=async(l,c)=>{try{return c!=null&&c.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,a.intro)(l,c==null?void 0:c.redirect)}catch(p){throw new s.introError(p)}},g.images=async(l,c)=>{try{return c!=null&&c.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,a.images)(l,c)}catch(p){throw new s.imageError(p)}},g.summary=async(l,c)=>{try{return c!=null&&c.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,a.summary)(l,c==null?void 0:c.redirect)}catch(p){throw new s.summaryError(p)}},g.html=async(l,c)=>{try{return c!=null&&c.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,a.html)(l,c==null?void 0:c.redirect)}catch(p){throw new s.htmlError(p)}},g.content=async(l,c)=>{try{return c!=null&&c.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),(await(0,a.content)(l,c==null?void 0:c.redirect)).result}catch(p){throw new s.contentError(p)}},g.categories=async(l,c)=>{try{return c!=null&&c.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,a.categories)(l,c)}catch(p){throw new s.categoriesError(p)}},g.related=async(l,c)=>{try{return c!=null&&c.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,a.related)(l,c==null?void 0:c.redirect)}catch(p){throw new s.relatedError(p)}},g.media=async(l,c)=>{try{return c!=null&&c.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,a.media)(l,c==null?void 0:c.redirect)}catch(p){throw new s.mediaError(p)}},g.links=async(l,c)=>{try{return c!=null&&c.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,a.links)(l,c)}catch(p){throw new s.linksError(p)}},g.references=async(l,c)=>{try{return c!=null&&c.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,a.references)(l,c)}catch(p){throw new s.linksError(p)}},g.coordinates=async(l,c)=>{try{return c!=null&&c.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,a.coordinates)(l,c==null?void 0:c.redirect)}catch(p){throw new s.coordinatesError(p)}},g.langLinks=async(l,c)=>{try{return c!=null&&c.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,a.langLinks)(l,c)}catch(p){throw new s.linksError(p)}},g.infobox=async(l,c)=>{try{return c!=null&&c.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,a.infobox)(l,c==null?void 0:c.redirect)}catch(p){throw new s.infoboxError(p)}},g.tables=async(l,c)=>{try{return c!=null&&c.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,a.tables)(l,c==null?void 0:c.redirect)}catch(p){throw new s.infoboxError(p)}},g.languages=async()=>{try{const l={meta:"siteinfo",siprop:"languages"},c=await(0,o.default)(l),p=[];for(const v of c.query.languages)p.push({[v.code]:v["*"]});return p}catch(l){throw new s.wikiError(l)}},g.setLang=l=>(0,o.setAPIUrl)(l),g.geoSearch=async(l,c,p)=>{try{const v={list:"geosearch",gsradius:(p==null?void 0:p.radius)||1e3,gscoord:`${l}|${c}`,gslimit:(p==null?void 0:p.limit)||10,gsprop:"type"};return(await(0,o.default)(v)).query.geosearch}catch(v){throw new s.geoSearchError(v)}},g.suggest=async l=>{var c,p,v,P;try{const k={list:"search",srinfo:"suggestion",srprop:"",srsearch:l},S=await(0,o.default)(k);return!((p=(c=S.query)===null||c===void 0?void 0:c.searchinfo)===null||p===void 0)&&p.suggestion?(P=(v=S.query)===null||v===void 0?void 0:v.searchinfo)===null||P===void 0?void 0:P.suggestion:null}catch(k){throw new s.searchError(k)}},g.onThisDay=async(l={})=>{try{const c=l.type||"all",p=(l.month||(0,d.getCurrentMonth)()).toString().padStart(2,"0"),v=(l.day||(0,d.getCurrentDay)()).toString().padStart(2,"0"),P=`feed/onthisday/${c}/${p}/${v}`;return await(0,o.makeRestRequest)(P,!0)}catch(c){throw new s.eventsError(c)}},g.featuredContent=async(l={})=>{try{const c=(l.year||(0,d.getCurrentYear)()).toString(),p=(l.month||(0,d.getCurrentMonth)()).toString().padStart(2,"0"),v=(l.day||(0,d.getCurrentDay)()).toString().padStart(2,"0"),P=`feed/featured/${c}/${p}/${v}`;return await(0,o.makeRestRequest)(P,!0)}catch(c){throw new s.fcError(c)}},g.random=async l=>{try{l||(l="summary");const c=`page/random/${l}`;return await(0,o.makeRestRequest)(c)}catch(c){throw new s.wikiError(c)}},g.mobileHtml=async(l,c)=>{try{return c!=null&&c.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,a.mobileHtml)(l,c==null?void 0:c.redirect)}catch(p){throw new s.htmlError(p)}},g.pdf=async(l,c)=>{try{return c!=null&&c.autoSuggest&&(l=await(0,d.setTitleForPage)(l)),await(0,a.pdf)(l,c)}catch(p){throw new s.pdfError(p)}},g.citation=async(l,c,p)=>{try{return await(0,a.citation)(l,c,p)}catch(v){throw new s.citationError(v)}},g.autocompletions=async(l,c)=>{try{const p={list:"search",limit:(c==null?void 0:c.limit)||10,search:l,action:"opensearch",redirect:"return"},[,v]=await(0,o.default)(p,!1);return v}catch(p){throw new s.autocompletionsError(p)}},e.default=g,t.exports=g,t.exports.default=g,n(errors,e),n(resultTypes,e),n(optionTypes,e),n(page,e)})(dist,dist.exports);var WPComponent_vue_vue_type_style_index_0_lang="";Plugin.setDefaults({color:"primary",size:"15px",position:"bottom"});const _sfc_main$4=defineComponent({name:"WPComponent",props:[],setup(){const t=Date.now(),e=date.formatDate(t,"MM/DD");return{store:useStore(),guideWords:ref(""),promptGW:ref(!1),promptSearch:ref(!1),promptLanguage:ref(!1),flagName:ref("fi fi-gb"),searchSize:ref(50),searchResults:ref([]),imageResultsSize:ref(25),promptSearchSize:ref(!1),promptImageResultsSize:ref(!1),otditems:ref([]),promptOTDDate:ref(!1),otddate:ref(Date.now()),otdlabel:ref(e),otdtype:ref("selected"),history:ref([]),historySize:ref(20),promptHistorySize:ref(!1),numPages:ref(5),promptNumPages:ref(!1),showPreview:ref(!1)}},mounted(){this.flagName=this.store.langVoices[this.store.userSnapshot.preferences.langVoiceKey].flagName;const t=this.store.userSnapshot.preferences.langVoiceKey,e=this.store.langVoices[t].flagName;selectAll("#sfi").classed(e,!0),this.init()},methods:{async init(){const t=this.store.userSnapshot.preferences.langVoiceKey;await dist.exports.setLang(this.store.langVoices[t].langName);const e=await dist.exports.onThisDay({type:this.otdtype});this.otditems=e[this.otdtype]},generateCourse(){const e=this.store.newCourse().ck;console.log("created course ",e);for(let r=0;r<5;r++){const n=this.generateAssignment();console.log("aid = ",n)}},generateAssignment(){if(!this.store.ck){this.store.notify({msg:"Must select course to generate assignments"});return}if(!this.store.aid){const e=this.store.newAssignment();this.store.aid=e,console.log("created assignment ",e)}this.store.currentAssignment.title=this.guideWords.split(",")[0];const t=this.generatePages(this.numPages);console.log("generatePages returned ",t);try{this.store.currentAssignment.coverUrl=this.store.currentAssignment.pages[0].imgs[0].url}catch(e){console.log(e)}return this.store.router.push("/courses/assignments"),this.store.aid},async generatePages(t){t||(t=1),Plugin.start(0),this.clearSearchResults();const e=this.store.langVoices[this.store.userSnapshot.preferences.langVoiceKey];console.log("generatePages ",e,this.searchTerms),dist.exports.setLang(e.langName);const r=await dist.exports.search(this.guideWords,{suggestion:!1,limit:t});console.log("generatePages res.results.length: ",r.results.length),this.searchResults=r.results;for(let n=0;n<r.results.length;n++)await this.loadSearchNoPreview(n),Plugin.increment(parseInt(1/r.results.length*100));Plugin.stop(),this.store.pgIdx=0},async getPage(t,e,r){selectAll(".assignment").classed("hidden",!1),selectAll(".coverslide").classed("hidden",!0);const n=this.store.langVoices;console.log("getPage ",r,n[r]);const o=this.store.currentPage;try{for(;o.imgs.length>0;)o.imgs.pop()}catch(l){console.log(l)}const a=await dist.exports.setLang(n[r].langName);console.log("res (promise)",a);let s,i,d;if(t.length>0){const l=t.split(",");for(const P in parseInt(Math.random()*Math.random()))console.log("dummy ",P);const c=parseInt(Math.random()*l.length);console.log("searchTerm: ",l[c]);const p=await dist.exports.search(l[c],{suggestion:!1,limit:this.searchSize}),v=parseInt(Math.random()*p.results.length);d=p.results[v].pageid,i=await dist.exports.page(d),s=await i.summary()}else e!==null?(i=await dist.exports.page(e),d=e,s=await i.summary()):(s=await dist.exports.random(),d=s.pageid,i=await dist.exports.page(d));await i.media().then(l=>{for(const c in l.items)c.type==="image"&&c.showInGallery===!0&&o.imgs.push({url:c.srcset[0].src,cap:c.caption.text})});try{o.currentLangLinks=await i.langLinks()}catch{console.log("Failed to get langLinks")}await i.coordinates().then(l=>{console.log("resolved coords ",l),l!==null?o&&(o.mapCoords=`${l.lat}, ${l.lon}`):o&&(o.mapCoords="-999, -999")});try{this.page.imgs.unshift({url:s.originalimage.source,cap:s.title})}catch{}try{await i.images({limit:this.imageResultsSize}).then(l=>{for(const c in l)!c||(l[0].title.indexOf(".svg")>1?console.log("SVG ",l[0].title):l[0].title.indexOf("airytale")>0?console.log("Fairytale warning ",l[0].title):l[0].title.indexOf("kguitar")>1?console.log("kguitar ",l[0].title):l[0].title.indexOf("Blank.png")>-1?console.log("Blank.png ",l[0].title):l[0].title.indexOf(".oga")>1?console.log("OGA ",l[0].title):l[0].title.indexOf(".webm")>1?console.log("WEBM ",l[0].title):l[0].title.indexOf(".ogg")>1?console.log("OGG ",l[0].title):l[0].title.indexOf(".tif")>1?console.log("TIF ",l[0].title):l[0].title.indexOf(".mid")>1?console.log("MID ",l[0].title):l[0].title.indexOf(".ogv")>1?console.log("OGV ",l[0].title):l[0].title.indexOf("Icon")>1?console.log("ICON ",l[0].title):l[0].title.indexOf("icon")>1?console.log("icon ",l[0].title):l[0].title.indexOf("podagraria1")>0?console.log("podagraria1 ",l[0].title):l[0].title.indexOf("Bluetank")>1||l[0].title.indexOf("rab Nebula.jpg")>0?console.log("BLUETANK ",l[0].title):l[0].title.indexOf("viacionavion")>1||l[0].title.indexOf("input-microphone")>1?console.log("viacionavion",l[0].title):l[0].title.indexOf("clouds in fair weather")>0?console.log("clouds in fair weather",l[0].title):(console.log("Attempting to add "),o.imgs.push({url:l[0].url,cap:l[0].title}),console.log("Added ",l[0].title)),l.push(l.shift()))})}catch(l){console.log("error retrieving fp.images ",i,l)}o&&o.imgs.length===0&&o.imgs.push({url:"https://readingedgeca.s3.us-west-1.amazonaws.com/static/pub/img/readingedge_cover.png",cap:"No images available"}),o.langVoiceKey=r,o.isCustom=!1,o.pageid=d,o.pageTitle=s.title,o.guideWords=t,o.pctReplace=15,o.pageText=s.extract,o.canonicalUrl=i.canonicalurl;const g={pageid:d,title:s.title,langVoiceKey:r};for(this.history.unshift(g);this.history.length>this.historySize;)this.history.pop();for(const[l,c]of Object.entries(this.store.langVoices)){const p=c.flagName;l||console.log("blooh blah"),selectAll(".pfi").classed(p,!1)}return selectAll(".pfi").classed(this.store.langVoices[r].flagName,!0),1},langChangeCB(t){console.log(t);const e=this.flagName;selectAll("#sfi").classed(e,!1),console.log(this.store.langVoices),this.flagName=this.store.langVoices[t].flagName,console.log("langChangeCB",t,this.flagName),selectAll("#sfi").classed(this.flagName,!0),this.init()},async loadOTDPageId(t,e){const r=await this.createAsNeededForPageLoad();console.log("check returned ",r),console.log("WPComponent.loadSearchPageId: ",t,e),await this.getPage("",t,e).then(n=>(console.log("getPage returned rval ",n),this.store.imgIdx=0,this.store.router.replace("/courses/assignments/pages"),t))},async loadSearchPageId(t,e){console.log("store loadSearchPageId: ",t,e),await this.getPage("",t,e).then(r=>(console.log("getPage returned rval ",r,"pgIdx",this.store.pgIdx),this.store.imgIdx=0,t))},async loadOTD(t){console.log("load",this.otditems[t].text),console.log("load",this.otditems[t]);const e=this.store.userSnapshot.preferences.langVoiceKey;console.log("OTD load ",e);const r="https://"+this.store.langVoices[e].langName+".wikipedia.org/wiki/FooBar?curid="+this.otditems[t].pages[0].pageid;console.log(r),this.store.showPreview=!0,window.setTimeout(async()=>{const n='<iframe sandbox="allow-scripts allow-modals allow-same-origin" style="width:100%;height:50vh;" id="wpIframe" src="'+r+'" name="iframe_a" title="Iframe Example"></iframe>';console.log("TIMEOUT",n),selectAll("#wpIframeContainer").html(n),select("#keepB").on("click",async()=>{Plugin.start(0);const o=await this.loadOTDPageId(this.otditems[t].pages[0].pageid,e);Plugin.increment(parseInt(20)),console.log("loadOTDPageId returned ",o),this.store.imgIdx=0,this.store.router.replace("/courses/assignments/pages"),Plugin.increment(parseInt(20)),Plugin.stop()})},100)},async loadSearch(t){console.log(t),console.log(this.searchResults[t]);const e=this.store.userSnapshot.preferences.langVoiceKey;console.log("calling loadSearchPageId ",this.searchResults[t].pageid,e);const r="https://"+this.store.langVoices[e].langName+".wikipedia.org/wiki/FooBar?curid="+this.searchResults[t].pageid;return console.log(r),this.store.showPreview=!0,window.setTimeout(async()=>{const n='<iframe sandbox="allow-scripts allow-modals allow-same-origin" style="width:100%;height:50vh;" id="wpIframe" src="'+r+'" name="iframe_a" title="Iframe Example"></iframe>';console.log("TIMEOUT",n),selectAll("#wpIframeContainer").html(n),select("#keepB").on("click",async()=>{Plugin.start(0);const o=await this.createAsNeededForPageLoad();console.log("check returned ",o),Plugin.increment(parseInt(20)),await this.loadSearchPageId(this.searchResults[t].pageid,e),Plugin.increment(parseInt(20));try{this.store.carousel.goTo(this.store.aid),this.store.pgIdx=0,Plugin.increment(parseInt(20))}catch(a){console.log(a)}this.store.router.replace("/courses/assignments/pages"),Plugin.stop()})},100),this.searchResults[t].pageid},async loadSearchNoPreview(t){console.log(t),console.log(this.searchResults[t]);const e=this.store.userSnapshot.preferences.langVoiceKey;console.log("calling loadSearchPageId ",this.searchResults[t].pageid,e);const r="http://"+this.store.langVoices[e].langName+".wikipedia.org/wiki/FooBar?curid="+this.searchResults[t].pageid;console.log(r),this.store.showPreview=!0;const n='<iframe id="wpIframe" src="'+r+'" name="iframe_a" title="Iframe Example"></iframe>';selectAll("#wpIframeContainer").html(n);const o=await this.createAsNeededForPageLoad();console.log("check returned ",o),await this.loadSearchPageId(this.searchResults[t].pageid,e),this.store.imgIdx=0;try{this.store.carousel.goTo(this.store.aid)}catch(a){console.log(a)}return this.store.router.replace("/courses/assignments/pages"),this.searchResults[t].pageid},async createAsNeededForPageLoad(){let t=0;if(this.store.imgIdx=0,console.log("createAsNeededForpgLoad",t),this.store.ck===null||this.store.ck==="undefined"){console.log("creating new course");const e=await this.store.newCourse();this.store.ck=e,t+=4}if(this.store.aid===null||this.store.aid===-1){console.log("creating new assignment");const e=this.store.newAssignment();this.store.aid=e,t+=2}return console.log("appending new page to current assignment"),this.store.newPage(),this.store.pgIdx=this.store.currentAssignment.pages.length-1,t+=1,t},async doSearch(){this.clearSearchResults();const t=this.store.langVoices[this.store.userSnapshot.preferences.langVoiceKey];console.log("doSearch ",t,this.guideWords),dist.exports.setLang(t.langName);const e=await dist.exports.search(this.guideWords,{suggestion:!1,limit:this.searchSize});console.log("res.results.length: ",e.results.length),this.searchResults=e.results},clearSearchResults(){for(;this.searchResults.length;)this.searchResults.pop()},async updateOTDDate(){const t=await dist.exports.onThisDay({type:"selected",month:this.otddate.split("/")[1],day:this.otddate.split("/")[2]});this.otditems=t.selected,this.otdtype="selected",this.otdlabel=date.formatDate(this.otddate,"MM/DD")},async otdOptionsCB(t){const e=await dist.exports.onThisDay({type:this.otdtype});this.otditems=e[this.otdtype]},loadImage(t){try{this.store.currentPage.imgs[this.store.imgIdx]=t}catch(e){console.log(e),this.store.notify({msg:"Please create or open a page to load the image into"})}},updateHistoryBuffer(){for(;this.history.length>this.historySize;)this.history.pop()}}}),_hoisted_1$4=createBaseVNode("div",{class:"text-h6"},"Select Date",-1),_hoisted_2$4=createBaseVNode("div",{class:"text-h6"},"Limit Search Results Size",-1),_hoisted_3$3=createBaseVNode("div",{class:"text-h6"},"Number of pages generated",-1),_hoisted_4$3=createBaseVNode("div",{class:"text-h6"},"Limit Image Results Size",-1),_hoisted_5$3=createBaseVNode("div",null,"The initial search does not return images. This limit applies when loading a search result.",-1),_hoisted_6$3=createBaseVNode("div",{class:"text-h6"},"History Size",-1),_hoisted_7$3=createBaseVNode("div",{class:"text-h6"},"Set Language For WP",-1),_hoisted_8$3=createBaseVNode("span",{class:"on-right",id:"sfi"},null,-1),_hoisted_9$3={width:"100%",class:"z-max"},_hoisted_10$3=createBaseVNode("div",{class:"text-h6"},"Guide Words",-1),_hoisted_11$3=createBaseVNode("div",{class:"text-h6"},"Search Terms",-1),_hoisted_12$2=createBaseVNode("div",{id:"iframeContainer"},null,-1),_hoisted_13$2=createBaseVNode("br",null,null,-1),_hoisted_14$1=createBaseVNode("br",null,null,-1),_hoisted_15$1={key:0},_hoisted_16$1={class:"row cardheader ptr justify-between"},_hoisted_17$1=["onClick"],_hoisted_18$1=createBaseVNode("br",null,null,-1),_hoisted_19$1={class:"q-pa-md",style:{"max-width":"350px"}},_hoisted_20$1={key:0},_hoisted_21$1={class:"row cardheader ptr justify-between"},_hoisted_22$1=["onClick"],_hoisted_23$1={class:"hidden"},_hoisted_24$1={class:"q-pa-md",style:{"max-width":"350px"}},_hoisted_25={class:"row cardheader ptr justify-between"},_hoisted_26=["onClick"],_hoisted_27={class:"hidden"},_hoisted_28={class:"q-pa-md",style:{"max-width":"350px"}},_hoisted_29={class:"row cardheader ptr justify-between"},_hoisted_30=["onClick"],_hoisted_31={class:"hidden"};function _sfc_render$4(t,e,r,n,o,a){return openBlock(),createElementBlock(Fragment,null,[createVNode(QDialog,{modelValue:t.promptOTDDate,"onUpdate:modelValue":e[2]||(e[2]=s=>t.promptOTDDate=s),persistent:""},{default:withCtx(()=>[createVNode(QCard,{style:{"min-width":"350px"}},{default:withCtx(()=>[createVNode(QCardSection,{align:"center"},{default:withCtx(()=>[_hoisted_1$4]),_:1}),createVNode(QDate,{modelValue:t.otddate,"onUpdate:modelValue":e[0]||(e[0]=s=>t.otddate=s),minimal:""},null,8,["modelValue"]),createVNode(QCardActions,{align:"center",class:"text-white"},{default:withCtx(()=>[withDirectives(createVNode(QBtn,{flat:"",label:"Cancel"},null,512),[[ClosePopup]]),withDirectives(createVNode(QBtn,{flat:"",label:"Update OTD date",onClick:e[1]||(e[1]=s=>this.updateOTDDate())},null,512),[[ClosePopup]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),createVNode(QDialog,{modelValue:t.promptSearchSize,"onUpdate:modelValue":e[4]||(e[4]=s=>t.promptSearchSize=s),persistent:""},{default:withCtx(()=>[createVNode(QCard,{style:{"min-width":"350px"}},{default:withCtx(()=>[createVNode(QCardSection,{align:"center"},{default:withCtx(()=>[_hoisted_2$4]),_:1}),createVNode(QCardSection,{class:"q-pt-none",align:"center"},{default:withCtx(()=>[createVNode(QKnob,{"show-value":"",size:"140px",thickness:.5,color:"positive","track-color":"green-3","center-color":"grey-8",class:"text-white col q-ma-md",modelValue:t.searchSize,"onUpdate:modelValue":e[3]||(e[3]=s=>t.searchSize=s)},null,8,["modelValue"])]),_:1}),createVNode(QCardActions,{align:"center",class:"text-white"},{default:withCtx(()=>[withDirectives(createVNode(QBtn,{flat:"",label:"Done"},null,512),[[ClosePopup]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),createVNode(QDialog,{modelValue:t.promptNumPages,"onUpdate:modelValue":e[6]||(e[6]=s=>t.promptNumPages=s),persistent:""},{default:withCtx(()=>[createVNode(QCard,{style:{"min-width":"350px"}},{default:withCtx(()=>[createVNode(QCardSection,{align:"center"},{default:withCtx(()=>[_hoisted_3$3]),_:1}),createVNode(QCardSection,{class:"q-pt-none",align:"center"},{default:withCtx(()=>[createVNode(QKnob,{"show-value":"",size:"140px",thickness:.5,color:"positive","track-color":"green-3","center-color":"grey-8",class:"text-white col q-ma-md",modelValue:t.numPages,"onUpdate:modelValue":e[5]||(e[5]=s=>t.numPages=s)},null,8,["modelValue"])]),_:1}),createVNode(QCardActions,{align:"center",class:"text-white"},{default:withCtx(()=>[withDirectives(createVNode(QBtn,{flat:"",label:"Done"},null,512),[[ClosePopup]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),createVNode(QDialog,{modelValue:t.promptImageResultsSize,"onUpdate:modelValue":e[8]||(e[8]=s=>t.promptImageResultsSize=s),persistent:""},{default:withCtx(()=>[createVNode(QCard,{style:{"min-width":"350px"}},{default:withCtx(()=>[createVNode(QCardSection,{align:"center"},{default:withCtx(()=>[_hoisted_4$3,_hoisted_5$3]),_:1}),createVNode(QCardSection,{class:"q-pt-none",align:"center"},{default:withCtx(()=>[createVNode(QKnob,{"show-value":"",size:"140px",thickness:.5,color:"positive","track-color":"green-3","center-color":"grey-8",class:"text-white col q-ma-md",modelValue:t.imageResultsSize,"onUpdate:modelValue":e[7]||(e[7]=s=>t.imageResultsSize=s)},null,8,["modelValue"])]),_:1}),createVNode(QCardActions,{align:"center",class:"text-white"},{default:withCtx(()=>[withDirectives(createVNode(QBtn,{flat:"",label:"Done"},null,512),[[ClosePopup]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),createVNode(QDialog,{modelValue:t.promptHistorySize,"onUpdate:modelValue":e[11]||(e[11]=s=>t.promptHistorySize=s),persistent:""},{default:withCtx(()=>[createVNode(QCard,{style:{"min-width":"350px"}},{default:withCtx(()=>[createVNode(QCardSection,{align:"center"},{default:withCtx(()=>[_hoisted_6$3]),_:1}),createVNode(QCardSection,{class:"q-pt-none",align:"center"},{default:withCtx(()=>[createVNode(QKnob,{"show-value":"",size:"140px",thickness:.5,color:"positive","track-color":"green-3","center-color":"grey-8",class:"text-white col q-ma-md",modelValue:t.historySize,"onUpdate:modelValue":e[9]||(e[9]=s=>t.historySize=s)},null,8,["modelValue"])]),_:1}),createVNode(QCardActions,{align:"center",class:"text-white"},{default:withCtx(()=>[withDirectives(createVNode(QBtn,{flat:"",label:"Done",onClick:e[10]||(e[10]=s=>this.updateHistoryBuffer())},null,512),[[ClosePopup]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),createVNode(QDialog,{modelValue:t.promptLanguage,"onUpdate:modelValue":e[13]||(e[13]=s=>t.promptLanguage=s),persistent:""},{default:withCtx(()=>[createVNode(QCard,{style:{"min-width":"350px"}},{default:withCtx(()=>[createVNode(QCardSection,null,{default:withCtx(()=>[_hoisted_7$3,createTextVNode(),_hoisted_8$3]),_:1}),createVNode(QCardSection,{class:"q-pt-none"},{default:withCtx(()=>[createBaseVNode("table",_hoisted_9$3,[createBaseVNode("tr",null,[createBaseVNode("td",null,[createVNode(QSelect,{class:"z-max",outlined:"",modelValue:this.store.userSnapshot.preferences.langVoiceKey,"onUpdate:modelValue":[e[12]||(e[12]=s=>this.store.userSnapshot.preferences.langVoiceKey=s),this.langChangeCB],options:this.store.userSnapshot.preferences.langVoices},null,8,["modelValue","options","onUpdate:modelValue"])])])])]),_:1}),createVNode(QCardActions,{align:"right",class:"text-white"},{default:withCtx(()=>[withDirectives(createVNode(QBtn,{outline:"",flat:"",label:"Done"},null,512),[[ClosePopup]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),createVNode(QDialog,{modelValue:t.promptGW,"onUpdate:modelValue":e[18]||(e[18]=s=>t.promptGW=s),persistent:""},{default:withCtx(()=>[createVNode(QCard,{style:{"min-width":"350px"}},{default:withCtx(()=>[createVNode(QCardSection,null,{default:withCtx(()=>[_hoisted_10$3]),_:1}),createVNode(QCardSection,{class:"q-pt-none"},{default:withCtx(()=>[createVNode(QInput,{dense:"",modelValue:this.guideWords,"onUpdate:modelValue":e[14]||(e[14]=s=>this.guideWords=s),autofocus:"",onKeyup:e[15]||(e[15]=withKeys(s=>{this.generateAssignment(),t.promptGW=!1},["enter"]))},null,8,["modelValue"])]),_:1}),createVNode(QCardActions,{align:"right"},{default:withCtx(()=>[withDirectives(createVNode(QBtn,{outline:"",label:"Close",onClick:e[16]||(e[16]=s=>this.promptGW=!1)},null,512),[[ClosePopup]]),withDirectives(createVNode(QBtn,{outline:"",label:"Generate",onClick:e[17]||(e[17]=s=>this.generateAssignment())},null,512),[[ClosePopup]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),createVNode(QDialog,{modelValue:t.promptSearch,"onUpdate:modelValue":e[23]||(e[23]=s=>t.promptSearch=s),persistent:""},{default:withCtx(()=>[createVNode(QCard,{style:{"min-width":"350px"}},{default:withCtx(()=>[createVNode(QCardSection,null,{default:withCtx(()=>[_hoisted_11$3]),_:1}),createVNode(QCardSection,{class:"q-pt-none"},{default:withCtx(()=>[createVNode(QInput,{dense:"",modelValue:this.guideWords,"onUpdate:modelValue":e[19]||(e[19]=s=>this.guideWords=s),autofocus:"",onKeyup:e[20]||(e[20]=withKeys(s=>{this.doSearch(),t.promptSearch=!1},["enter"]))},null,8,["modelValue"])]),_:1}),createVNode(QCardActions,{align:"right"},{default:withCtx(()=>[withDirectives(createVNode(QBtn,{outline:"",label:"Close",onClick:e[21]||(e[21]=s=>this.promptSearch=!1)},null,512),[[ClosePopup]]),withDirectives(createVNode(QBtn,{outline:"",label:"Search",onClick:e[22]||(e[22]=s=>this.doSearch())},null,512),[[ClosePopup]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),createVNode(QDialog,{modelValue:t.showPreview,"onUpdate:modelValue":e[24]||(e[24]=s=>t.showPreview=s),persistent:""},null,8,["modelValue"]),createVNode(QCard,{flat:"",bordered:"","no-padding":"",class:"q-ma-md cursor-pointer flex flex-center card-component"},{default:withCtx(()=>[_hoisted_12$2,createVNode(QList,{dense:"",bordered:"",class:"full-width"},{default:withCtx(()=>[createVNode(QBar,null,{default:withCtx(()=>[createTextVNode("Wikipedia Content")]),_:1}),createVNode(QExpansionItem,{label:"Generate Courses",class:"hidden"},{default:withCtx(()=>[createVNode(QBar,null,{default:withCtx(()=>[createVNode(QBtn,{onClick:e[25]||(e[25]=s=>this.generateCourse())},{default:withCtx(()=>[createTextVNode("Generate Course")]),_:1}),createVNode(QBtn,{onClick:e[26]||(e[26]=s=>t.promptGW=!0)},{default:withCtx(()=>[createTextVNode("Guide Words")]),_:1})]),_:1})]),_:1}),createVNode(QExpansionItem,{label:"Generate Assignment"},{default:withCtx(()=>[createVNode(QBar,{class:"q-py-lg"},{default:withCtx(()=>[createVNode(QBtn,{onClick:e[27]||(e[27]=s=>this.promptNumPages=!0)},{default:withCtx(()=>[createTextVNode(toDisplayString(this.numPages)+" ",1),createVNode(QTooltip,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:withCtx(()=>[createVNode(QCard,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:withCtx(()=>[createTextVNode(" Change number of pages generated ")]),_:1})]),_:1})]),_:1}),createBaseVNode("span",{class:"on-right cursor-pointer",id:"sfi",onClick:e[28]||(e[28]=s=>t.promptLanguage=!0)},[createVNode(QTooltip,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:withCtx(()=>[createVNode(QCard,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:withCtx(()=>[createTextVNode(" Change Wikipedia language for new pages ")]),_:1})]),_:1})]),createVNode(QSpace),createVNode(QBtn,{class:"on-right",onClick:e[29]||(e[29]=s=>t.promptGW=!0),icon:"play_arrow"},{default:withCtx(()=>[createVNode(QTooltip,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:withCtx(()=>[createVNode(QCard,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:withCtx(()=>[createTextVNode(" Generate pages ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),createVNode(QExpansionItem,{label:"Generate Pages",class:"hidden"},{default:withCtx(()=>[createVNode(QBar,null,{default:withCtx(()=>[createVNode(QBtn,{onClick:e[30]||(e[30]=s=>this.generatePages())},{default:withCtx(()=>[createTextVNode("Generate Page")]),_:1}),createVNode(QBtn,{onClick:e[31]||(e[31]=s=>t.promptGW=!0)},{default:withCtx(()=>[createTextVNode("Guide Words")]),_:1})]),_:1})]),_:1}),createVNode(QExpansionItem,{label:"Search"},{default:withCtx(()=>[createVNode(QBar,{class:"q-py-lg"},{default:withCtx(()=>[createVNode(QBtn,{dark:"",standout:"",onClick:e[32]||(e[32]=s=>t.promptSearchSize=!0)},{default:withCtx(()=>[createTextVNode(toDisplayString(this.searchSize)+" ",1),createVNode(QTooltip,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:withCtx(()=>[createVNode(QCard,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:withCtx(()=>[createTextVNode(" Change results limit ("+toDisplayString(this.searchSize)+") ",1)]),_:1})]),_:1})]),_:1}),createVNode(QBtn,{dark:"",standout:"",onClick:e[33]||(e[33]=s=>t.promptImageResultsSize=!0)},{default:withCtx(()=>[createTextVNode(toDisplayString(this.imageResultsSize)+" ",1),createVNode(QTooltip,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:withCtx(()=>[createVNode(QCard,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:withCtx(()=>[createTextVNode(" Change number of images returned ("+toDisplayString(this.imageResultsSize)+").",1),_hoisted_13$2,createTextVNode(" The initial search does not return images."),_hoisted_14$1,createTextVNode(" This limit applies when loading a search result. ")]),_:1})]),_:1})]),_:1}),createBaseVNode("span",{class:"on-right cursor-pointer",id:"sfi",onClick:e[34]||(e[34]=s=>t.promptLanguage=!0)}),createVNode(QSpace),createVNode(QBtn,{class:"on-right",onClick:e[35]||(e[35]=s=>t.promptSearch=!0),icon:"search"})]),_:1}),this.searchResults.length?(openBlock(),createElementBlock("div",_hoisted_15$1,[(openBlock(!0),createElementBlock(Fragment,null,renderList(this.searchResults,(s,i)=>(openBlock(),createBlock(QCard,{class:"q-ma-sm",flat:"",bordered:"",modelValue:this.searchResults,"onUpdate:modelValue":e[36]||(e[36]=d=>this.searchResults=d),key:i},{default:withCtx(()=>[createBaseVNode("div",_hoisted_16$1,[createBaseVNode("span",{class:"history-title col-grow",onClick:d=>this.loadSearch(i)},toDisplayString(i)+". "+toDisplayString(s.title.slice(0,25)),9,_hoisted_17$1)])]),_:2},1032,["modelValue"]))),128))])):createCommentVNode("",!0)]),_:1}),createVNode(QExpansionItem,{label:"On This Day"},{default:withCtx(()=>[createVNode(QBar,{class:"q-py-lg"},{default:withCtx(()=>[createVNode(QBtn,{dark:"",standout:"",icon:"calendar_today",onClick:e[37]||(e[37]=s=>t.promptOTDDate=!0)}),createBaseVNode("span",{class:"on-right cursor-pointer",id:"sfi",onClick:e[38]||(e[38]=s=>t.promptLanguage=!0)}),createVNode(QSpace),createVNode(QSelect,{dark:"",dense:"",modelValue:this.otdtype,"onUpdate:modelValue":e[39]||(e[39]=s=>this.otdtype=s),options:["events","holidays","births","deaths","selected"],"emit-value":"",onPopupHide:e[40]||(e[40]=s=>this.otdOptionsCB()),class:"on-right"},null,8,["modelValue"])]),_:1}),(openBlock(!0),createElementBlock(Fragment,null,renderList(t.otditems,(s,i)=>(openBlock(),createBlock(QCard,{class:"q-pa-sm q-ma-sm",flat:"",bordered:"",modelValue:t.otditems,"onUpdate:modelValue":e[41]||(e[41]=d=>t.otditems=d),key:i},{default:withCtx(()=>[createVNode(QBadge,{class:"on-left",style:{cursor:"pointer"},onClick:d=>this.loadOTD(i)},{default:withCtx(()=>[createVNode(QTooltip,null,{default:withCtx(()=>[createTextVNode("OTD result "+toDisplayString(i),1)]),_:2},1024),createVNode(QIcon,{size:"xs",name:"link"})]),_:2},1032,["onClick"]),createTextVNode(" "+toDisplayString(s.year)+" "+toDisplayString(s.text),1),_hoisted_18$1,(openBlock(!0),createElementBlock(Fragment,null,renderList(s.pages,(d,g)=>(openBlock(),createElementBlock("span",{key:g},[createVNode(QBadge,{class:"on-left",style:{cursor:"pointer"},onClick:l=>this.loadOTDPageId(d.pageid,this.store.userSnapshot.preferences.langVoiceKey)},{default:withCtx(()=>[createVNode(QTooltip,null,{default:withCtx(()=>[createTextVNode(toDisplayString(d.title),1)]),_:2},1024),createVNode(QIcon,{size:"xs",name:"link"})]),_:2},1032,["onClick"])]))),128))]),_:2},1032,["modelValue"]))),128))]),_:1})]),_:1})]),_:1}),createBaseVNode("div",_hoisted_19$1,[createVNode(QList,{bordered:"",class:"rounded-borders",icon:"gear"},{default:withCtx(()=>[createVNode(QExpansionItem,{label:"Saved Bookmarks"},{default:withCtx(()=>{var s;return[(s=this.store.userSnapshot)!=null&&s.bookmarks?(openBlock(),createElementBlock("div",_hoisted_20$1,[(openBlock(!0),createElementBlock(Fragment,null,renderList(this.store.userSnapshot.bookmarks,(i,d)=>(openBlock(),createBlock(QCard,{class:"q-ma-sm",flat:"",bordered:"",modelValue:this.store.userSnapshot.bookmarks,"onUpdate:modelValue":e[42]||(e[42]=g=>this.store.userSnapshot.bookmarks=g),key:d},{default:withCtx(()=>[createBaseVNode("div",_hoisted_21$1,[createBaseVNode("span",{class:"history-title col-grow q-py-xs q-px-sm",onClick:g=>this.loadOTDPageId(i.pageid,i.langVoiceKey)},toDisplayString(d.slice(0,20)),9,_hoisted_22$1),createBaseVNode("span",_hoisted_23$1,toDisplayString(i),1),createVNode(QIcon,{class:"q-pb-xs q-pt-sm q-px-sm",size:t.xl,color:t.primary,name:"clear",onClick:g=>this.store.removeBookmark(d)},null,8,["size","color","onClick"])])]),_:2},1032,["modelValue"]))),128))])):createCommentVNode("",!0)]}),_:1})]),_:1})]),createBaseVNode("div",_hoisted_24$1,[createVNode(QList,{bordered:"",class:"rounded-borders",icon:"gear"},{default:withCtx(()=>[createVNode(QExpansionItem,{label:"Saved Images"},{default:withCtx(()=>{var s;return[(openBlock(!0),createElementBlock(Fragment,null,renderList((s=this.store.userSnapshot)==null?void 0:s.images,(i,d)=>(openBlock(),createBlock(QCard,{class:"q-ma-sm",flat:"",bordered:"",modelValue:this.store.userSnapshot.images,"onUpdate:modelValue":e[43]||(e[43]=g=>this.store.userSnapshot.images=g),key:d},{default:withCtx(()=>[createBaseVNode("div",_hoisted_25,[createBaseVNode("span",{class:"history-title col-grow q-py-xs q-px-sm",onClick:g=>this.loadImage(i)},toDisplayString(i.cap.slice(0,20)),9,_hoisted_26),createBaseVNode("span",_hoisted_27,toDisplayString(d),1),createVNode(QIcon,{class:"q-pb-xs q-pt-sm q-px-sm",size:t.xl,color:t.primary,name:"clear",onClick:g=>this.store.removeImage(d)},null,8,["size","color","onClick"])])]),_:2},1032,["modelValue"]))),128))]}),_:1})]),_:1})]),createBaseVNode("div",_hoisted_28,[createVNode(QList,{bordered:"",class:"rounded-borders",icon:"gear"},{default:withCtx(()=>[createVNode(QExpansionItem,{label:"Saved History"},{default:withCtx(()=>[createVNode(QBar,{class:"q-py-lg"},{default:withCtx(()=>[createVNode(QBtn,{dark:"",standout:"",onClick:e[44]||(e[44]=s=>t.promptHistorySize=!0)},{default:withCtx(()=>[createTextVNode(toDisplayString(this.historySize)+" ",1),createVNode(QTooltip,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:withCtx(()=>[createVNode(QCard,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:withCtx(()=>[createTextVNode(" Change history size ("+toDisplayString(this.historySize)+") ",1)]),_:1})]),_:1})]),_:1}),createVNode(QBtn,{icon:"clear",onClick:e[45]||(e[45]=s=>this.history=[])})]),_:1}),(openBlock(!0),createElementBlock(Fragment,null,renderList(this.history,(s,i)=>(openBlock(),createBlock(QCard,{class:"q-ma-sm",flat:"",bordered:"",modelValue:this.history,"onUpdate:modelValue":e[46]||(e[46]=d=>this.history=d),key:i},{default:withCtx(()=>[createBaseVNode("div",_hoisted_29,[createBaseVNode("span",{class:"history-title col-grow q-py-xs q-px-sm",onClick:d=>this.loadOTDPageId(s.pageid,s.langVoiceKey)},toDisplayString(s.title),9,_hoisted_30),createBaseVNode("span",_hoisted_31,toDisplayString(i),1)])]),_:2},1032,["modelValue"]))),128))]),_:1})]),_:1})])],64)}var WPComponent=_export_sfc(_sfc_main$4,[["render",_sfc_render$4]]),V3_URL="https://js.stripe.com/v3",V3_URL_REGEX=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,EXISTING_SCRIPT_MESSAGE="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",findScript=function t(){for(var e=document.querySelectorAll('script[src^="'.concat(V3_URL,'"]')),r=0;r<e.length;r++){var n=e[r];if(!!V3_URL_REGEX.test(n.src))return n}return null},injectScript=function t(e){var r=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",n=document.createElement("script");n.src="".concat(V3_URL).concat(r);var o=document.head||document.body;if(!o)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return o.appendChild(n),n},registerWrapper=function t(e,r){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"1.52.1",startTime:r})},stripePromise=null,loadScript=function t(e){return stripePromise!==null||(stripePromise=new Promise(function(r,n){if(typeof window=="undefined"||typeof document=="undefined"){r(null);return}if(window.Stripe&&e&&console.warn(EXISTING_SCRIPT_MESSAGE),window.Stripe){r(window.Stripe);return}try{var o=findScript();o&&e?console.warn(EXISTING_SCRIPT_MESSAGE):o||(o=injectScript(e)),o.addEventListener("load",function(){window.Stripe?r(window.Stripe):n(new Error("Stripe.js not available"))}),o.addEventListener("error",function(){n(new Error("Failed to load Stripe.js"))})}catch(a){n(a);return}})),stripePromise},initStripe=function t(e,r,n){if(e===null)return null;var o=e.apply(void 0,r);return registerWrapper(o,n),o},stripePromise$1=Promise.resolve().then(function(){return loadScript(null)}),loadCalled=!1;stripePromise$1.catch(function(t){loadCalled||console.warn(t)});var loadStripe=function t(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];loadCalled=!0;var o=Date.now();return stripePromise$1.then(function(a){return initStripe(a,r,o)})};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const stringToByteArray$1$1=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let o=t.charCodeAt(n);o<128?e[r++]=o:o<2048?(e[r++]=o>>6|192,e[r++]=o&63|128):(o&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(o=65536+((o&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=o>>18|240,e[r++]=o>>12&63|128,e[r++]=o>>6&63|128,e[r++]=o&63|128):(e[r++]=o>>12|224,e[r++]=o>>6&63|128,e[r++]=o&63|128)}return e},byteArrayToString$1=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const o=t[r++];if(o<128)e[n++]=String.fromCharCode(o);else if(o>191&&o<224){const a=t[r++];e[n++]=String.fromCharCode((o&31)<<6|a&63)}else if(o>239&&o<365){const a=t[r++],s=t[r++],i=t[r++],d=((o&7)<<18|(a&63)<<12|(s&63)<<6|i&63)-65536;e[n++]=String.fromCharCode(55296+(d>>10)),e[n++]=String.fromCharCode(56320+(d&1023))}else{const a=t[r++],s=t[r++];e[n++]=String.fromCharCode((o&15)<<12|(a&63)<<6|s&63)}}return e.join("")},base64$1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let o=0;o<t.length;o+=3){const a=t[o],s=o+1<t.length,i=s?t[o+1]:0,d=o+2<t.length,g=d?t[o+2]:0,l=a>>2,c=(a&3)<<4|i>>4;let p=(i&15)<<2|g>>6,v=g&63;d||(v=64,s||(p=64)),n.push(r[l],r[c],r[p],r[v])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(stringToByteArray$1$1(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):byteArrayToString$1(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let o=0;o<t.length;){const a=r[t.charAt(o++)],i=o<t.length?r[t.charAt(o)]:0;++o;const g=o<t.length?r[t.charAt(o)]:64;++o;const c=o<t.length?r[t.charAt(o)]:64;if(++o,a==null||i==null||g==null||c==null)throw Error();const p=a<<2|i>>4;if(n.push(p),g!==64){const v=i<<4&240|g>>2;if(n.push(v),c!==64){const P=g<<6&192|c;n.push(P)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},base64Encode=function(t){const e=stringToByteArray$1$1(t);return base64$1.encodeByteArray(e,!0)},base64urlEncodeWithoutPadding=function(t){return base64Encode(t).replace(/\./g,"")};function isIndexedDBAvailable(){return typeof indexedDB=="object"}function validateIndexedDBOpenable(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(n);o.onsuccess=()=>{o.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},o.onupgradeneeded=()=>{r=!1},o.onerror=()=>{var a;e(((a=o.error)===null||a===void 0?void 0:a.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERROR_NAME$1="FirebaseError";class FirebaseError$1 extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=ERROR_NAME$1,Object.setPrototypeOf(this,FirebaseError$1.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ErrorFactory$1.prototype.create)}}class ErrorFactory$1{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},o=`${this.service}/${e}`,a=this.errors[e],s=a?replaceTemplate$1(a,n):"Error",i=`${this.serviceName}: ${s} (${o}).`;return new FirebaseError$1(o,i,n)}}function replaceTemplate$1(t,e){return t.replace(PATTERN$1,(r,n)=>{const o=e[n];return o!=null?String(o):`<${n}?>`})}const PATTERN$1=/\{\$([^}]+)}/g;class Component$1{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var LogLevel$1;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(LogLevel$1||(LogLevel$1={}));const levelStringToEnum$1={debug:LogLevel$1.DEBUG,verbose:LogLevel$1.VERBOSE,info:LogLevel$1.INFO,warn:LogLevel$1.WARN,error:LogLevel$1.ERROR,silent:LogLevel$1.SILENT},defaultLogLevel$1=LogLevel$1.INFO,ConsoleMethod$1={[LogLevel$1.DEBUG]:"log",[LogLevel$1.VERBOSE]:"log",[LogLevel$1.INFO]:"info",[LogLevel$1.WARN]:"warn",[LogLevel$1.ERROR]:"error"},defaultLogHandler$1=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),o=ConsoleMethod$1[e];if(o)console[o](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Logger$1{constructor(e){this.name=e,this._logLevel=defaultLogLevel$1,this._logHandler=defaultLogHandler$1,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in LogLevel$1))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?levelStringToEnum$1[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel$1.DEBUG,...e),this._logHandler(this,LogLevel$1.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel$1.VERBOSE,...e),this._logHandler(this,LogLevel$1.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel$1.INFO,...e),this._logHandler(this,LogLevel$1.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel$1.WARN,...e),this._logHandler(this,LogLevel$1.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel$1.ERROR,...e),this._logHandler(this,LogLevel$1.ERROR,...e)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PlatformLoggerServiceImpl{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(isVersionServiceProvider(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function isVersionServiceProvider(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const name$o="@firebase/app",version$1="0.7.33";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logger=new Logger$1("@firebase/app"),name$n="@firebase/app-compat",name$m="@firebase/analytics-compat",name$l="@firebase/analytics",name$k="@firebase/app-check-compat",name$j="@firebase/app-check",name$i="@firebase/auth",name$h="@firebase/auth-compat",name$g="@firebase/database",name$f="@firebase/database-compat",name$e="@firebase/functions",name$d="@firebase/functions-compat",name$c="@firebase/installations",name$b="@firebase/installations-compat",name$a="@firebase/messaging",name$9="@firebase/messaging-compat",name$8="@firebase/performance",name$7="@firebase/performance-compat",name$6="@firebase/remote-config",name$5="@firebase/remote-config-compat",name$4="@firebase/storage",name$3="@firebase/storage-compat",name$2="@firebase/firestore",name$1="@firebase/firestore-compat",name$p="firebase",version$2="9.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ENTRY_NAME="[DEFAULT]",PLATFORM_LOG_STRING={[name$o]:"fire-core",[name$n]:"fire-core-compat",[name$l]:"fire-analytics",[name$m]:"fire-analytics-compat",[name$j]:"fire-app-check",[name$k]:"fire-app-check-compat",[name$i]:"fire-auth",[name$h]:"fire-auth-compat",[name$g]:"fire-rtdb",[name$f]:"fire-rtdb-compat",[name$e]:"fire-fn",[name$d]:"fire-fn-compat",[name$c]:"fire-iid",[name$b]:"fire-iid-compat",[name$a]:"fire-fcm",[name$9]:"fire-fcm-compat",[name$8]:"fire-perf",[name$7]:"fire-perf-compat",[name$6]:"fire-rc",[name$5]:"fire-rc-compat",[name$4]:"fire-gcs",[name$3]:"fire-gcs-compat",[name$2]:"fire-fst",[name$1]:"fire-fst-compat","fire-js":"fire-js",[name$p]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _apps=new Map,_components=new Map;function _addComponent(t,e){try{t.container.addComponent(e)}catch(r){logger.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function _registerComponent(t){const e=t.name;if(_components.has(e))return logger.debug(`There were multiple attempts to register component ${e}.`),!1;_components.set(e,t);for(const r of _apps.values())_addComponent(r,t);return!0}function _getProvider(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERRORS={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["idb-open"]:"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",["idb-get"]:"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",["idb-set"]:"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",["idb-delete"]:"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},ERROR_FACTORY=new ErrorFactory$1("app","Firebase",ERRORS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SDK_VERSION=version$2;function getApp(t=DEFAULT_ENTRY_NAME){const e=_apps.get(t);if(!e)throw ERROR_FACTORY.create("no-app",{appName:t});return e}function registerVersion(t,e,r){var n;let o=(n=PLATFORM_LOG_STRING[t])!==null&&n!==void 0?n:t;r&&(o+=`-${r}`);const a=o.match(/\s|\//),s=e.match(/\s|\//);if(a||s){const i=[`Unable to register library "${o}" with version "${e}":`];a&&i.push(`library name "${o}" contains illegal characters (whitespace or "/")`),a&&s&&i.push("and"),s&&i.push(`version name "${e}" contains illegal characters (whitespace or "/")`),logger.warn(i.join(" "));return}_registerComponent(new Component$1(`${o}-version`,()=>({library:o,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DB_NAME$1="firebase-heartbeat-database",DB_VERSION$1=1,STORE_NAME="firebase-heartbeat-store";let dbPromise=null;function getDbPromise(){return dbPromise||(dbPromise=openDB(DB_NAME$1,DB_VERSION$1,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(STORE_NAME)}}}).catch(t=>{throw ERROR_FACTORY.create("idb-open",{originalErrorMessage:t.message})})),dbPromise}async function readHeartbeatsFromIndexedDB(t){var e;try{return(await getDbPromise()).transaction(STORE_NAME).objectStore(STORE_NAME).get(computeKey(t))}catch(r){if(r instanceof FirebaseError$1)logger.warn(r.message);else{const n=ERROR_FACTORY.create("idb-get",{originalErrorMessage:(e=r)===null||e===void 0?void 0:e.message});logger.warn(n.message)}}}async function writeHeartbeatsToIndexedDB(t,e){var r;try{const o=(await getDbPromise()).transaction(STORE_NAME,"readwrite");return await o.objectStore(STORE_NAME).put(e,computeKey(t)),o.done}catch(n){if(n instanceof FirebaseError$1)logger.warn(n.message);else{const o=ERROR_FACTORY.create("idb-set",{originalErrorMessage:(r=n)===null||r===void 0?void 0:r.message});logger.warn(o.message)}}}function computeKey(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MAX_HEADER_BYTES=1024,STORED_HEARTBEAT_RETENTION_MAX_MILLIS=30*24*60*60*1e3;class HeartbeatServiceImpl{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new HeartbeatStorageImpl(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=getUTCDateString();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(o=>o.date===n)))return this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=STORED_HEARTBEAT_RETENTION_MAX_MILLIS}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=getUTCDateString(),{heartbeatsToSend:r,unsentEntries:n}=extractHeartbeatsForHeader(this._heartbeatsCache.heartbeats),o=base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}}function getUTCDateString(){return new Date().toISOString().substring(0,10)}function extractHeartbeatsForHeader(t,e=MAX_HEADER_BYTES){const r=[];let n=t.slice();for(const o of t){const a=r.find(s=>s.agent===o.agent);if(a){if(a.dates.push(o.date),countBytes(r)>e){a.dates.pop();break}}else if(r.push({agent:o.agent,dates:[o.date]}),countBytes(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class HeartbeatStorageImpl{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return isIndexedDBAvailable()?validateIndexedDBOpenable().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await readHeartbeatsFromIndexedDB(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const o=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const o=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}else return}}function countBytes(t){return base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function registerCoreComponents(t){_registerComponent(new Component$1("platform-logger",e=>new PlatformLoggerServiceImpl(e),"PRIVATE")),_registerComponent(new Component$1("heartbeat",e=>new HeartbeatServiceImpl(e),"PRIVATE")),registerVersion(name$o,version$1,t),registerVersion(name$o,version$1,"esm2017"),registerVersion("fire-js","")}registerCoreComponents("");registerVersion("firestore-stripe-payments","0.0.6");function getStripePayments(t,e){return StripePayments.create(t,e)}class StripePayments{constructor(e,r){this.app=e,this.options=r,this.components={}}static create(e,r){return new StripePayments(e,r)}get customersCollection(){return this.options.customersCollection}get productsCollection(){return this.options.productsCollection}getComponent(e){let r=this.components[e];return r||null}setComponent(e,r){this.components[e]=r}}class StripePaymentsError extends Error{constructor(e,r,n){super(r),this.code=e,this.message=r,this.cause=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var stringToByteArray$1=function(t){for(var e=[],r=0,n=0;n<t.length;n++){var o=t.charCodeAt(n);o<128?e[r++]=o:o<2048?(e[r++]=o>>6|192,e[r++]=o&63|128):(o&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(o=65536+((o&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=o>>18|240,e[r++]=o>>12&63|128,e[r++]=o>>6&63|128,e[r++]=o&63|128):(e[r++]=o>>12|224,e[r++]=o>>6&63|128,e[r++]=o&63|128)}return e},byteArrayToString=function(t){for(var e=[],r=0,n=0;r<t.length;){var o=t[r++];if(o<128)e[n++]=String.fromCharCode(o);else if(o>191&&o<224){var a=t[r++];e[n++]=String.fromCharCode((o&31)<<6|a&63)}else if(o>239&&o<365){var a=t[r++],s=t[r++],i=t[r++],d=((o&7)<<18|(a&63)<<12|(s&63)<<6|i&63)-65536;e[n++]=String.fromCharCode(55296+(d>>10)),e[n++]=String.fromCharCode(56320+(d&1023))}else{var a=t[r++],s=t[r++];e[n++]=String.fromCharCode((o&15)<<12|(a&63)<<6|s&63)}}return e.join("")},base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[],o=0;o<t.length;o+=3){var a=t[o],s=o+1<t.length,i=s?t[o+1]:0,d=o+2<t.length,g=d?t[o+2]:0,l=a>>2,c=(a&3)<<4|i>>4,p=(i&15)<<2|g>>6,v=g&63;d||(v=64,s||(p=64)),n.push(r[l],r[c],r[p],r[v])}return n.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(stringToByteArray$1(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):byteArrayToString(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[],o=0;o<t.length;){var a=r[t.charAt(o++)],s=o<t.length,i=s?r[t.charAt(o)]:0;++o;var d=o<t.length,g=d?r[t.charAt(o)]:64;++o;var l=o<t.length,c=l?r[t.charAt(o)]:64;if(++o,a==null||i==null||g==null||c==null)throw Error();var p=a<<2|i>>4;if(n.push(p),g!==64){var v=i<<4&240|g>>2;if(n.push(v),c!==64){var P=g<<6&192|c;n.push(P)}}}return n},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},base64Decode=function(t){try{return base64.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getUA(){return typeof navigator!="undefined"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function isMobileCordova(){return typeof window!="undefined"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA())}function isBrowserExtension(){var t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function isReactNative(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function isIE(){var t=getUA();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ERROR_NAME="FirebaseError",FirebaseError=function(t){__extends(e,t);function e(r,n,o){var a=t.call(this,n)||this;return a.code=r,a.customData=o,a.name=ERROR_NAME,Object.setPrototypeOf(a,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(a,ErrorFactory.prototype.create),a}return e}(Error),ErrorFactory=function(){function t(e,r,n){this.service=e,this.serviceName=r,this.errors=n}return t.prototype.create=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=r[0]||{},a=this.service+"/"+e,s=this.errors[e],i=s?replaceTemplate(s,o):"Error",d=this.serviceName+": "+i+" ("+a+").",g=new FirebaseError(a,d,o);return g},t}();function replaceTemplate(t,e){return t.replace(PATTERN,function(r,n){var o=e[n];return o!=null?String(o):"<"+n+"?>"})}var PATTERN=/\{\$([^}]+)}/g;function isEmpty(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function deepEqual(t,e){if(t===e)return!0;for(var r=Object.keys(t),n=Object.keys(e),o=0,a=r;o<a.length;o++){var s=a[o];if(!n.includes(s))return!1;var i=t[s],d=e[s];if(isObject(i)&&isObject(d)){if(!deepEqual(i,d))return!1}else if(i!==d)return!1}for(var g=0,l=n;g<l.length;g++){var s=l[g];if(!r.includes(s))return!1}return!0}function isObject(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function querystring(t){for(var e=[],r=function(d,g){Array.isArray(g)?g.forEach(function(l){e.push(encodeURIComponent(d)+"="+encodeURIComponent(l))}):e.push(encodeURIComponent(d)+"="+encodeURIComponent(g))},n=0,o=Object.entries(t);n<o.length;n++){var a=o[n],s=a[0],i=a[1];r(s,i)}return e.length?"&"+e.join("&"):""}function createSubscribe(t,e){var r=new ObserverProxy(t,e);return r.subscribe.bind(r)}var ObserverProxy=function(){function t(e,r){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(function(){e(n)}).catch(function(o){n.error(o)})}return t.prototype.next=function(e){this.forEachObserver(function(r){r.next(e)})},t.prototype.error=function(e){this.forEachObserver(function(r){r.error(e)}),this.close(e)},t.prototype.complete=function(){this.forEachObserver(function(e){e.complete()}),this.close()},t.prototype.subscribe=function(e,r,n){var o=this,a;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");implementsAnyMethods(e,["next","error","complete"])?a=e:a={next:e,error:r,complete:n},a.next===void 0&&(a.next=noop),a.error===void 0&&(a.error=noop),a.complete===void 0&&(a.complete=noop);var s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{o.finalError?a.error(o.finalError):a.complete()}catch{}}),this.observers.push(a),s},t.prototype.unsubscribeOne=function(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))},t.prototype.forEachObserver=function(e){if(!this.finalized)for(var r=0;r<this.observers.length;r++)this.sendOne(r,e)},t.prototype.sendOne=function(e,r){var n=this;this.task.then(function(){if(n.observers!==void 0&&n.observers[e]!==void 0)try{r(n.observers[e])}catch(o){typeof console!="undefined"&&console.error&&console.error(o)}})},t.prototype.close=function(e){var r=this;this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(function(){r.observers=void 0,r.onNoObservers=void 0}))},t}();function implementsAnyMethods(t,e){if(typeof t!="object"||t===null)return!1;for(var r=0,n=e;r<n.length;r++){var o=n[r];if(o in t&&typeof t[o]=="function")return!0}return!1}function noop(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getModularInstance(t){return t&&t._delegate?t._delegate:t}/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function __spreadArrays(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),o=0,e=0;e<r;e++)for(var a=arguments[e],s=0,i=a.length;s<i;s++,o++)n[o]=a[s];return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _a,LogLevel;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(LogLevel||(LogLevel={}));var levelStringToEnum={debug:LogLevel.DEBUG,verbose:LogLevel.VERBOSE,info:LogLevel.INFO,warn:LogLevel.WARN,error:LogLevel.ERROR,silent:LogLevel.SILENT},defaultLogLevel=LogLevel.INFO,ConsoleMethod=(_a={},_a[LogLevel.DEBUG]="log",_a[LogLevel.VERBOSE]="log",_a[LogLevel.INFO]="info",_a[LogLevel.WARN]="warn",_a[LogLevel.ERROR]="error",_a),defaultLogHandler=function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];if(!(e<t.logLevel)){var o=new Date().toISOString(),a=ConsoleMethod[e];if(a)console[a].apply(console,__spreadArrays(["["+o+"]  "+t.name+":"],r));else throw new Error("Attempted to log a message with an invalid logType (value: "+e+")")}},Logger=function(){function t(e){this.name=e,this._logLevel=defaultLogLevel,this._logHandler=defaultLogHandler,this._userLogHandler=null}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in LogLevel))throw new TypeError('Invalid value "'+e+'" assigned to `logLevel`');this._logLevel=e},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(e){this._logLevel=typeof e=="string"?levelStringToEnum[e]:e},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,__spreadArrays([this,LogLevel.DEBUG],e)),this._logHandler.apply(this,__spreadArrays([this,LogLevel.DEBUG],e))},t.prototype.log=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,__spreadArrays([this,LogLevel.VERBOSE],e)),this._logHandler.apply(this,__spreadArrays([this,LogLevel.VERBOSE],e))},t.prototype.info=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,__spreadArrays([this,LogLevel.INFO],e)),this._logHandler.apply(this,__spreadArrays([this,LogLevel.INFO],e))},t.prototype.warn=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,__spreadArrays([this,LogLevel.WARN],e)),this._logHandler.apply(this,__spreadArrays([this,LogLevel.WARN],e))},t.prototype.error=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,__spreadArrays([this,LogLevel.ERROR],e)),this._logHandler.apply(this,__spreadArrays([this,LogLevel.ERROR],e))},t}(),Component=function(){function t(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},t.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},t.prototype.setServiceProps=function(e){return this.serviceProps=e,this},t.prototype.setInstanceCreatedCallback=function(e){return this.onInstanceCreated=e,this},t}();function _prodErrorMap(){return{["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const prodErrorMap=_prodErrorMap,_DEFAULT_AUTH_ERROR_FACTORY=new ErrorFactory("auth","Firebase",_prodErrorMap());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logClient=new Logger("@firebase/auth");function _logError(t,...e){logClient.logLevel<=LogLevel.ERROR&&logClient.error(`Auth (${SDK_VERSION}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _fail(t,...e){throw createErrorInternal(t,...e)}function _createError(t,...e){return createErrorInternal(t,...e)}function _errorWithCustomMessage(t,e,r){const n=Object.assign(Object.assign({},prodErrorMap()),{[e]:r});return new ErrorFactory("auth","Firebase",n).create(e,{appName:t.name})}function createErrorInternal(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return _DEFAULT_AUTH_ERROR_FACTORY.create(t,...e)}function _assert(t,e,...r){if(!t)throw createErrorInternal(e,...r)}function debugFail(t){const e="INTERNAL ASSERTION FAILED: "+t;throw _logError(e),new Error(e)}function debugAssert(t,e){t||debugFail(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const instanceCache=new Map;function _getInstance(t){debugAssert(t instanceof Function,"Expected a class definition");let e=instanceCache.get(t);return e?(debugAssert(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,instanceCache.set(t,e),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function initializeAuth(t,e){const r=_getProvider(t,"auth");if(r.isInitialized()){const o=r.getImmediate(),a=r.getOptions();if(deepEqual(a,e!=null?e:{}))return o;_fail(o,"already-initialized")}return r.initialize({options:e})}function _initializeAuthInstance(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(_getInstance);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getCurrentUrl(){var t;return typeof self!="undefined"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function _isHttpOrHttps(){return _getCurrentScheme()==="http:"||_getCurrentScheme()==="https:"}function _getCurrentScheme(){var t;return typeof self!="undefined"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _isOnline(){return typeof navigator!="undefined"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(_isHttpOrHttps()||isBrowserExtension()||"connection"in navigator)?navigator.onLine:!0}function _getUserLanguage(){if(typeof navigator=="undefined")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Delay{constructor(e,r){this.shortDelay=e,this.longDelay=r,debugAssert(r>e,"Short delay should be less than long delay!"),this.isMobile=isMobileCordova()||isReactNative()}get(){return _isOnline()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _emulatorUrl(t,e){debugAssert(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FetchProvider{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self!="undefined"&&"fetch"in self)return self.fetch;debugFail("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self!="undefined"&&"Headers"in self)return self.Headers;debugFail("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self!="undefined"&&"Response"in self)return self.Response;debugFail("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SERVER_ERROR_MAP={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_API_TIMEOUT_MS=new Delay(3e4,6e4);function _addTidIfNecessary(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function _performApiRequest(t,e,r,n,o={}){return _performFetchWithErrorHandling(t,o,()=>{let a={},s={};n&&(e==="GET"?s=n:a={body:JSON.stringify(n)});const i=querystring(Object.assign({key:t.config.apiKey},s)).slice(1),d=new(FetchProvider.headers());return d.set("Content-Type","application/json"),d.set("X-Client-Version",t._getSdkClientVersion()),t.languageCode&&d.set("X-Firebase-Locale",t.languageCode),FetchProvider.fetch()(_getFinalTarget(t,t.config.apiHost,r,i),Object.assign({method:e,headers:d,referrerPolicy:"no-referrer"},a))})}async function _performFetchWithErrorHandling(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},SERVER_ERROR_MAP),e);try{const o=new NetworkTimeout(t),a=await Promise.race([r(),o.promise]);o.clearNetworkTimeout();const s=await a.json();if("needConfirmation"in s)throw _makeTaggedError(t,"account-exists-with-different-credential",s);if(a.ok&&!("errorMessage"in s))return s;{const i=a.ok?s.errorMessage:s.error.message,[d,g]=i.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw _makeTaggedError(t,"credential-already-in-use",s);if(d==="EMAIL_EXISTS")throw _makeTaggedError(t,"email-already-in-use",s);const l=n[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(g)throw _errorWithCustomMessage(t,l,g);_fail(t,l)}}catch(o){if(o instanceof FirebaseError)throw o;_fail(t,"network-request-failed")}}async function _performSignInRequest(t,e,r,n,o={}){const a=await _performApiRequest(t,e,r,n,o);return"mfaPendingCredential"in a&&_fail(t,"multi-factor-auth-required",{serverResponse:a}),a}function _getFinalTarget(t,e,r,n){const o=`${e}${r}?${n}`;return t.config.emulator?_emulatorUrl(t.config,o):`${t.config.apiScheme}://${o}`}class NetworkTimeout{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(_createError(this.auth,"timeout")),DEFAULT_API_TIMEOUT_MS.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function _makeTaggedError(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const o=_createError(t,e,n);return o.customData._tokenResponse=r,o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function deleteAccount(t,e){return _performApiRequest(t,"POST","/v1/accounts:delete",e)}async function getAccountInfo(t,e){return _performApiRequest(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function utcTimestampToDateString(t){if(!!t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function getIdTokenResult(t,e=!1){const r=getModularInstance(t),n=await r.getIdToken(e),o=_parseToken(n);_assert(o&&o.exp&&o.auth_time&&o.iat,r.auth,"internal-error");const a=typeof o.firebase=="object"?o.firebase:void 0,s=a==null?void 0:a.sign_in_provider;return{claims:o,token:n,authTime:utcTimestampToDateString(secondsStringToMilliseconds(o.auth_time)),issuedAtTime:utcTimestampToDateString(secondsStringToMilliseconds(o.iat)),expirationTime:utcTimestampToDateString(secondsStringToMilliseconds(o.exp)),signInProvider:s||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function secondsStringToMilliseconds(t){return Number(t)*1e3}function _parseToken(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return _logError("JWT malformed, contained fewer than 3 sections"),null;try{const o=base64Decode(r);return o?JSON.parse(o):(_logError("Failed to decode base64 JWT payload"),null)}catch(o){return _logError("Caught error parsing JWT payload as JSON",o),null}}function _tokenExpiresIn(t){const e=_parseToken(t);return _assert(e,"internal-error"),_assert(typeof e.exp!="undefined","internal-error"),_assert(typeof e.iat!="undefined","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _logoutIfInvalidated(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof FirebaseError&&isUserInvalidated(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function isUserInvalidated({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ProactiveRefresh{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const o=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,o)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UserMetadata{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=utcTimestampToDateString(this.lastLoginAt),this.creationTime=utcTimestampToDateString(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _reloadWithoutSaving(t){var e;const r=t.auth,n=await t.getIdToken(),o=await _logoutIfInvalidated(t,getAccountInfo(r,{idToken:n}));_assert(o==null?void 0:o.users.length,r,"internal-error");const a=o.users[0];t._notifyReloadListener(a);const s=!((e=a.providerUserInfo)===null||e===void 0)&&e.length?extractProviderData(a.providerUserInfo):[],i=mergeProviderData(t.providerData,s),d=t.isAnonymous,g=!(t.email&&a.passwordHash)&&!(i!=null&&i.length),l=d?g:!1,c={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:i,metadata:new UserMetadata(a.createdAt,a.lastLoginAt),isAnonymous:l};Object.assign(t,c)}async function reload(t){const e=getModularInstance(t);await _reloadWithoutSaving(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function mergeProviderData(t,e){return[...t.filter(n=>!e.some(o=>o.providerId===n.providerId)),...e]}function extractProviderData(t){return t.map(e=>{var{providerId:r}=e,n=__rest$2(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function requestStsToken(t,e){const r=await _performFetchWithErrorHandling(t,{},()=>{const n=querystring({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:a}=t.config,s=_getFinalTarget(t,o,"/v1/token",`key=${a}`);return FetchProvider.fetch()(s,{method:"POST",headers:{"X-Client-Version":t._getSdkClientVersion(),"Content-Type":"application/x-www-form-urlencoded"},body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class StsTokenManager{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){_assert(e.idToken,"internal-error"),_assert(typeof e.idToken!="undefined","internal-error"),_assert(typeof e.refreshToken!="undefined","internal-error");const r="expiresIn"in e&&typeof e.expiresIn!="undefined"?Number(e.expiresIn):_tokenExpiresIn(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}async getToken(e,r=!1){return _assert(!this.accessToken||this.refreshToken,e,"user-token-expired"),!r&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:o,expiresIn:a}=await requestStsToken(e,r);this.updateTokensAndExpiration(n,o,Number(a))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:o,expirationTime:a}=r,s=new StsTokenManager;return n&&(_assert(typeof n=="string","internal-error",{appName:e}),s.refreshToken=n),o&&(_assert(typeof o=="string","internal-error",{appName:e}),s.accessToken=o),a&&(_assert(typeof a=="number","internal-error",{appName:e}),s.expirationTime=a),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new StsTokenManager,this.toJSON())}_performRefresh(){return debugFail("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function assertStringOrUndefined(t,e){_assert(typeof t=="string"||typeof t=="undefined","internal-error",{appName:e})}class UserImpl{constructor(e){var{uid:r,auth:n,stsTokenManager:o}=e,a=__rest$2(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.emailVerified=!1,this.isAnonymous=!1,this.tenantId=null,this.providerData=[],this.proactiveRefresh=new ProactiveRefresh(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=o,this.accessToken=o.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.metadata=new UserMetadata(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const r=await _logoutIfInvalidated(this,this.stsTokenManager.getToken(this.auth,e));return _assert(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return getIdTokenResult(this,e)}reload(){return reload(this)}_assign(e){this!==e&&(_assert(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new UserImpl(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){_assert(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await _reloadWithoutSaving(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await _logoutIfInvalidated(this,deleteAccount(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,o,a,s,i,d,g,l;const c=(n=r.displayName)!==null&&n!==void 0?n:void 0,p=(o=r.email)!==null&&o!==void 0?o:void 0,v=(a=r.phoneNumber)!==null&&a!==void 0?a:void 0,P=(s=r.photoURL)!==null&&s!==void 0?s:void 0,k=(i=r.tenantId)!==null&&i!==void 0?i:void 0,S=(d=r._redirectEventId)!==null&&d!==void 0?d:void 0,M=(g=r.createdAt)!==null&&g!==void 0?g:void 0,K=(l=r.lastLoginAt)!==null&&l!==void 0?l:void 0,{uid:D,emailVerified:E,isAnonymous:R,providerData:H,stsTokenManager:B}=r;_assert(D&&B,e,"internal-error");const Q=StsTokenManager.fromJSON(this.name,B);_assert(typeof D=="string",e,"internal-error"),assertStringOrUndefined(c,e.name),assertStringOrUndefined(p,e.name),_assert(typeof E=="boolean",e,"internal-error"),_assert(typeof R=="boolean",e,"internal-error"),assertStringOrUndefined(v,e.name),assertStringOrUndefined(P,e.name),assertStringOrUndefined(k,e.name),assertStringOrUndefined(S,e.name),assertStringOrUndefined(M,e.name),assertStringOrUndefined(K,e.name);const U=new UserImpl({uid:D,auth:e,email:p,emailVerified:E,displayName:c,isAnonymous:R,photoURL:P,phoneNumber:v,tenantId:k,stsTokenManager:Q,createdAt:M,lastLoginAt:K});return H&&Array.isArray(H)&&(U.providerData=H.map(z=>Object.assign({},z))),S&&(U._redirectEventId=S),U}static async _fromIdTokenResponse(e,r,n=!1){const o=new StsTokenManager;o.updateFromServerResponse(r);const a=new UserImpl({uid:r.localId,auth:e,stsTokenManager:o,isAnonymous:n});return await _reloadWithoutSaving(a),a}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class InMemoryPersistence{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}InMemoryPersistence.type="NONE";const inMemoryPersistence=InMemoryPersistence;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _persistenceKeyName(t,e,r){return`firebase:${t}:${e}:${r}`}class PersistenceUserManager{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:o,name:a}=this.auth;this.fullUserKey=_persistenceKeyName(this.userKey,o.apiKey,a),this.fullPersistenceKey=_persistenceKeyName("persistence",o.apiKey,a),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?UserImpl._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new PersistenceUserManager(_getInstance(inMemoryPersistence),e,n);const o=(await Promise.all(r.map(async g=>{if(await g._isAvailable())return g}))).filter(g=>g);let a=o[0]||_getInstance(inMemoryPersistence);const s=_persistenceKeyName(n,e.config.apiKey,e.name);let i=null;for(const g of r)try{const l=await g._get(s);if(l){const c=UserImpl._fromJSON(e,l);g!==a&&(i=c),a=g;break}}catch{}const d=o.filter(g=>g._shouldAllowMigration);return!a._shouldAllowMigration||!d.length?new PersistenceUserManager(a,e,n):(a=d[0],i&&await a._set(s,i.toJSON()),await Promise.all(r.map(async g=>{if(g!==a)try{await g._remove(s)}catch{}})),new PersistenceUserManager(a,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getBrowserName(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(_isIEMobile(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(_isFirefox(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(_isBlackBerry(e))return"Blackberry";if(_isWebOS(e))return"Webos";if(_isSafari(e))return"Safari";if((e.includes("chrome/")||_isChromeIOS(e))&&!e.includes("edge/"))return"Chrome";if(_isAndroid(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function _isFirefox(t=getUA()){return/firefox\//i.test(t)}function _isSafari(t=getUA()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function _isChromeIOS(t=getUA()){return/crios\//i.test(t)}function _isIEMobile(t=getUA()){return/iemobile/i.test(t)}function _isAndroid(t=getUA()){return/android/i.test(t)}function _isBlackBerry(t=getUA()){return/blackberry/i.test(t)}function _isWebOS(t=getUA()){return/webos/i.test(t)}function _isIOS(t=getUA()){return/iphone|ipad|ipod/i.test(t)}function _isIOSStandalone(t=getUA()){var e;return _isIOS(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function _isIE10(){return isIE()&&document.documentMode===10}function _isMobileBrowser(t=getUA()){return _isIOS(t)||_isAndroid(t)||_isWebOS(t)||_isBlackBerry(t)||/windows phone/i.test(t)||_isIEMobile(t)}function _isIframe(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getClientVersion(t,e=[]){let r;switch(t){case"Browser":r=_getBrowserName(getUA());break;case"Worker":r=`${_getBrowserName(getUA())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${SDK_VERSION}/${n}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthImpl{constructor(e,r){this.app=e,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Subscription(this),this.idTokenSubscription=new Subscription(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=_DEFAULT_AUTH_ERROR_FACTORY,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=_getInstance(r)),this._initializationPromise=this.queue(async()=>{var n;this._deleted||(this.persistenceManager=await PersistenceUserManager.create(this,e),!this._deleted&&(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively&&await this._popupRedirectResolver._initialize(this),await this.initializeCurrentUser(r),!this._deleted&&(this._isInitialized=!0)))}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e)}}async initializeCurrentUser(e){var r;let n=await this.assertedPersistence.getCurrentUser();if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,a=n==null?void 0:n._redirectEventId,s=await this.tryRedirectSignIn(e);(!o||o===a)&&(s==null?void 0:s.user)&&(n=s.user)}return n?n._redirectEventId?(_assert(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)):this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await _reloadWithoutSaving(e)}catch(r){if(r.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=_getUserLanguage()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const r=e?getModularInstance(e):null;return r&&_assert(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e){if(!this._deleted)return e&&_assert(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(_getInstance(e))})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ErrorFactory("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&_getInstance(e)||this._popupRedirectResolver;_assert(r,this,"argument-error"),this.redirectPersistenceManager=await PersistenceUserManager.create(this,[_getInstance(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,o){if(this._deleted)return()=>{};const a=typeof r=="function"?r:r.next.bind(r),s=this._isInitialized?Promise.resolve():this._initializationPromise;return _assert(s,this,"internal-error"),s.then(()=>a(this.currentUser)),typeof r=="function"?e.addObserver(r,n,o):e.addObserver(r)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&(this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh()),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return _assert(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=_getClientVersion(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getSdkClientVersion(){return this.clientVersion}}function _castAuth(t){return getModularInstance(t)}class Subscription{constructor(e){this.auth=e,this.observer=null,this.addObserver=createSubscribe(r=>this.observer=r)}get next(){return _assert(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthCredential{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return debugFail("not implemented")}_getIdTokenResponse(e){return debugFail("not implemented")}_linkToIdToken(e,r){return debugFail("not implemented")}_getReauthenticationResolver(e){return debugFail("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInWithIdp(t,e){return _performSignInRequest(t,"POST","/v1/accounts:signInWithIdp",_addTidIfNecessary(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IDP_REQUEST_URI$1="http://localhost";class OAuthCredential extends AuthCredential{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new OAuthCredential(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):_fail("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:o}=r,a=__rest$2(r,["providerId","signInMethod"]);if(!n||!o)return null;const s=new OAuthCredential(n,o);return Object.assign(s,a),s}_getIdTokenResponse(e){const r=this.buildRequest();return signInWithIdp(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,signInWithIdp(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,signInWithIdp(e,r)}buildRequest(){const e={requestUri:IDP_REQUEST_URI$1,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=querystring(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FederatedAuthProvider{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BaseOAuthProvider extends FederatedAuthProvider{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FacebookAuthProvider extends BaseOAuthProvider{constructor(){super("facebook.com")}static credential(e){return OAuthCredential._fromParams({providerId:FacebookAuthProvider.PROVIDER_ID,signInMethod:FacebookAuthProvider.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return FacebookAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return FacebookAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return FacebookAuthProvider.credential(e.oauthAccessToken)}catch{return null}}}FacebookAuthProvider.FACEBOOK_SIGN_IN_METHOD="facebook.com";FacebookAuthProvider.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GoogleAuthProvider extends BaseOAuthProvider{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return OAuthCredential._fromParams({providerId:GoogleAuthProvider.PROVIDER_ID,signInMethod:GoogleAuthProvider.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return GoogleAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return GoogleAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return GoogleAuthProvider.credential(r,n)}catch{return null}}}GoogleAuthProvider.GOOGLE_SIGN_IN_METHOD="google.com";GoogleAuthProvider.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GithubAuthProvider extends BaseOAuthProvider{constructor(){super("github.com")}static credential(e){return OAuthCredential._fromParams({providerId:GithubAuthProvider.PROVIDER_ID,signInMethod:GithubAuthProvider.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return GithubAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return GithubAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return GithubAuthProvider.credential(e.oauthAccessToken)}catch{return null}}}GithubAuthProvider.GITHUB_SIGN_IN_METHOD="github.com";GithubAuthProvider.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TwitterAuthProvider extends BaseOAuthProvider{constructor(){super("twitter.com")}static credential(e,r){return OAuthCredential._fromParams({providerId:TwitterAuthProvider.PROVIDER_ID,signInMethod:TwitterAuthProvider.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return TwitterAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return TwitterAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return TwitterAuthProvider.credential(r,n)}catch{return null}}}TwitterAuthProvider.TWITTER_SIGN_IN_METHOD="twitter.com";TwitterAuthProvider.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UserCredentialImpl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,o=!1){const a=await UserImpl._fromIdTokenResponse(e,n,o),s=providerIdForResponse(n);return new UserCredentialImpl({user:a,providerId:s,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const o=providerIdForResponse(n);return new UserCredentialImpl({user:e,providerId:o,_tokenResponse:n,operationType:r})}}function providerIdForResponse(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MultiFactorError extends FirebaseError{constructor(e,r,n,o){var a;super(r.code,r.message),this.operationType=n,this.user=o,this.name="FirebaseError",Object.setPrototypeOf(this,MultiFactorError.prototype),this.appName=e.name,this.code=r.code,this.tenantId=(a=e.tenantId)!==null&&a!==void 0?a:void 0,this.serverResponse=r.customData.serverResponse}static _fromErrorAndOperation(e,r,n,o){return new MultiFactorError(e,r,n,o)}}function _processCredentialSavingMfaContextIfNecessary(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?MultiFactorError._fromErrorAndOperation(t,a,e,n):a})}async function _link$1(t,e,r=!1){const n=await _logoutIfInvalidated(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return UserCredentialImpl._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _reauthenticate(t,e,r=!1){const{auth:n}=t,o="reauthenticate";try{const a=await _logoutIfInvalidated(t,_processCredentialSavingMfaContextIfNecessary(n,o,e,t),r);_assert(a.idToken,n,"internal-error");const s=_parseToken(a.idToken);_assert(s,n,"internal-error");const{sub:i}=s;return _assert(t.uid===i,n,"user-mismatch"),UserCredentialImpl._forOperation(t,o,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&_fail(n,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _signInWithCredential(t,e,r=!1){const n="signIn",o=await _processCredentialSavingMfaContextIfNecessary(t,n,e),a=await UserCredentialImpl._fromIdTokenResponse(t,n,o);return r||await t._updateCurrentUser(a.user),a}const STORAGE_AVAILABLE_KEY="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BrowserPersistenceClass{constructor(e,r){this.storage=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(STORAGE_AVAILABLE_KEY,"1"),this.storage.removeItem(STORAGE_AVAILABLE_KEY),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _iframeCannotSyncWebStorage(){const t=getUA();return _isSafari(t)||_isIOS(t)}const _POLLING_INTERVAL_MS$1=1e3,IE10_LOCAL_STORAGE_SYNC_DELAY=10;class BrowserLocalPersistence extends BrowserPersistenceClass{constructor(){super(window.localStorage,"LOCAL"),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=_iframeCannotSyncWebStorage()&&_isIframe(),this.fallbackToPolling=_isMobileBrowser(),this._shouldAllowMigration=!0,this.boundEventHandler=this.onStorageEvent.bind(this)}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),o=this.localCache[r];n!==o&&e(r,o,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((s,i,d)=>{this.notifyListeners(s,d)});return}const n=e.key;if(r?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const s=this.storage.getItem(n);if(e.newValue!==s)e.newValue!==null?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!r)return}const o=()=>{const s=this.storage.getItem(n);!r&&this.localCache[n]===s||this.notifyListeners(n,s)},a=this.storage.getItem(n);_isIE10()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,IE10_LOCAL_STORAGE_SYNC_DELAY):o()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const o of Array.from(n))o(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},_POLLING_INTERVAL_MS$1)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}BrowserLocalPersistence.type="LOCAL";const browserLocalPersistence=BrowserLocalPersistence;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BrowserSessionPersistence extends BrowserPersistenceClass{constructor(){super(window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}BrowserSessionPersistence.type="SESSION";const browserSessionPersistence=BrowserSessionPersistence;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _allSettled(t){return Promise.all(t.map(async e=>{try{const r=await e;return{fulfilled:!0,value:r}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Receiver{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(o=>o.isListeningto(e));if(r)return r;const n=new Receiver(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:o,data:a}=r.data,s=this.handlersMap[o];if(!(s!=null&&s.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:o});const i=Array.from(s).map(async g=>g(r.origin,a)),d=await _allSettled(i);r.ports[0].postMessage({status:"done",eventId:n,eventType:o,response:d})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Receiver.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _generateEventId(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sender{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const o=typeof MessageChannel!="undefined"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let a,s;return new Promise((i,d)=>{const g=_generateEventId("",20);o.port1.start();const l=setTimeout(()=>{d(new Error("unsupported_event"))},n);s={messageChannel:o,onMessage(c){const p=c;if(p.data.eventId===g)switch(p.data.status){case"ack":clearTimeout(l),a=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),i(p.data.response);break;default:clearTimeout(l),clearTimeout(a),d(new Error("invalid_response"));break}}},this.handlers.add(s),o.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:g,data:r},[o.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _window(){return window}function _setWindowLocation(t){_window().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _isWorker(){return typeof _window().WorkerGlobalScope!="undefined"&&typeof _window().importScripts=="function"}async function _getActiveServiceWorker(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function _getServiceWorkerController(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function _getWorkerGlobalScope(){return _isWorker()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DB_NAME="firebaseLocalStorageDb",DB_VERSION=1,DB_OBJECTSTORE_NAME="firebaseLocalStorage",DB_DATA_KEYPATH="fbase_key";class DBPromise{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function getObjectStore(t,e){return t.transaction([DB_OBJECTSTORE_NAME],e?"readwrite":"readonly").objectStore(DB_OBJECTSTORE_NAME)}function _deleteDatabase(){const t=indexedDB.deleteDatabase(DB_NAME);return new DBPromise(t).toPromise()}function _openDatabase(){const t=indexedDB.open(DB_NAME,DB_VERSION);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(DB_OBJECTSTORE_NAME,{keyPath:DB_DATA_KEYPATH})}catch(o){r(o)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(DB_OBJECTSTORE_NAME)?e(n):(n.close(),await _deleteDatabase(),e(await _openDatabase()))})})}async function _putObject(t,e,r){const n=getObjectStore(t,!0).put({[DB_DATA_KEYPATH]:e,value:r});return new DBPromise(n).toPromise()}async function getObject(t,e){const r=getObjectStore(t,!1).get(e),n=await new DBPromise(r).toPromise();return n===void 0?null:n.value}function _deleteObject(t,e){const r=getObjectStore(t,!0).delete(e);return new DBPromise(r).toPromise()}const _POLLING_INTERVAL_MS=800,_TRANSACTION_RETRY_COUNT=3;class IndexedDBLocalPersistence{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await _openDatabase(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>_TRANSACTION_RETRY_COUNT)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return _isWorker()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Receiver._getInstance(_getWorkerGlobalScope()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await _getActiveServiceWorker(),!this.activeServiceWorker)return;this.sender=new Sender(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);!n||((e=n[0])===null||e===void 0?void 0:e.fulfilled)&&((r=n[0])===null||r===void 0?void 0:r.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||_getServiceWorkerController()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await _openDatabase();return await _putObject(e,STORAGE_AVAILABLE_KEY,"1"),await _deleteObject(e,STORAGE_AVAILABLE_KEY),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>_putObject(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>getObject(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>_deleteObject(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const a=getObjectStore(o,!1).getAll();return new DBPromise(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;for(const{fbase_key:o,value:a}of e)n.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(a)&&(this.notifyListeners(o,a),r.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!n.has(o)&&(this.notifyListeners(o,null),r.push(o));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const o of Array.from(n))o(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),_POLLING_INTERVAL_MS)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}IndexedDBLocalPersistence.type="LOCAL";const indexedDBLocalPersistence=IndexedDBLocalPersistence;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getScriptParentElement(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function _loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=o=>{const a=_createError("internal-error");a.customData=o,r(a)},n.type="text/javascript",n.charset="UTF-8",getScriptParentElement().appendChild(n)})}function _generateCallbackName(t){return`__${t}${Math.floor(Math.random()*1e6)}`}new Delay(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _withDefaultResolver(t,e){return e?_getInstance(e):(_assert(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IdpCredential extends AuthCredential{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return signInWithIdp(e,this._buildIdpRequest())}_linkToIdToken(e,r){return signInWithIdp(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return signInWithIdp(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function _signIn(t){return _signInWithCredential(t.auth,new IdpCredential(t),t.bypassAuthState)}function _reauth(t){const{auth:e,user:r}=t;return _assert(r,e,"internal-error"),_reauthenticate(r,new IdpCredential(t),t.bypassAuthState)}async function _link(t){const{auth:e,user:r}=t;return _assert(r,e,"internal-error"),_link$1(r,new IdpCredential(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AbstractPopupRedirectOperation{constructor(e,r,n,o,a=!1){this.auth=e,this.resolver=n,this.user=o,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:o,tenantId:a,error:s,type:i}=e;if(s){this.reject(s);return}const d={auth:this.auth,requestUri:r,sessionId:n,tenantId:a||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(i)(d))}catch(g){this.reject(g)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return _signIn;case"linkViaPopup":case"linkViaRedirect":return _link;case"reauthViaPopup":case"reauthViaRedirect":return _reauth;default:_fail(this.auth,"internal-error")}}resolve(e){debugAssert(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){debugAssert(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _POLL_WINDOW_CLOSE_TIMEOUT=new Delay(2e3,1e4);class PopupOperation extends AbstractPopupRedirectOperation{constructor(e,r,n,o,a){super(e,r,o,a),this.provider=n,this.authWindow=null,this.pollId=null,PopupOperation.currentPopupAction&&PopupOperation.currentPopupAction.cancel(),PopupOperation.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return _assert(e,this.auth,"internal-error"),e}async onExecution(){debugAssert(this.filter.length===1,"Popup operations only handle one event");const e=_generateEventId();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(_createError(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(_createError(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,PopupOperation.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_createError(this.auth,"popup-closed-by-user"))},2e3);return}this.pollId=window.setTimeout(e,_POLL_WINDOW_CLOSE_TIMEOUT.get())};e()}}PopupOperation.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PENDING_REDIRECT_KEY="pendingRedirect",redirectOutcomeMap=new Map;class RedirectAction extends AbstractPopupRedirectOperation{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=redirectOutcomeMap.get(this.auth._key());if(!e){try{const n=await _getAndClearPendingRedirectStatus(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}redirectOutcomeMap.set(this.auth._key(),e)}return e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function _getAndClearPendingRedirectStatus(t,e){const r=pendingRedirectKey(e),n=await resolverPersistence(t)._get(r)==="true";return await resolverPersistence(t)._remove(r),n}function resolverPersistence(t){return _getInstance(t._redirectPersistence)}function pendingRedirectKey(t){return _persistenceKeyName(PENDING_REDIRECT_KEY,t.config.apiKey,t.name)}async function _getRedirectResult(t,e,r=!1){const n=_castAuth(t),o=_withDefaultResolver(n,e),s=await new RedirectAction(n,o,r).execute();return s&&!r&&(delete s.user._redirectEventId,await n._persistUserIfCurrent(s.user),await n._setRedirectUser(null,e)),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EVENT_DUPLICATION_CACHE_DURATION_MS=10*60*1e3;class AuthEventManager{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!isRedirectEvent(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!isNullRedirectEvent(e)){const o=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(_createError(this.auth,o))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=EVENT_DUPLICATION_CACHE_DURATION_MS&&this.cachedEventUids.clear(),this.cachedEventUids.has(eventUid(e))}saveEventToCache(e){this.cachedEventUids.add(eventUid(e)),this.lastProcessedEventTime=Date.now()}}function eventUid(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function isNullRedirectEvent({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function isRedirectEvent(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return isNullRedirectEvent(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _getProjectConfig(t,e={}){return _performApiRequest(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IP_ADDRESS_REGEX=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,HTTP_REGEX=/^https?/;async function _validateOrigin(t){if(t.config.emulator)return;const{authorizedDomains:e}=await _getProjectConfig(t);for(const r of e)try{if(matchDomain(r))return}catch{}_fail(t,"unauthorized-domain")}function matchDomain(t){const e=_getCurrentUrl(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const s=new URL(t);return s.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&s.hostname===n}if(!HTTP_REGEX.test(r))return!1;if(IP_ADDRESS_REGEX.test(t))return n===t;const o=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NETWORK_TIMEOUT=new Delay(3e4,6e4);function resetUnloadedGapiModules(){const t=_window().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function loadGapi(t){return new Promise((e,r)=>{var n,o,a;function s(){resetUnloadedGapiModules(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{resetUnloadedGapiModules(),r(_createError(t,"network-request-failed"))},timeout:NETWORK_TIMEOUT.get()})}if(!((o=(n=_window().gapi)===null||n===void 0?void 0:n.iframes)===null||o===void 0)&&o.Iframe)e(gapi.iframes.getContext());else if(!((a=_window().gapi)===null||a===void 0)&&a.load)s();else{const i=_generateCallbackName("iframefcb");return _window()[i]=()=>{gapi.load?s():r(_createError(t,"network-request-failed"))},_loadJS(`https://apis.google.com/js/api.js?onload=${i}`)}}).catch(e=>{throw cachedGApiLoader=null,e})}let cachedGApiLoader=null;function _loadGapi(t){return cachedGApiLoader=cachedGApiLoader||loadGapi(t),cachedGApiLoader}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PING_TIMEOUT=new Delay(5e3,15e3),IFRAME_PATH="__/auth/iframe",EMULATED_IFRAME_PATH="emulator/auth/iframe",IFRAME_ATTRIBUTES={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},EID_FROM_APIHOST=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function getIframeUrl(t){const e=t.config;_assert(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?_emulatorUrl(e,EMULATED_IFRAME_PATH):`https://${t.config.authDomain}/${IFRAME_PATH}`,n={apiKey:e.apiKey,appName:t.name,v:SDK_VERSION},o=EID_FROM_APIHOST.get(t.config.apiHost);o&&(n.eid=o);const a=t._getFrameworks();return a.length&&(n.fw=a.join(",")),`${r}?${querystring(n).slice(1)}`}async function _openIframe(t){const e=await _loadGapi(t),r=_window().gapi;return _assert(r,t,"internal-error"),e.open({where:document.body,url:getIframeUrl(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:IFRAME_ATTRIBUTES,dontclear:!0},n=>new Promise(async(o,a)=>{await n.restyle({setHideOnLeave:!1});const s=_createError(t,"network-request-failed"),i=_window().setTimeout(()=>{a(s)},PING_TIMEOUT.get());function d(){_window().clearTimeout(i),o(n)}n.ping(d).then(d,()=>{a(s)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BASE_POPUP_OPTIONS={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},DEFAULT_WIDTH=500,DEFAULT_HEIGHT=600,TARGET_BLANK="_blank",FIREFOX_EMPTY_URL="http://localhost";class AuthPopup{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function _open(t,e,r,n=DEFAULT_WIDTH,o=DEFAULT_HEIGHT){const a=Math.max((window.screen.availHeight-o)/2,0).toString(),s=Math.max((window.screen.availWidth-n)/2,0).toString();let i="";const d=Object.assign(Object.assign({},BASE_POPUP_OPTIONS),{width:n.toString(),height:o.toString(),top:a,left:s}),g=getUA().toLowerCase();r&&(i=_isChromeIOS(g)?TARGET_BLANK:r),_isFirefox(g)&&(e=e||FIREFOX_EMPTY_URL,d.scrollbars="yes");const l=Object.entries(d).reduce((p,[v,P])=>`${p}${v}=${P},`,"");if(_isIOSStandalone(g)&&i!=="_self")return openAsNewWindowIOS(e||"",i),new AuthPopup(null);const c=window.open(e||"",i,l);_assert(c,t,"popup-blocked");try{c.focus()}catch{}return new AuthPopup(c)}function openAsNewWindowIOS(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WIDGET_PATH="__/auth/handler",EMULATOR_WIDGET_PATH="emulator/auth/handler";function _getRedirectUrl(t,e,r,n,o,a){_assert(t.config.authDomain,t,"auth-domain-config-required"),_assert(t.config.apiKey,t,"invalid-api-key");const s={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:SDK_VERSION,eventId:o};if(e instanceof FederatedAuthProvider){e.setDefaultLanguage(t.languageCode),s.providerId=e.providerId||"",isEmpty(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,g]of Object.entries(a||{}))s[d]=g}if(e instanceof BaseOAuthProvider){const d=e.getScopes().filter(g=>g!=="");d.length>0&&(s.scopes=d.join(","))}t.tenantId&&(s.tid=t.tenantId);const i=s;for(const d of Object.keys(i))i[d]===void 0&&delete i[d];return`${getHandlerBase(t)}?${querystring(i).slice(1)}`}function getHandlerBase({config:t}){return t.emulator?_emulatorUrl(t,EMULATOR_WIDGET_PATH):`https://${t.authDomain}/${WIDGET_PATH}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WEB_STORAGE_SUPPORT_KEY="webStorageSupport";class BrowserPopupRedirectResolver{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=browserSessionPersistence,this._completeRedirectFn=_getRedirectResult}async _openPopup(e,r,n,o){var a;debugAssert((a=this.eventManagers[e._key()])===null||a===void 0?void 0:a.manager,"_initialize() not called before _openPopup()");const s=_getRedirectUrl(e,r,n,_getCurrentUrl(),o);return _open(e,s,_generateEventId())}async _openRedirect(e,r,n,o){return await this._originValidation(e),_setWindowLocation(_getRedirectUrl(e,r,n,_getCurrentUrl(),o)),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:o,promise:a}=this.eventManagers[r];return o?Promise.resolve(o):(debugAssert(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n}async initAndGetManager(e){const r=await _openIframe(e),n=new AuthEventManager(e);return r.register("authEvent",o=>(_assert(o==null?void 0:o.authEvent,e,"invalid-auth-event"),{status:n.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(WEB_STORAGE_SUPPORT_KEY,{type:WEB_STORAGE_SUPPORT_KEY},o=>{var a;const s=(a=o==null?void 0:o[0])===null||a===void 0?void 0:a[WEB_STORAGE_SUPPORT_KEY];s!==void 0&&r(!!s),_fail(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=_validateOrigin(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return _isMobileBrowser()||_isSafari()||_isIOS()}}const browserPopupRedirectResolver=BrowserPopupRedirectResolver;var name="@firebase/auth",version="0.17.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthInterop{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{var o;e(((o=n)===null||o===void 0?void 0:o.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);!r||(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){_assert(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getVersionForPlatform(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function registerAuth(t){_registerComponent(new Component("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),{apiKey:o,authDomain:a}=n.options;return(s=>{_assert(o&&!o.includes(":"),"invalid-api-key",{appName:s.name}),_assert(!(a!=null&&a.includes(":")),"argument-error",{appName:s.name});const i={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_getClientVersion(t)},d=new AuthImpl(s,i);return _initializeAuthInstance(d,r),d})(n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),_registerComponent(new Component("auth-internal",e=>{const r=_castAuth(e.getProvider("auth").getImmediate());return(n=>new AuthInterop(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),registerVersion(name,version,getVersionForPlatform(t))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getAuth(t=getApp()){const e=_getProvider(t,"auth");return e.isInitialized()?e.getImmediate():initializeAuth(t,{popupRedirectResolver:browserPopupRedirectResolver,persistence:[indexedDBLocalPersistence,browserLocalPersistence,browserSessionPersistence]})}registerAuth("Browser");function getCurrentUser(t){try{const e=getCurrentUserSync(t);return Promise.resolve(e)}catch(e){return Promise.reject(e)}}function getCurrentUserSync(t){return getOrInitUserDAO(t).getCurrentUser()}class FirebaseAuthUserDAO{constructor(e){this.auth=getAuth(e)}getCurrentUser(){var e;const r=(e=this.auth.currentUser)===null||e===void 0?void 0:e.uid;if(!r)throw new StripePaymentsError("unauthenticated","Failed to determine currently signed in user. User not signed in.");return r}}const USER_DAO_KEY="user-dao";function getOrInitUserDAO(t){let e=t.getComponent(USER_DAO_KEY);return e||(e=new FirebaseAuthUserDAO(t.app),setUserDAO(t,e)),e}function setUserDAO(t,e){t.setComponent(USER_DAO_KEY,e)}function checkNonEmptyString(t,e){if(typeof t!="string"||t==="")throw new Error(e!=null?e:"arg must be a non-empty string.")}function checkPositiveNumber(t,e){if(typeof t!="number"||isNaN(t)||t<=0)throw new Error(e!=null?e:"arg must be positive number.")}function checkNonEmptyArray(t,e){if(!Array.isArray(t)||t.length===0)throw new Error(e!=null?e:"arg must be a non-empty array.")}var __awaiter$2=globalThis&&globalThis.__awaiter||function(t,e,r,n){function o(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function i(l){try{g(n.next(l))}catch(c){s(c)}}function d(l){try{g(n.throw(l))}catch(c){s(c)}}function g(l){l.done?a(l.value):o(l.value).then(i,d)}g((n=n.apply(t,e||[])).next())})},__rest$1=globalThis&&globalThis.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]]);return r};function hasLineItems(t){return"line_items"in t}const CREATE_SESSION_TIMEOUT_MILLIS=30*1e3;function createCheckoutSession(t,e,r){e=Object.assign({},e),checkAndUpdateCommonParams(e),hasLineItems(e)?checkLineItemParams(e):checkPriceIdParams(e);const n=getTimeoutMillis(r==null?void 0:r.timeoutMillis);return getCurrentUser(t).then(o=>getOrInitSessionDAO(t).createCheckoutSession(o,e,n))}function checkAndUpdateCommonParams(t){var e;typeof t.cancel_url!="undefined"?checkNonEmptyString(t.cancel_url,"cancel_url must be a non-empty string."):t.cancel_url=window.location.href,(e=t.mode)!==null&&e!==void 0||(t.mode="subscription"),typeof t.success_url!="undefined"?checkNonEmptyString(t.success_url,"success_url must be a non-empty string."):t.success_url=window.location.href}function checkLineItemParams(t){checkNonEmptyArray(t.line_items,"line_items must be a non-empty array.")}function checkPriceIdParams(t){checkNonEmptyString(t.price,"price must be a non-empty string."),typeof t.quantity!="undefined"&&checkPositiveNumber(t.quantity,"quantity must be a positive integer.")}function getTimeoutMillis(t){return typeof t!="undefined"?(checkPositiveNumber(t,"timeoutMillis must be a positive number."),t):CREATE_SESSION_TIMEOUT_MILLIS}class FirestoreSessionDAO{constructor(e,r){this.customersCollection=r,this.firestore=wh(e)}createCheckoutSession(e,r,n){return __awaiter$2(this,void 0,void 0,function*(){const o=yield this.addSessionDoc(e,r);return this.waitForSessionId(o,n)})}addSessionDoc(e,r){return __awaiter$2(this,void 0,void 0,function*(){const n=sh(this.firestore,this.customersCollection,e,"checkout_sessions");try{return yield uf(n,r)}catch(o){throw new StripePaymentsError("internal","Error while querying Firestore.",o)}})}waitForSessionId(e,r){let n;return new Promise((o,a)=>{const s=setTimeout(()=>{a(new StripePaymentsError("deadline-exceeded","Timeout while waiting for session response."))},r);n=cf(e.withConverter(SESSION_CONVERTER),i=>{const d=i.data();hasSessionId(d)&&(clearTimeout(s),o(d))},i=>{clearTimeout(s),a(new StripePaymentsError("internal","Error while querying Firestore.",i))})}).finally(()=>n())}}function hasSessionId(t){return typeof(t==null?void 0:t.id)!="undefined"}const SESSION_CONVERTER={toFirestore:()=>{throw new Error("Not implemented for readonly Session type.")},fromFirestore:t=>{const e=t.data(),{created:r,sessionId:n}=e,o=__rest$1(e,["created","sessionId"]);return typeof n!="undefined"?Object.assign(Object.assign({},o),{id:n,created_at:toUTCDateString$1(r)}):Object.assign({},o)}};function toUTCDateString$1(t){return t.toDate().toUTCString()}const SESSION_DAO_KEY="checkout-session-dao";function getOrInitSessionDAO(t){let e=t.getComponent(SESSION_DAO_KEY);return e||(e=new FirestoreSessionDAO(t.app,t.customersCollection),setSessionDAO(t,e)),e}function setSessionDAO(t,e){t.setComponent(SESSION_DAO_KEY,e)}globalThis&&globalThis.__awaiter;var __awaiter$1=globalThis&&globalThis.__awaiter||function(t,e,r,n){function o(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function i(l){try{g(n.next(l))}catch(c){s(c)}}function d(l){try{g(n.throw(l))}catch(c){s(c)}}function g(l){l.done?a(l.value):o(l.value).then(i,d)}g((n=n.apply(t,e||[])).next())})},__rest=globalThis&&globalThis.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]]);return r};function getProducts(t,e){const r=getOrInitProductDAO(t),n=e!=null?e:{},{includePrices:o}=n,a=__rest(n,["includePrices"]);return r.getProducts(a).then(s=>{if(o){const i=s.map(d=>getProductWithPrices(r,d));return Promise.all(i)}return s})}function getProductWithPrices(t,e){return __awaiter$1(this,void 0,void 0,function*(){const r=yield t.getPrices(e.id);return Object.assign(Object.assign({},e),{prices:r})})}const PRODUCT_CONVERTER={toFirestore:()=>{throw new Error("Not implemented for readonly Product type.")},fromFirestore:t=>Object.assign(Object.assign({},t.data()),{id:t.id,prices:[]})},PRICE_CONVERTER={toFirestore:()=>{throw new Error("Not implemented for readonly Price type.")},fromFirestore:t=>{const e=t.data();return Object.assign(Object.assign({},e),{id:t.id,product:t.ref.parent.parent.id})}};class FirestoreProductDAO{constructor(e,r){this.productsCollection=r,this.firestore=wh(e)}getProduct(e){return __awaiter$1(this,void 0,void 0,function*(){return(yield this.getProductSnapshotIfExists(e)).data()})}getProducts(e){return __awaiter$1(this,void 0,void 0,function*(){const r=yield this.getProductSnapshots(e),n=[];return r.forEach(o=>{n.push(o.data())}),n})}getPrice(e,r){return __awaiter$1(this,void 0,void 0,function*(){return(yield this.getPriceSnapshotIfExists(e,r)).data()})}getPrices(e,r){return __awaiter$1(this,void 0,void 0,function*(){r!=null&&r.assertProduct&&(yield this.getProductSnapshotIfExists(e));const n=yield this.getPriceSnapshots(e),o=[];return n.forEach(a=>{o.push(a.data())}),o})}getProductSnapshotIfExists(e){return __awaiter$1(this,void 0,void 0,function*(){const r=rh(this.firestore,this.productsCollection,e).withConverter(PRODUCT_CONVERTER),n=yield this.queryFirestore(()=>Jl(r));if(!n.exists())throw new StripePaymentsError("not-found",`No product found with the ID: ${e}`);return n})}getProductSnapshots(e){return __awaiter$1(this,void 0,void 0,function*(){let r=sh(this.firestore,this.productsCollection).withConverter(PRODUCT_CONVERTER);const n=[];if(e!=null&&e.activeOnly&&n.push(_l("active","==",!0)),e!=null&&e.where)for(const o of e.where)n.push(_l(...o));return typeof(e==null?void 0:e.limit)!="undefined"&&n.push(El(e.limit)),yield this.queryFirestore(()=>(n.length>0&&(r=dl(r,...n)),tf(r)))})}getPriceSnapshotIfExists(e,r){return __awaiter$1(this,void 0,void 0,function*(){const n=rh(this.firestore,this.productsCollection,e,"prices",r).withConverter(PRICE_CONVERTER),o=yield this.queryFirestore(()=>Jl(n));if(!o.exists())throw new StripePaymentsError("not-found",`No price found with the product ID: ${e} and price ID: ${r}`);return o})}getPriceSnapshots(e){return __awaiter$1(this,void 0,void 0,function*(){const r=sh(this.firestore,this.productsCollection,e,"prices").withConverter(PRICE_CONVERTER);return yield this.queryFirestore(()=>tf(r))})}queryFirestore(e){return __awaiter$1(this,void 0,void 0,function*(){try{return yield e()}catch(r){throw new StripePaymentsError("internal","Unexpected error while querying Firestore",r)}})}}const PRODUCT_DAO_KEY="product-dao";function getOrInitProductDAO(t){let e=t.getComponent(PRODUCT_DAO_KEY);return e||(e=new FirestoreProductDAO(t.app,t.productsCollection),setProductDAO(t,e)),e}function setProductDAO(t,e){t.setComponent(PRODUCT_DAO_KEY,e)}var __awaiter=globalThis&&globalThis.__awaiter||function(t,e,r,n){function o(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function i(l){try{g(n.next(l))}catch(c){s(c)}}function d(l){try{g(n.throw(l))}catch(c){s(c)}}function g(l){l.done?a(l.value):o(l.value).then(i,d)}g((n=n.apply(t,e||[])).next())})};function onCurrentUserSubscriptionUpdate(t,e,r){const n=getCurrentUserSync(t);return getOrInitSubscriptionDAO(t).onSubscriptionUpdate(n,e,r)}const SUBSCRIPTION_CONVERTER={toFirestore:()=>{throw new Error("Not implemented for readonly Subscription type.")},fromFirestore:t=>{var e,r,n;const o=t.data(),s=o.prices.map(i=>({product:i.parent.parent.id,price:i.id}));return{cancel_at:toNullableUTCDateString(o.cancel_at),cancel_at_period_end:o.cancel_at_period_end,canceled_at:toNullableUTCDateString(o.canceled_at),created:toUTCDateString(o.created),current_period_start:toUTCDateString(o.current_period_start),current_period_end:toUTCDateString(o.current_period_end),ended_at:toNullableUTCDateString(o.ended_at),id:t.id,metadata:(e=o.metadata)!==null&&e!==void 0?e:{},price:o.price.id,prices:s,product:o.product.id,quantity:(r=o.quantity)!==null&&r!==void 0?r:null,role:(n=o.role)!==null&&n!==void 0?n:null,status:o.status,stripe_link:o.stripeLink,trial_end:toNullableUTCDateString(o.trial_end),trial_start:toNullableUTCDateString(o.trial_start),uid:t.ref.parent.parent.id}}},SUBSCRIPTIONS_COLLECTION="subscriptions";function toNullableUTCDateString(t){return t===null?null:toUTCDateString(t)}function toUTCDateString(t){return t.toDate().toUTCString()}class FirestoreSubscriptionDAO{constructor(e,r){this.customersCollection=r,this.firestore=wh(e)}getSubscription(e,r){return __awaiter(this,void 0,void 0,function*(){return(yield this.getSubscriptionSnapshotIfExists(e,r)).data()})}getSubscriptions(e,r){return __awaiter(this,void 0,void 0,function*(){const n=yield this.getSubscriptionSnapshots(e,r==null?void 0:r.status),o=[];return n.forEach(a=>{o.push(a.data())}),o})}onSubscriptionUpdate(e,r,n){const o=sh(this.firestore,this.customersCollection,e,SUBSCRIPTIONS_COLLECTION).withConverter(SUBSCRIPTION_CONVERTER);return cf(o,a=>{const s={subscriptions:[],changes:[],size:a.size,empty:a.empty};a.forEach(i=>{s.subscriptions.push(i.data())}),a.docChanges().forEach(i=>{s.changes.push({type:i.type,subscription:i.doc.data()})}),r(s)},a=>{if(n){const s=new StripePaymentsError("internal",`Error while listening to database updates: ${a.message}`,a);n(s)}})}getSubscriptionSnapshotIfExists(e,r){return __awaiter(this,void 0,void 0,function*(){const n=rh(this.firestore,this.customersCollection,e,SUBSCRIPTIONS_COLLECTION,r).withConverter(SUBSCRIPTION_CONVERTER),o=yield this.queryFirestore(()=>Jl(n));if(!o.exists())throw new StripePaymentsError("not-found",`No subscription found with the ID: ${r} for user: ${e}`);return o})}getSubscriptionSnapshots(e,r){return __awaiter(this,void 0,void 0,function*(){let n=sh(this.firestore,this.customersCollection,e,SUBSCRIPTIONS_COLLECTION).withConverter(SUBSCRIPTION_CONVERTER);return r&&(n=dl(n,_l("status","in",r))),yield this.queryFirestore(()=>tf(n))})}queryFirestore(e){return __awaiter(this,void 0,void 0,function*(){try{return yield e()}catch(r){throw new StripePaymentsError("internal","Unexpected error while querying Firestore",r)}})}}const SUBSCRIPTION_DAO_KEY="subscription-dao";function getOrInitSubscriptionDAO(t){let e=t.getComponent(SUBSCRIPTION_DAO_KEY);return e||(e=new FirestoreSubscriptionDAO(t.app,t.customersCollection),setSubscriptionDAO(t,e)),e}function setSubscriptionDAO(t,e){t.setComponent(SUBSCRIPTION_DAO_KEY,e)}let stripe;const _sfc_main$3=defineComponent({name:"PreferencesComponent",setup(){return{store:useStore(),dark:ref(Plugin$1.isActive),promptFontSize:ref(!1),showText:ref(!0)}},mounted(){this.loadStripe()},methods:{async portalCB(){const t="https://billing.stripe.com/p/login/eVa6qm5sSahl7tudQQ";console.log(t),window.open(t,"_blank")},async subscribeCB(){const t=getApp$1(),e=getStripePayments(t,{productsCollection:"products",customersCollection:"customers"});console.log("payments",e);const r=await getProducts(e,{includePrices:!0,activeOnly:!0});for(const a of r)console.log("product",a);const o=await createCheckoutSession(e,{line_items:[{price:"price_1Mym16CCcfiyKH9aa6ZQZvQx",quantity:"1"}],api_key:"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",fooey:"kablooey",success_url:"https://www.readingedge.org/#/thankyou",cancel_url:"https://www.readingedge.org/#/"});console.log("session",o),console.log(o.url),onCurrentUserSubscriptionUpdate(e,a=>{for(const s in a.changes)s.type==="added"&&console.log(`New subscription added with ID: ${s.subscription.id}`)}),window.location.assign(o.url)},async loadStripe(){stripe=await loadStripe("pk_live_51Myi4CCCcfiyKH9aWeeCgtfqmR7HpOnLE9oDJn1lRbOSkfwxNsnLEfTRS8lHzdM8UNJ9O0IshKAThgnBdjcZosyC00oSLNm68T"),console.log("stripe",stripe)},toggleText(){console.log("toggleText",this.showText),this.showText===!0?(console.log("showing text"),selectAll(".assignment").classed("hidden",!1),selectAll(".q-carousel__thumbnail").classed("hidden",!1)):(console.log("hiding text"),selectAll(".assignment").classed("hidden",!0),selectAll(".q-carousel__thumbnail").classed("hidden",!0))},toggleDark(){Plugin$1.toggle(),console.log(Plugin$1.isActive,this.dark),Plugin$1.isActive},fontSizeCB(t){selectAll("#sampleFontSwatch").style("font-size",t+"pt"),selectAll("#slideTextDiv").style("font-size",t+"pt"),this.store.userSnapshot.preferences.pageFontSize=t},fsCB(){Plugin$2.isActive?Plugin$2.exit().then(()=>{}).catch(t=>{console.log(t)}):Plugin$2.request().then(()=>{}).catch(t=>{console.log(t)})}}}),_hoisted_1$3={key:0,class:"q-pa-md",style:{"max-width":"350px"}},_hoisted_2$3={class:"text-center q-mt-md",style:{width:"100%"}},_hoisted_3$2=createBaseVNode("br",null,null,-1),_hoisted_4$2={key:0},_hoisted_5$2=createBaseVNode("br",null,null,-1),_hoisted_6$2=createBaseVNode("span",{class:"text-yellow"},"Thank You!",-1),_hoisted_7$2=[_hoisted_5$2,_hoisted_6$2],_hoisted_8$2={class:"text-center q-mt-md",style:{width:"100%"}},_hoisted_9$2=createBaseVNode("br",null,null,-1),_hoisted_10$2={class:"full-width"},_hoisted_11$2=createBaseVNode("tr",{class:"bg-blue"},[createBaseVNode("th",{colSpan:"2"},"Default Account Quotas")],-1),_hoisted_12$1=createBaseVNode("tr",null,[createBaseVNode("td",null,"bookmark"),createBaseVNode("td",null,"30")],-1),_hoisted_13$1=createBaseVNode("tr",null,[createBaseVNode("td",null,"image"),createBaseVNode("td",null,"30")],-1),_hoisted_14=createBaseVNode("tr",null,[createBaseVNode("td",null,"page"),createBaseVNode("td",null,"30")],-1),_hoisted_15=createBaseVNode("tr",null,[createBaseVNode("td",null,"assignment"),createBaseVNode("td",null,"5")],-1),_hoisted_16=createBaseVNode("tr",null,[createBaseVNode("td",null,"course"),createBaseVNode("td",null,"3")],-1),_hoisted_17=createBaseVNode("tr",null,[createBaseVNode("td",null,"enrollment"),createBaseVNode("td",null,"3")],-1),_hoisted_18=createBaseVNode("tr",{class:"bg-primary"},[createBaseVNode("th",{colSpan:"2"},"$1 Storage Upgrade")],-1),_hoisted_19=createBaseVNode("tr",null,[createBaseVNode("td",null,"bookmark"),createBaseVNode("td",null,"100")],-1),_hoisted_20=createBaseVNode("tr",null,[createBaseVNode("td",null,"image"),createBaseVNode("td",null,"100")],-1),_hoisted_21=createBaseVNode("tr",null,[createBaseVNode("td",null,"page"),createBaseVNode("td",null,"50")],-1),_hoisted_22=createBaseVNode("tr",null,[createBaseVNode("td",null,"assignment"),createBaseVNode("td",null,"30")],-1),_hoisted_23=createBaseVNode("tr",null,[createBaseVNode("td",null,"course"),createBaseVNode("td",null,"10")],-1),_hoisted_24=createBaseVNode("tr",null,[createBaseVNode("td",null,"enrollment"),createBaseVNode("td",null,"30")],-1);function _sfc_render$3(t,e,r,n,o,a){return this.store.userSnapshot?(openBlock(),createElementBlock("div",_hoisted_1$3,[createVNode(QList,{bordered:"",class:"rounded-borders",icon:"gear"},{default:withCtx(()=>[createVNode(QExpansionItem,{label:"Storage Space"},{default:withCtx(()=>[createBaseVNode("div",_hoisted_2$3,[createTextVNode(toDisplayString(this.store.userSnapshot.profile.name)+" ",1),_hoisted_3$2,createTextVNode(" "+toDisplayString(this.store.userSnapshot.profile.email)+" ",1),this.store.subscribed?(openBlock(),createElementBlock("span",_hoisted_4$2,_hoisted_7$2)):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_8$2,[this.store.subscribed===1?(openBlock(),createBlock(QBtn,{key:0,"no-caps":"",class:"bg-primary",onClick:e[0]||(e[0]=s=>this.portalCB())},{default:withCtx(()=>[createTextVNode("Manage Upgrade")]),_:1})):(openBlock(),createBlock(QBtn,{key:1,"no-caps":"",class:"bg-primary",onClick:e[1]||(e[1]=s=>this.subscribeCB())},{default:withCtx(()=>[createTextVNode("Upgrade")]),_:1}))]),_hoisted_9$2,createBaseVNode("div",_hoisted_10$2,[createVNode(QMarkupTable,null,{default:withCtx(()=>[_hoisted_11$2,_hoisted_12$1,_hoisted_13$1,_hoisted_14,_hoisted_15,_hoisted_16,_hoisted_17,_hoisted_18,_hoisted_19,_hoisted_20,_hoisted_21,_hoisted_22,_hoisted_23,_hoisted_24]),_:1})])]),_:1})]),_:1})])):createCommentVNode("",!0)}var ProfileComponent=_export_sfc(_sfc_main$3,[["render",_sfc_render$3]]);const _sfc_main$2=defineComponent({name:"AboutComponent",setup(){return{}},mounted(){},methods:{}}),_hoisted_1$2={class:"q-pa-md",style:{"max-width":"350px"}},_hoisted_2$2={class:"q-mx-md q-mt-md"},_hoisted_3$1=createBaseVNode("div",{class:"text-center text-white"},[createTextVNode(" Try also"),createBaseVNode("br"),createBaseVNode("a",{class:"text-orange",target:"_blank",href:"https://ccosse.github.io/TuxMathScrabble-2015"},"TuxMathScrabble"),createBaseVNode("br"),createBaseVNode("a",{class:"text-blue",target:"_blank",href:"https://ccosse.github.io/colormyworld"},"ColorMyWorld")],-1),_hoisted_4$1={class:"text-center q-mt-md",style:{width:"100%"}},_hoisted_5$1=createBaseVNode("a",{class:"text-grey",target:"_blank",href:"https://github.com/ccosse/ccosse.github.io#readme"},"Credits",-1),_hoisted_6$1=createBaseVNode("br",null,null,-1),_hoisted_7$1=createBaseVNode("a",{class:"text-grey",target:"_blank",href:"https://readingedgeca.s3.us-west-1.amazonaws.com/static/pub/img/Terms+of+use.pdf"},"Terms of Service",-1),_hoisted_8$1=createBaseVNode("br",null,null,-1),_hoisted_9$1=createBaseVNode("a",{class:"text-grey",target:"_blank",href:"https://readingedgeca.s3.us-west-1.amazonaws.com/static/pub/img/Privacy+policy.pdf"},"Privacy Policy",-1),_hoisted_10$1=createBaseVNode("br",null,null,-1),_hoisted_11$1=createBaseVNode("div",{class:"full-width"},null,-1);function _sfc_render$2(t,e,r,n,o,a){const s=resolveComponent("center");return openBlock(),createElementBlock("div",_hoisted_1$2,[createVNode(QList,{bordered:"",class:"rounded-borders",icon:"gear"},{default:withCtx(()=>[createVNode(QExpansionItem,{label:"About"},{default:withCtx(()=>[createVNode(QCard,{class:"full-width"},{default:withCtx(()=>[createBaseVNode("div",_hoisted_2$2,[createVNode(QImg,{src:"https://www.asymptopia.com/static/www/img/asymptopia-logo.png"})]),_hoisted_3$1]),_:1}),createBaseVNode("div",_hoisted_4$1,[createVNode(s,null,{default:withCtx(()=>[_hoisted_5$1,_hoisted_6$1,_hoisted_7$1,_hoisted_8$1,_hoisted_9$1]),_:1})]),_hoisted_10$1,_hoisted_11$1]),_:1})]),_:1})])}var AboutComponent=_export_sfc(_sfc_main$2,[["render",_sfc_render$2]]);const _sfc_main$1=defineComponent({name:"LatestNews",setup(){return{}},mounted(){},methods:{}}),_hoisted_1$1={class:"q-pa-md",style:{"max-width":"350px"}},_hoisted_2$1={href:"https://discord.gg/XqhuTWY5Cg",target:"_blank",class:"text-white"};function _sfc_render$1(t,e,r,n,o,a){const s=resolveComponent("q-list-item");return openBlock(),createElementBlock("div",_hoisted_1$1,[createVNode(QList,{bordered:"",class:"rounded-borders",icon:"gear"},{default:withCtx(()=>[createVNode(QExpansionItem,{label:"Latest News"},{default:withCtx(()=>[createVNode(QCard,{class:"full-width"},{default:withCtx(()=>[createVNode(QList,{class:"full-width text-center"},{default:withCtx(()=>[createVNode(s,null,{default:withCtx(()=>[createBaseVNode("a",_hoisted_2$1,[createVNode(QBtn,{flat:"",bordered:"","no-caps":"",class:"q-ma-md",icon:"question_answer"},{default:withCtx(()=>[createTextVNode("\xA0\xA0 New Help Channel")]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])}var LatestNews=_export_sfc(_sfc_main$1,[["render",_sfc_render$1]]);const _sfc_main=defineComponent({name:"CoursesLayout",components:{CoursePager,WPComponent,PreferencesComponent,ProfileComponent,AssignmentPager,PagePager,AboutComponent,ImagePager,LatestNews},setup(){const t=ref(!1),e=ref(!1),r=ref(null),n=ref(null);return{store:useStore(),courseKey:ref(null),promptEnroll:ref(!1),scrollAreaRHS:r,scrollAreaLHS:n,leftDrawerOpen:t,toggleLeftDrawer(){t.value=!t.value},rightDrawerOpen:e,toggleRightDrawer(){e.value=!e.value}}},mounted(){Plugin$1.isActive,this.store.initSpeech()},methods:{goBack(){if(this.store.pgIdx!==null&&this.store.pgIdx>-1){this.store.pgIdx=null,this.store.imgIdx=null,this.store.router.replace("/courses/assignments");return}else if(this.store.aid!==null&&this.store.aid!==-1){this.store.aid=null,this.store.imgIdx=null,this.store.router.replace("/courses");return}else this.store.ck!==null&&(this.store.ck=null,this.store.aid=null,this.store.pgIdx=null,this.store.imgIdx=null);this.store.router.replace("/courses")},enrollCB(){const t=this.store.enroll(this.courseKey);console.log(t)},scrollTopRHS(){this.scrollAreaRHS.setScrollPosition("vertical",0)},scrollTopLHS(){this.scrollAreaLHS.setScrollPosition("vertical",0)}}}),_hoisted_1=createBaseVNode("div",{class:"text-h6"},"Enter a course-key",-1),_hoisted_2={key:0},_hoisted_3={key:1},_hoisted_4={key:2},_hoisted_5={key:3},_hoisted_6=createBaseVNode("br",null,null,-1),_hoisted_7={key:0},_hoisted_8={key:1},_hoisted_9=createBaseVNode("div",{class:"text-panel q-ma-md text-center text-h6"},"App Sections",-1),_hoisted_10={key:3},_hoisted_11={key:4},_hoisted_12={key:5},_hoisted_13={key:6};function _sfc_render(t,e,r,n,o,a){const s=resolveComponent("LatestNews"),i=resolveComponent("WPComponent"),d=resolveComponent("PreferencesComponent"),g=resolveComponent("ProfileComponent"),l=resolveComponent("AboutComponent"),c=resolveComponent("ImagePager"),p=resolveComponent("PagePager"),v=resolveComponent("AssignmentPager"),P=resolveComponent("CoursePager"),k=resolveComponent("router-view");return openBlock(),createElementBlock(Fragment,null,[createVNode(QDialog,{modelValue:t.promptEnroll,"onUpdate:modelValue":e[3]||(e[3]=S=>t.promptEnroll=S),persistent:""},{default:withCtx(()=>[createVNode(QCard,{style:{"min-width":"350px"}},{default:withCtx(()=>[createVNode(QCardSection,null,{default:withCtx(()=>[_hoisted_1]),_:1}),createVNode(QCardSection,{class:"q-pt-none"},{default:withCtx(()=>[createVNode(QInput,{dense:"",modelValue:t.courseKey,"onUpdate:modelValue":e[0]||(e[0]=S=>t.courseKey=S),autofocus:"",onKeyup:e[1]||(e[1]=withKeys(S=>{t.prompt=!1,this.enrollCB()},["enter"]))},null,8,["modelValue"])]),_:1}),createVNode(QCardActions,{align:"right",class:"text-white"},{default:withCtx(()=>[withDirectives(createVNode(QBtn,{flat:"",label:"Cancel"},null,512),[[ClosePopup]]),withDirectives(createVNode(QBtn,{flat:"",label:"Enroll",onClick:e[2]||(e[2]=S=>this.enrollCB())},null,512),[[ClosePopup]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),createVNode(QLayout,{view:"hHh lpR fFf"},{default:withCtx(()=>[createVNode(QHeader,{bordered:"",class:"bg-positive text-white"},{default:withCtx(()=>[createVNode(QToolbar,null,{default:withCtx(()=>[createVNode(QBtn,{flat:"",round:"",icon:"menu",onClick:t.toggleLeftDrawer},null,8,["onClick"]),createVNode(QBtn,{flat:"",round:"",icon:"home",onClick:e[4]||(e[4]=S=>this.store.goHome())}),createVNode(QSpace),this.store.ck!==null?(openBlock(),createBlock(QBtn,{key:0,flat:"",round:"",icon:"north",onClick:e[5]||(e[5]=S=>this.goBack())},{default:withCtx(()=>[createVNode(QTooltip,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:withCtx(()=>[createVNode(QCard,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:withCtx(()=>[createTextVNode(" Go back to "),this.store.ck!==null&&this.store.aid===null?(openBlock(),createElementBlock("span",_hoisted_2,"Home")):this.store.aid!==null&&this.store.pgIdx===null?(openBlock(),createElementBlock("span",_hoisted_3,"Courses")):this.store.pgIdx!==null?(openBlock(),createElementBlock("span",_hoisted_4,"Assignments")):(openBlock(),createElementBlock("span",_hoisted_5,"Pages"))]),_:1})]),_:1})]),_:1})):createCommentVNode("",!0),createVNode(QSpace),this.store.role==="student"?(openBlock(),createBlock(QBtn,{key:1,flat:"",round:"",class:"on-left",icon:"group_add",onClick:e[6]||(e[6]=S=>t.promptEnroll=!0)},{default:withCtx(()=>[createVNode(QTooltip,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:withCtx(()=>[createVNode(QCard,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:withCtx(()=>[createTextVNode(" Have a course-key? Enter it here"),_hoisted_6,createTextVNode("to join your course. ")]),_:1})]),_:1})]),_:1})):createCommentVNode("",!0),this.store.authenticated?(openBlock(),createBlock(QBtn,{key:2,flat:"",round:"",icon:"switch_account",onClick:e[7]||(e[7]=S=>this.store.switchRole())},{default:withCtx(()=>[createVNode(QTooltip,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:withCtx(()=>[createVNode(QCard,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:withCtx(()=>[createTextVNode(" Switch to "),this.store.role==="student"?(openBlock(),createElementBlock("span",_hoisted_7,"Teacher")):(openBlock(),createElementBlock("span",_hoisted_8,"Student")),createTextVNode(" role ")]),_:1})]),_:1})]),_:1})):createCommentVNode("",!0),createVNode(QBtn,{flat:"",round:"",icon:"logout",onClick:e[8]||(e[8]=S=>this.store.logout())},{default:withCtx(()=>[createVNode(QTooltip,{style:{backgroundColor:"#222",fontSize:"12pt"}},{default:withCtx(()=>[createVNode(QCard,{bordered:"",flat:"",class:"q-ma-xs q-pa-sm"},{default:withCtx(()=>[createTextVNode(" Logout ")]),_:1})]),_:1})]),_:1}),createVNode(QBtn,{flat:"",round:"",icon:"menu",onClick:t.toggleRightDrawer},null,8,["onClick"])]),_:1})]),_:1}),createVNode(QDrawer,{"show-if-above":"",modelValue:t.leftDrawerOpen,"onUpdate:modelValue":e[10]||(e[10]=S=>t.leftDrawerOpen=S),side:"left",bordered:"",class:""},{default:withCtx(()=>[createVNode(QScrollArea,{visible:t.visible,style:{height:"90vh","max-width":"350px"},ref:"scrollAreaLHS"},{default:withCtx(()=>[_hoisted_9,createVNode(s),createVNode(i),createVNode(d),createVNode(g),createVNode(l)]),_:1},8,["visible"]),createVNode(QPageSticky,{position:"bottom-left",offset:[-285,0]},{default:withCtx(()=>[createVNode(QBtn,{fab:"",icon:"north",color:"grey",onClick:e[9]||(e[9]=S=>this.scrollTopLHS())})]),_:1})]),_:1},8,["modelValue"]),createVNode(QDrawer,{"show-if-above":"",modelValue:t.rightDrawerOpen,"onUpdate:modelValue":e[16]||(e[16]=S=>t.rightDrawerOpen=S),side:"right",bordered:""},{default:withCtx(()=>[createVNode(QScrollArea,{visible:t.visible,style:{height:"90vh","max-width":"350px"},ref:"scrollAreaRHS"},{default:withCtx(()=>[createBaseVNode("div",{id:"myCoursesB",class:"text-panel q-ma-md text-center text-h6 cursor-pointer",onClick:e[11]||(e[11]=S=>{this.store.ck=null,this.store.aid=null,this.store.pgIdx=null,this.store.imgIdx=null,this.store.router.push("/courses")})}," My Courses: "+toDisplayString(Object.keys(this.store.courses).length),1),this.store.ck?(openBlock(),createElementBlock("div",{key:0,id:"courseB",class:"text-panel q-ma-md text-center text-h6 cursor-pointer",onClick:e[12]||(e[12]=S=>{this.store.aid=null,this.store.pgIdx=null,this.store.imgIdx=null,this.store.router.push("/courses")})}," Course: "+toDisplayString(this.store.currentCourse.title),1)):createCommentVNode("",!0),this.store.ck&&this.store.aid?(openBlock(),createElementBlock("div",{key:1,id:"assignmentB",class:"text-panel q-ma-md text-center text-h6 cursor-pointer",onClick:e[13]||(e[13]=S=>{this.store.pgIdx=null,this.store.imgIdx=null,this.store.router.push("/courses/assignments")})}," Assignment: "+toDisplayString(this.store.currentAssignment.title),1)):createCommentVNode("",!0),this.store.ck&&this.store.aid&&this.store.pgIdx!==null?(openBlock(),createElementBlock("div",{key:2,id:"pageB",class:"text-panel q-ma-md text-center text-h6 cursor-pointer",onClick:e[14]||(e[14]=S=>this.store.router.push("/courses/assignments/pages"))}," Page: "+toDisplayString(this.store.pgIdx+1)+"/"+toDisplayString(this.store.currentAssignment.pages.length),1)):createCommentVNode("",!0),this.store.pgIdx!==null?(openBlock(),createElementBlock("span",_hoisted_10,[createVNode(c)])):this.store.ck&&this.store.aid?(openBlock(),createElementBlock("span",_hoisted_11,[createVNode(p)])):this.store.currentCourse?(openBlock(),createElementBlock("span",_hoisted_12,[createVNode(v)])):(openBlock(),createElementBlock("span",_hoisted_13,[createVNode(P)]))]),_:1},8,["visible"]),createVNode(QPageSticky,{position:"bottom-right",offset:[-285,0]},{default:withCtx(()=>[createVNode(QBtn,{fab:"",icon:"north",color:"grey",onClick:e[15]||(e[15]=S=>this.scrollTopRHS())})]),_:1})]),_:1},8,["modelValue"]),createVNode(QPageContainer,null,{default:withCtx(()=>[createVNode(k)]),_:1})]),_:1})],64)}var CoursesLayout=_export_sfc(_sfc_main,[["render",_sfc_render]]);export{CoursesLayout as default};
