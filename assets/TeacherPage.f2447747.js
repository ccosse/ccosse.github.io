import{_ as $,r as p,o as u,f as B,w as s,g as t,ao as z,O as k,Q as c,aN as I,k as r,j as d,as as N,an as m,aq as b,ap as x,ar as g,i as w,aO as V}from"./index.7cead89f.js";import{Q as C}from"./use-form.86fbc6da.js";import{a as O,r as U,d as Q,Q as D,C as K}from"./ClosePopup.3915612d.js";import{Q as _}from"./QCard.c0be6d83.js";import{Q as P}from"./QInput.840bcd16.js";import{Q as f}from"./QTooltip.6ea2682b.js";import{b as E,Q as F,a as q}from"./QList.d220eef7.js";import{Q as G}from"./QImg.a402e192.js";import{Q as W}from"./QPage.6e20589c.js";import{u as J}from"./re-store.125b4fe7.js";import"./use-prevent-scroll.bd856c19.js";import"./scroll.4a3124d8.js";import"./use-dark.6e778484.js";import"./use-key-composition.3322c442.js";import"./firebase.0eb8f378.js";import"./transform.aea72fbe.js";import"./index.2cf0d985.js";function j(o){const e=document.createElement("textarea");e.value=o,e.contentEditable="true",e.style.position="fixed";const S=()=>{};O(S),document.body.appendChild(e),e.focus(),e.select();const i=document.execCommand("copy");return e.remove(),U(S),i}function L(o){return navigator.clipboard!==void 0?navigator.clipboard.writeText(o):new Promise((e,S)=>{const i=j(o);i?e(!0):S(i)})}const H=J(),M={components:{},setup(){return{reStore:H,mval:p(!0),label:p("howdy"),courseKey:p(null),courseTitle:p(null),prompt:p(!1),confirm:p(!1),promptAwesome:p(!1),targetCK:p(null),targetAID:p(null),autoAwesomeGuideWords:p("")}},mounted(){console.log("TeacherPage mounted ",this.reStore.courses),this.reStore.unloadCurrent()},methods:{selectAssignment(o,e){this.reStore.courses.ck===o&&this.reStore.courses.aid===e?this.reStore.unloadCurrent():(this.reStore.courses.ck=o,this.reStore.courses.aid=e,this.reStore.courses.trigger+=1)},autoAwesomeCB(o){console.log("autoAwesomeCB ",this.autoAwesomeGuideWords);const e=this.autoAwesomeGuideWords.split(","),i=100/e.length;let T=parseInt(i/6);T<1&&(T=1);const y=JSON.parse(JSON.stringify(this.reStore.assignmentTemplate));y.ck=this.targetCK,y.id=(Math.random()*1e9).toString().replace(".",""),e.forEach(async n=>{const a=this.reStore.langVoices[this.reStore.preferences.langVoiceKey];console.log("doSearch ",a,this.searchTerms),this.reStore.wiki.setLang(a.langName);const A=await this.reStore.wiki.search(n,{suggestion:!1,limit:T});console.log("res.results.length: ",A.results.length),console.log(A.results),A.results.forEach(l=>{console.log(l.pageid);const h=JSON.parse(JSON.stringify(this.reStore.pageTemplate));h.pageid=l.pageid,h.pageTitle=l.title,h.langVoiceKey=this.reStore.preferences.langVoiceKey,y.pages.push(h)})}),this.reStore.courses[this.targetCK].assignments[y.id]=y,this.reStore.courses.trigger+=1},copyCK(o){L(o).then(()=>{console.log("ck copied to clipboard",o)}).catch(e=>{console.log(e)})},newCourseCB(){console.log("courseCB"),this.reStore.newCourse()},newAssignmentCB(o){console.log("assignmentCB: ",o),this.reStore.newAssignment(o)},editAssignmentCB(o,e){console.log("editAssignmentCB: ",o,e),this.reStore.loadAssignment(o,e),this.reStore.mode="editor",this.reStore.router.push("/teacher/editor")},changeTitleCB(){console.log("TeacherPage.titleCB",this.courseKey,this.courseTitle),this.reStore.setCourseTitle(this.courseKey,this.courseTitle)},deleteCourseCB(o){this.targetCK=o,this.targetAID=null,this.confirm=!0},deleteAssignmentCB(o,e){this.targetCK=o,this.targetAID=e,this.confirm=!0},deleteForSure(){this.confirm=!1,console.log("delete current targets ",this.targetCK,this.targetAID),this.targetAID&&this.targetCK?this.reStore.deleteAssignment(this.targetCK,this.targetAID):this.targetCK&&this.targetAID===null&&this.reStore.deleteCourse(this.targetCK),this.targetCK=null,this.targetAID=null},takeAssignmentCB(o,e){console.log("TeacherPage.takeAssignment ",o,e),this.reStore.loadAssignment(o,e),this.reStore.mode="assignment",this.reStore.router.push("/teacher/assignment")},shareToDemo(o,e){console.log(o,e),this.reStore.shareToDemo(o,e)}}},R=r("span",{class:"q-ml-sm"},"Confirm delete object?",-1),X=r("div",{class:"text-h6"},"Change course title",-1),Y=r("div",{class:"text-h6"},"Provide guide-words, percent-replace and points-goal",-1),Z={class:"q-pa-md"},ee={class:"flex flex-center"},te={class:"q-pa-md"},se=r("br",null,null,-1),oe=r("br",null,null,-1),le=r("br",null,null,-1),re={class:"flex flex-row justify-center"},ne={class:"absolute-top text-center"},ie={class:"text-h6"},ae={class:"text-subtitle2"},ue={key:0},de={key:1},ce={style:{"font-size":"22pt",width:"100%"},class:"text-center absolute-bottom"},me=r("br",null,null,-1),he={class:"hidden"},pe={width:"100%"},ge=r("tr",null,[r("th",{colSpan:"100"},"Course Score Sheet")],-1),fe=r("th",null,"Student",-1),Ce={style:{"text-align":"center"}},_e={key:0},Se={key:1};function ye(o,e,S,i,T,y){return u(),B(W,{class:"q-gutter-md"},{default:s(()=>[t(D,{modelValue:i.confirm,"onUpdate:modelValue":e[1]||(e[1]=n=>i.confirm=n),persistent:"",class:"z-max"},{default:s(()=>[t(_,null,{default:s(()=>[t(C,{class:"row items-center"},{default:s(()=>[t(z,{icon:"delete",color:"primary","text-color":"white"}),R]),_:1}),t(Q,{align:"right",class:"text-white"},{default:s(()=>[k(t(c,{flat:"",label:"Cancel"},null,512),[[K]]),t(c,{flat:"",label:"Delete",onClick:e[0]||(e[0]=n=>this.deleteForSure())})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(D,{modelValue:i.prompt,"onUpdate:modelValue":e[5]||(e[5]=n=>i.prompt=n),persistent:"",class:"z-max"},{default:s(()=>[t(_,{style:{"min-width":"350px"}},{default:s(()=>[t(C,null,{default:s(()=>[X]),_:1}),t(C,{class:"q-pt-none"},{default:s(()=>[t(P,{dense:"",modelValue:i.courseTitle,"onUpdate:modelValue":e[2]||(e[2]=n=>i.courseTitle=n),autofocus:"",onKeyup:e[3]||(e[3]=I(n=>{i.prompt=!1,this.changeTitleCB()},["enter"])),onHide:this.dck},null,8,["modelValue","onHide"])]),_:1}),t(Q,{align:"right",class:"text-white"},{default:s(()=>[k(t(c,{outline:"",label:"Cancel"},null,512),[[K]]),k(t(c,{outline:"",label:"Save",onClick:e[4]||(e[4]=n=>this.changeTitleCB())},null,512),[[K]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(D,{modelValue:i.promptAwesome,"onUpdate:modelValue":e[9]||(e[9]=n=>i.promptAwesome=n),persistent:"",class:"z-max"},{default:s(()=>[t(_,{style:{"min-width":"350px"}},{default:s(()=>[t(C,null,{default:s(()=>[Y]),_:1}),t(C,{class:"q-pt-none"},{default:s(()=>[t(P,{dense:"",modelValue:i.autoAwesomeGuideWords,"onUpdate:modelValue":e[6]||(e[6]=n=>i.autoAwesomeGuideWords=n),autofocus:"",onKeyup:e[7]||(e[7]=I(n=>{i.promptAwesome=!1,this.autoAwesomeCB()},["enter"]))},null,8,["modelValue"])]),_:1}),t(Q,{align:"right",class:"text-white"},{default:s(()=>[k(t(c,{outline:"",label:"Cancel"},null,512),[[K]]),k(t(c,{outline:"",label:"Save",onClick:e[8]||(e[8]=n=>this.autoAwesomeCB())},null,512),[[K]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),r("div",Z,[t(E,{bordered:"",class:"rounded-borders"},{default:s(()=>[t(_,{flat:""},{default:s(()=>[r("div",ee,[r("div",null,[t(c,{class:"on-left",icon:"list_alt",onClick:e[10]||(e[10]=n=>this.newCourseCB())},{default:s(()=>[t(f,null,{default:s(()=>[d("Create a new course")]),_:1})]),_:1}),t(c,{flat:"","no-caps":"",style:{fontSize:"18pt"}},{default:s(()=>[d("Teacher Dashboard")]),_:1}),this.reStore.authenticated?(u(),B(c,{key:0,class:"on-right",onClick:e[11]||(e[11]=n=>this.reStore.router.push("/student")),icon:"switch_account"},{default:s(()=>[t(f,null,{default:s(()=>[d(" Switch to Student-role ")]),_:1})]),_:1})):N("",!0)])])]),_:1})]),_:1})]),(u(!0),m(x,null,b(this.reStore.userSnapshot.teaching,(n,a,A)=>(u(),B(_,{flat:"",key:A,style:{opacity:"1.0"}},{default:s(()=>[r("div",te,[t(E,{bordered:"",class:"rounded-borders"},{default:s(()=>[t(F,null,{header:s(()=>[t(q),t(q,null,{default:s(()=>[d(" Course: "+g(this.reStore.courses[n.ck].title),1)]),_:2},1024)]),default:s(()=>[t(_,{flat:""},{default:s(()=>[t(C,{class:"text-center",style:{fontSize:"12pt"}},{default:s(()=>[d(" Title: "+g(this.reStore.courses[a].title)+" \xA0",1),t(w,{class:"ptr",name:"edit",onClick:l=>{i.prompt=!0,this.courseTitle=this.reStore.courses[a].title,this.courseKey=a}},null,8,["onClick"]),se,d(" Key: "+g(a)+" ",1),t(w,{class:"ptr",name:"content_copy",onClick:l=>this.copyCK(a)},null,8,["onClick"]),r("div",null,[t(c,{icon:"delete",onClick:l=>this.deleteCourseCB(n.ck)},{default:s(()=>[t(f,null,{default:s(()=>[d("Delete Course")]),_:1})]),_:2},1032,["onClick"]),t(c,{icon:"post_add",onClick:l=>this.newAssignmentCB(n.ck)},{default:s(()=>[t(f,null,{default:s(()=>[d("New Assignment")]),_:1})]),_:2},1032,["onClick"]),t(c,{icon:"auto_awesome",onClick:l=>{this.targetCK=a,i.promptAwesome=!0}},{default:s(()=>[t(f,null,{default:s(()=>[d("1-Step Custom Assignment Create")]),_:1})]),_:2},1032,["onClick"]),t(c,{icon:"content_copy",onClick:l=>this.copyCK(a)},{default:s(()=>[t(f,null,{default:s(()=>[d("Copy this course-key to clipboard. Enroll "),oe,d("in this course using this course-key from "),le,d("the Student Page.")]),_:1})]),_:2},1032,["onClick"])])]),_:2},1024),r("div",re,[(u(!0),m(x,null,b(this.reStore.courses[a].assignments,(l,h)=>(u(),m("div",{key:l},[t(_,{bordered:"",flat:"",class:"ccard q-mx-sm q-my-md"},{default:s(()=>[t(G,{fit:o.cover,src:l.coverUrl,height:"100%",onClick:v=>this.selectAssignment(a,l.id)},{default:s(()=>[r("div",ne,[r("div",ie,g(l.title.slice(0,18)),1),r("div",ae,[l.pages?(u(),m("span",ue,"Pages: "+g(l.pages.length),1)):(u(),m("span",de,"Pages: None"))])]),r("div",ce,[t(w,{onClick:[v=>this.takeAssignmentCB(a,l.id),e[12]||(e[12]=V(()=>{},["stop","prevent"]))],name:"play_circle",class:"ptr"},{default:s(()=>[t(f,null,{default:s(()=>[d("Take Assignment")]),_:1})]),_:2},1032,["onClick"]),t(w,{onClick:[v=>this.editAssignmentCB(a,l.id),e[13]||(e[13]=V(()=>{},["stop","prevent"]))],name:"edit",class:"ptr on-right"},{default:s(()=>[t(f,null,{default:s(()=>[d("Edit Assignment"),me,d(g(l.id),1)]),_:2},1024)]),_:2},1032,["onClick"]),t(w,{onClick:[v=>this.deleteAssignmentCB(a,l.id),e[14]||(e[14]=V(()=>{},["stop","prevent"]))],name:"delete",class:"ptr on-right"},{default:s(()=>[t(f,null,{default:s(()=>[d("Delete Assignment")]),_:1})]),_:2},1032,["onClick"]),a!==this.reStore.demoCK&&this.reStore.userSnapshot.profile.email==="charlie@readingedge.org"?(u(),B(w,{key:0,onClick:[v=>this.shareToDemo(a,l.id),e[15]||(e[15]=V(()=>{},["stop","prevent"]))],name:"share",class:"ptr on-right"},{default:s(()=>[t(f,null,{default:s(()=>[d("Share Assignment")]),_:1})]),_:2},1032,["onClick"])):N("",!0)])]),_:2},1032,["fit","src","onClick"])]),_:2},1024),r("span",he,g(h),1)]))),128))]),t(C,null,{default:s(()=>[r("table",pe,[ge,r("tr",null,[fe,(u(!0),m(x,null,b(this.reStore.courses[a].assignments,(l,h)=>(u(),m("th",{key:h},[r("span",null,g(l.title),1)]))),128))]),(u(!0),m(x,null,b(this.reStore.courses[a].enrollment,l=>(u(),m("tr",{key:l.name},[r("td",Ce,g(l.name),1),(u(!0),m(x,null,b(this.reStore.courses[a].assignments,(h,v)=>(u(),m("td",{style:{"text-align":"center"},key:v},[h.scores&&h.scores[l.emailKey]?(u(),m("span",_e,g(h.scores[l.emailKey]),1)):(u(),m("span",Se," -- "))]))),128))]))),128))])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)])]),_:2},1024))),128))]),_:1})}var $e=$(M,[["render",ye]]);export{$e as default};
