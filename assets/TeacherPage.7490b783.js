import{_ as L,r as p,o as c,f as T,w as l,g as t,ao as F,J as k,Q as f,aO as I,k as i,j as h,aq as W,an as g,as as A,ar as b,ap as S,at as D,i as E}from"./index.89842271.js";import{a as y,Q as $}from"./QCardSection.7a8e8198.js";import{a as j,r as z,d as V,Q,C as B}from"./ClosePopup.8f1204f3.js";import{Q as v}from"./QCard.42ec64f3.js";import{Q as P}from"./QInput.eb11786c.js";import{Q as R}from"./QBanner.3d72183c.js";import{Q as C}from"./QTooltip.59ddce99.js";import{Q as U}from"./QBtnGroup.235877a2.js";import{Q as N,a as G}from"./QExpansionItem.e30fa5be.js";import{Q as J}from"./QList.771e5069.js";import{Q as M}from"./QPage.7d47aa6a.js";import{u as H}from"./re-store.dee276a0.js";import"./use-prevent-scroll.86379370.js";import"./uid.4f7d2bc7.js";import"./use-dark.1ee1890c.js";import"./use-key-composition.f856fd0d.js";import"./use-form.24c9bae0.js";import"./firebase.79bf92f9.js";import"./transform.aea72fbe.js";import"./index.2cf0d985.js";function X(s){const e=document.createElement("textarea");e.value=s,e.contentEditable="true",e.style.position="fixed";const _=()=>{};j(_),document.body.appendChild(e),e.focus(),e.select();const r=document.execCommand("copy");return e.remove(),z(_),r}function Y(s){return navigator.clipboard!==void 0?navigator.clipboard.writeText(s):new Promise((e,_)=>{const r=X(s);r?e(!0):_(r)})}const Z=H(),ee={components:{},setup(){return{reStore:Z,mval:p(!0),label:p("howdy"),courseKey:p(null),courseTitle:p(null),prompt:p(!1),confirm:p(!1),promptAwesome:p(!1),targetCK:p(null),targetAID:p(null),autoAwesomeGuideWords:p(""),defaultExpanded:p(!0)}},mounted(){console.log("TeacherPage mounted ",this.reStore.courses),this.reStore.unloadCurrent()},methods:{loadCourse(s){console.log("loadCourse ",s),this.reStore.loadCourse(s)},editCourseCB(s){this.loadCourse(s),this.reStore.router.push("/teacher/courseeditor")},selectAssignment(s,e){this.reStore.courses.ck===s&&this.reStore.courses.aid===e?this.reStore.unloadCurrent():(this.reStore.courses.ck=s,this.reStore.courses.aid=e,this.reStore.courses.trigger+=1)},autoAwesomeCB(s){console.log("autoAwesomeCB ",this.autoAwesomeGuideWords),this.reStore.autoAwesomeCB(s,this.autoAwesomeGuideWords)},unused(s){const e=this.autoAwesomeGuideWords.split(","),_=200,r=_/e.length;let K=parseInt(r/6);K<1&&(K=1);const m=JSON.parse(JSON.stringify(this.reStore.assignmentTemplate));m.ck=this.targetCK,m.id=this.reStore.mkId(),m.pgIdx=0,m.coverUrl=null,m.title=e[0],m.goal=_,e.forEach(async n=>{const u=this.reStore.langVoices[this.reStore.preferences.langVoiceKey];console.log("doSearch ",u,this.searchTerms),this.reStore.wiki.setLang(u.langName);const w=await this.reStore.wiki.search(n,{suggestion:!1,limit:K});console.log("res.results.length: ",w.results.length),console.log(w.results),w.results.forEach(async a=>{console.log(a.pageid),await this.reStore.getPage2(null,a.pageid,this.reStore.preferences.langVoiceKey).then(async d=>{console.log("getPage returned rval ",d),d.pageTitle=a.title;const x=await this.reStore.wiki.page(a.pageid);d.canonicalUrl=x.canonicalurl;const O=await x.summary();if(O.type!=="disambiguation"){if(await x.coordinates().then(o=>{console.log("resolved coords ",o),o!==null?d.mapCoords=`${o.lat}, ${o.lon}`:d.mapCoords="-999, -999"}),await x.images({limit:this.reStore.preferences.imgLimit}).then(o=>{for(const q in o)console.log(q),o[0].title.indexOf(".svg")>1?console.log("SVG ",o[0].title):o[0].title.indexOf("airytale")>0?console.log("Fairytale warning ",o[0].title):o[0].title.indexOf("kguitar")>1?console.log("kguitar ",o[0].title):o[0].title.indexOf("Blank.png")>-1?console.log("Blank.png ",o[0].title):o[0].title.indexOf(".oga")>1?console.log("OGA ",o[0].title):o[0].title.indexOf(".webm")>1?console.log("WEBM ",o[0].title):o[0].title.indexOf(".ogg")>1?console.log("OGG ",o[0].title):o[0].title.indexOf(".tif")>1?console.log("TIF ",o[0].title):o[0].title.indexOf(".mid")>1?console.log("MID ",o[0].title):o[0].title.indexOf(".ogv")>1?console.log("OGV ",o[0].title):o[0].title.indexOf("Icon")>1?console.log("ICON ",o[0].title):o[0].title.indexOf("icon")>1?console.log("icon ",o[0].title):o[0].title.indexOf("podagraria1")>0?console.log("podagraria1 ",o[0].title):o[0].title.indexOf("Bluetank")>1||o[0].title.indexOf("rab Nebula.jpg")>0?console.log("BLUETANK ",o[0].title):o[0].title.indexOf("viacionavion")>1||o[0].title.indexOf("input-microphone")>1?console.log("viacionavion",o[0].title):o[0].title.indexOf("clouds in fair weather")>0||o[0].title.indexOf("in pacifica 1")>0?console.log("clouds in fair weather",o[0].title):d.imgs.push({url:o[0].url,cap:o[0].title}),o.push(o.shift());d.imgs.length>1&&d.imgs.shift()}),d.pageText=O.extract,d.currentLangLinks=[],d.imgIdx=0,!m.coverUrl)try{m.coverUrl=m.pages[0].imgs[0].url}catch(o){console.log("ERROR setting coverUrl ",o)}m.pages.push(d),console.log("a.pages.length ",m.pages.length)}else console.log("SKIPPED ",O.type)})})}),this.reStore.courses[this.targetCK].assignments[m.id]=m,this.reStore.courses.trigger+=1},copyCK(s){Y(s).then(()=>{console.log("ck copied to clipboard",s)}).catch(e=>{console.log(e)})},newCourseCB(){console.log("courseCB"),this.reStore.newCourse()},newAssignmentCB(s){console.log("assignmentCB: ",s),this.reStore.newAssignment(s)},editAssignmentCB(s,e){console.log("editAssignmentCB: ",s,e),this.reStore.loadAssignment(s,e),this.reStore.mode="editor",this.reStore.router.push("/teacher/editor")},changeTitleCB(){console.log("TeacherPage.titleCB",this.courseKey,this.courseTitle),this.reStore.setCourseTitle(this.courseKey,this.courseTitle)},deleteCourseCB(s){this.targetCK=s,this.targetAID=null,this.confirm=!0},deleteAssignmentCB(s,e){this.targetCK=s,this.targetAID=e,this.confirm=!0},deleteForSure(){this.confirm=!1,console.log("delete current targets ",this.targetCK,this.targetAID),this.targetAID&&this.targetCK?this.reStore.deleteAssignment(this.targetCK,this.targetAID):this.targetCK&&this.targetAID===null&&this.reStore.deleteCourse(this.targetCK),this.targetCK=null,this.targetAID=null},takeAssignmentCB(s,e){console.log("TeacherPage.takeAssignment ",s,e),this.reStore.loadAssignment(s,e),this.reStore.mode="assignment",this.reStore.router.push("/teacher/assignment")},shareToDemo(s,e){console.log(s,e),this.reStore.shareToDemo(s,e)}}},te=i("span",{class:"q-ml-sm"},"Confirm delete object?",-1),oe=i("div",{class:"text-h6"},"Change course title",-1),le=i("div",{class:"text-h6"},"Provide guide-words",-1),se={class:"q-pa-md"},ne=i("div",{class:"text-weight-bolder text-center text-h4 q-pa-md"}," Teacher ",-1),ie={class:"q-ma-sm"},re={class:"flex flex-row justify-center"},ae={class:"absolute-top text-center",style:{"background-color":"#2228",height:"100%"}},ue={class:"atit"},de={key:0},ce={key:1},he=i("br",null,null,-1),fe=i("br",null,null,-1),me={class:"q-pa-md"},ge=i("br",null,null,-1),pe=i("br",null,null,-1),Ce=i("br",null,null,-1),_e={width:"100%"},Se=i("tr",null,[i("th",{colSpan:"100"},"Course Score Sheet")],-1),ye=i("th",null,"Student",-1),we={style:{"text-align":"center"}},ve={key:0},xe={key:1};function ke(s,e,_,r,K,m){return c(),T(M,{class:"q-gutter-md bg-primary"},{default:l(()=>[t(Q,{modelValue:r.confirm,"onUpdate:modelValue":e[1]||(e[1]=n=>r.confirm=n),persistent:"",class:"z-max"},{default:l(()=>[t(v,null,{default:l(()=>[t(y,{class:"row items-center"},{default:l(()=>[t(F,{icon:"delete",color:"primary","text-color":"white"}),te]),_:1}),t(V,{align:"right",class:"text-white"},{default:l(()=>[k(t(f,{flat:"",label:"Cancel"},null,512),[[B]]),t(f,{flat:"",label:"Delete",onClick:e[0]||(e[0]=n=>this.deleteForSure())})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Q,{modelValue:r.prompt,"onUpdate:modelValue":e[5]||(e[5]=n=>r.prompt=n),persistent:"",class:"z-max"},{default:l(()=>[t(v,{style:{"min-width":"350px"}},{default:l(()=>[t(y,null,{default:l(()=>[oe]),_:1}),t(y,{class:"q-pt-none"},{default:l(()=>[t(P,{dense:"",modelValue:r.courseTitle,"onUpdate:modelValue":e[2]||(e[2]=n=>r.courseTitle=n),autofocus:"",onKeyup:e[3]||(e[3]=I(n=>{r.prompt=!1,this.changeTitleCB()},["enter"])),onHide:this.dck},null,8,["modelValue","onHide"])]),_:1}),t(V,{align:"right",class:"text-white"},{default:l(()=>[k(t(f,{outline:"",label:"Cancel"},null,512),[[B]]),k(t(f,{outline:"",label:"Save",onClick:e[4]||(e[4]=n=>this.changeTitleCB())},null,512),[[B]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(Q,{modelValue:r.promptAwesome,"onUpdate:modelValue":e[9]||(e[9]=n=>r.promptAwesome=n),persistent:"",class:"z-max"},{default:l(()=>[t(v,{style:{"min-width":"350px"}},{default:l(()=>[t(y,null,{default:l(()=>[le]),_:1}),t(y,{class:"q-pt-none"},{default:l(()=>[t(P,{dense:"",modelValue:r.autoAwesomeGuideWords,"onUpdate:modelValue":e[6]||(e[6]=n=>r.autoAwesomeGuideWords=n),autofocus:"",onKeyup:e[7]||(e[7]=I(n=>{r.promptAwesome=!1,this.autoAwesomeCB()},["enter"]))},null,8,["modelValue"])]),_:1}),t(V,{align:"right",class:"text-white"},{default:l(()=>[k(t(f,{outline:"",label:"Cancel"},null,512),[[B]]),k(t(f,{outline:"",label:"Save",onClick:e[8]||(e[8]=n=>this.autoAwesomeCB())},null,512),[[B]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),i("div",se,[t(N,{class:"bg-positive",modelValue:r.defaultExpanded,"onUpdate:modelValue":e[12]||(e[12]=n=>r.defaultExpanded=n)},{header:l(()=>[t(R,{class:"bg-positive text-white",style:{width:"100%"}},{default:l(()=>[ne]),_:1})]),default:l(()=>[t(v,{flat:""},{default:l(()=>[t(y,{class:"text-center",style:{fontSize:"12pt"}},{default:l(()=>[i("div",ie,[t(U,null,{default:l(()=>[t(f,{class:"on-left",icon:"post_add",onClick:e[10]||(e[10]=n=>this.newCourseCB())},{default:l(()=>[t(C,null,{default:l(()=>[h("Create a new course")]),_:1})]),_:1}),this.reStore.authenticated?(c(),T(f,{key:0,class:"on-right",onClick:e[11]||(e[11]=n=>this.reStore.router.push("/student")),icon:"switch_account"},{default:l(()=>[t(C,null,{default:l(()=>[h(" Switch to Student-role ")]),_:1})]),_:1})):W("",!0)]),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),i("div",re,[(c(!0),g(b,null,A(this.reStore.userSnapshot.teaching,(n,u,w)=>(c(),T(v,{bordered:"",flat:"",class:"ccard q-mx-sm q-my-md",key:w},{default:l(()=>[t($,{fit:s.cover,src:this.reStore.logoURL,height:"100%",onClick:a=>this.loadCourse(u)},{default:l(()=>[i("div",ae,[i("div",ue,S(this.reStore.courses[u].title.slice(0,20)),1),i("div",null,[this.reStore.courses[u].assignments?(c(),g("span",de,"Assignments: "+S(Object.keys(this.reStore.courses[u].assignments).length),1)):(c(),g("span",ce,"Assignments: None"))])]),t(U,{dense:"",class:"absolute-bottom justify-center",style:{"background-color":"#0000"}},{default:l(()=>[t(f,{icon:"delete",onClick:[e[13]||(e[13]=D(()=>{},["stop","prevent"])),a=>this.deleteCourseCB(n.ck)]},{default:l(()=>[t(C,null,{default:l(()=>[h("Delete Course")]),_:1})]),_:2},1032,["onClick"]),t(f,{icon:"content_copy",onClick:[e[14]||(e[14]=D(()=>{},["stop","prevent"])),a=>this.copyCK(n.ck)]},{default:l(()=>[t(C,null,{default:l(()=>[h("Copy this course-key to clipboard. Enroll "),he,h("in this course using this course-key from "),fe,h("the Student Page.")]),_:1})]),_:2},1032,["onClick"]),t(f,{icon:"edit",onClick:a=>this.editCourseCB(n.ck)},{default:l(()=>[t(C,null,{default:l(()=>[h("Edit Course")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["fit","src","onClick"])]),_:2},1024))),128))]),(c(!0),g(b,null,A(this.reStore.userSnapshot.teaching,(n,u,w)=>(c(),T(v,{class:"hidden",flat:"",key:w,style:{opacity:"1.0"}},{default:l(()=>[i("div",me,[t(J,{bordered:"",class:"rounded-borders"},{default:l(()=>[t(N,null,{header:l(()=>[t(G),t(G,null,{default:l(()=>[h(" Course: "+S(this.reStore.courses[n.ck].title),1)]),_:2},1024)]),default:l(()=>[t(v,{flat:""},{default:l(()=>[t(y,{class:"text-center",style:{fontSize:"12pt"}},{default:l(()=>[h(" Title: "+S(this.reStore.courses[u].title)+" \xA0",1),t(E,{class:"ptr",name:"edit",onClick:a=>{r.prompt=!0,this.courseTitle=this.reStore.courses[u].title,this.courseKey=u}},null,8,["onClick"]),ge,h(" Key: "+S(u)+" ",1),t(E,{class:"ptr",name:"content_copy",onClick:a=>this.copyCK(u)},null,8,["onClick"]),i("div",null,[t(f,{icon:"delete",onClick:a=>this.deleteCourseCB(n.ck)},{default:l(()=>[t(C,null,{default:l(()=>[h("Delete Course")]),_:1})]),_:2},1032,["onClick"]),t(f,{icon:"post_add",onClick:a=>this.newAssignmentCB(n.ck)},{default:l(()=>[t(C,null,{default:l(()=>[h("New Assignment")]),_:1})]),_:2},1032,["onClick"]),t(f,{icon:"auto_awesome",onClick:a=>{this.targetCK=u,r.promptAwesome=!0}},{default:l(()=>[t(C,null,{default:l(()=>[h("1-Step Custom Assignment Create")]),_:1})]),_:2},1032,["onClick"]),t(f,{icon:"content_copy",onClick:a=>this.copyCK(u)},{default:l(()=>[t(C,null,{default:l(()=>[h("Copy this course-key to clipboard. Enroll "),pe,h("in this course using this course-key from "),Ce,h("the Student Page.")]),_:1})]),_:2},1032,["onClick"])])]),_:2},1024),t(y,null,{default:l(()=>[i("table",_e,[Se,i("tr",null,[ye,(c(!0),g(b,null,A(this.reStore.courses[u].assignments,(a,d)=>(c(),g("th",{key:d},[i("span",null,S(a.title),1)]))),128))]),(c(!0),g(b,null,A(this.reStore.courses[u].enrollment,a=>(c(),g("tr",{key:a.name},[i("td",we,S(a.name),1),(c(!0),g(b,null,A(this.reStore.courses[u].assignments,(d,x)=>(c(),g("td",{style:{"text-align":"center"},key:x},[d.scores&&d.scores[a.emailKey]?(c(),g("span",ve,S(d.scores[a.emailKey]),1)):(c(),g("span",xe," -- "))]))),128))]))),128))])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)])]),_:2},1024))),128))]),_:1})}var je=L(ee,[["render",ke]]);export{je as default};
